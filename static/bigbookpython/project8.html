<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="pygments.css"><title>Calendar Maker</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="project7.html">Prev: Caesar Hacker</a> | <a href="project9.html">Next: Carrot in a Box</a>





<div type="bodymatter chapter" class="calibre1" id="calibre_link-64">
<section class="toclist">
<header class="calibre10">
<h1 class="chapter">
<span class="chapternumber">#8</span><br class="calibre14" />
<span class="chaptertitle">Calendar Maker</span></h1>
</header>
<figure class="opener">
<img src="images/000002.webp" alt="" class="calibre12" />
</figure>
<p class="chapterintro">This program generates printable text files of monthly calendars for the month and year you enter. Dates and calendars are a tricky topic in programming because there are so many different rules for determining the number of days in a month, which years are leap years, and which day of the week a particular date falls on. Fortunately, Python’s <code class="calibre17">datetime</code> module handles these details for you. This program focuses on generating the multiline string for the monthly calendar page.</p>
<h2 id="calibre_link-65" class="calibre5">The Program in Action</h2>
<p class="bodyfirst">When you run <em class="calibre9">calendarmaker.py</em>, the output will look like this:</p>
<pre class="calibre24"><code class="calibre22">Calendar Maker, by Al Sweigart al@inventwithpython.com
Enter the year for the calendar:
&gt; <b class="calibre6">2029</b>
Enter the month for the calendar, 1-12:
&gt; <b class="calibre6">12</b>
                                  December 2029
...Sunday.....Monday....Tuesday...Wednesday...Thursday....Friday....Saturday..
+----------+----------+----------+----------+----------+----------+----------+
|25        |26        |27        |28        |29        |30        | 1        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+
| 2        | 3        | 4        | 5        | 6        | 7        | 8        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+
| 9        |10        |11        |12        |13        |14        |15        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+
|16        |17        |18        |19        |20        |21        |22        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+
|23        |24        |25        |26        |27        |28        |29        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+
|30        |31        | 1        | 2        | 3        | 4        | 5        |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
|          |          |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+----------+

Saved to calendar_2029_12.txt</code></pre>
<h2 id="calibre_link-66" class="calibre5">How It Works</h2>
<p class="bodyfirst">Note that the <code class="calibre22">getCalendarFor()</code> function returns a giant multiline string of the calendar for the given month and year. In this function, the <code class="calibre22">calText</code> variable stores this string, which adds the lines, spaces, and dates to it. To track the date, the <code class="calibre22">currentDate</code> variable holds a <code class="calibre22">datetime.date()</code> object, which gets set to the next or previous date by adding or subtracting <code class="calibre22">datetime.timedelta()</code> objects. You can learn about Python’s date and time modules by reading Chapter 17 of <em class="calibre9">Automate the Boring Stuff with Python</em> at <a href="https://automatetheboringstuff.com/2e/chapter17/" class="linkurl">https://automatetheboringstuff.com/2e/chapter17/</a>.</p>
<div class="highlight"><pre><span></span>
<span class="c">  1. </span><span class="sd">&quot;&quot;&quot;Calendar Maker, by Al Sweigart al@inventwithpython.com</span>
<span class="c">  2. </span><span class="sd">Create monthly calendars, saved to a text file and fit for printing.</span>
<span class="c">  3. </span><span class="sd">This code is available at https://nostarch.com/big-book-small-python-programming</span>
<span class="c">  4. </span><span class="sd">Tags: short&quot;&quot;&quot;</span>
<span class="c">  5. </span>
<span class="c">  6. </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="c">  7. </span>
<span class="c">  8. </span><span class="c1"># Set up the constants:</span>
<span class="c">  9. </span><span class="n">DAYS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Sunday&#39;</span><span class="p">,</span> <span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span>
<span class="c"> 10. </span>        <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">)</span>
<span class="c"> 11. </span><span class="n">MONTHS</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span> <span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span> <span class="s1">&#39;July&#39;</span><span class="p">,</span>
<span class="c"> 12. </span>          <span class="s1">&#39;August&#39;</span><span class="p">,</span> <span class="s1">&#39;September&#39;</span><span class="p">,</span> <span class="s1">&#39;October&#39;</span><span class="p">,</span> <span class="s1">&#39;November&#39;</span><span class="p">,</span> <span class="s1">&#39;December&#39;</span><span class="p">)</span>
<span class="c"> 13. </span>
<span class="c"> 14. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calendar Maker, by Al Sweigart al@inventwithpython.com&#39;</span><span class="p">)</span>
<span class="c"> 15. </span>
<span class="c"> 16. </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Loop to get a year from the user.</span>
<span class="c"> 17. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter the year for the calendar:&#39;</span><span class="p">)</span>
<span class="c"> 18. </span>    <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span>
<span class="c"> 19. </span>
<span class="c"> 20. </span>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="c"> 21. </span>        <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="c"> 22. </span>        <span class="k">break</span>
<span class="c"> 23. </span>
<span class="c"> 24. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please enter a numeric year, like 2023.&#39;</span><span class="p">)</span>
<span class="c"> 25. </span>    <span class="k">continue</span>
<span class="c"> 26. </span>
<span class="c"> 27. </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Loop to get a month from the user.</span>
<span class="c"> 28. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter the month for the calendar, 1-12:&#39;</span><span class="p">)</span>
<span class="c"> 29. </span>    <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span>
<span class="c"> 30. </span>
<span class="c"> 31. </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
<span class="c"> 32. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please enter a numeric month, like 3 for March.&#39;</span><span class="p">)</span>
<span class="c"> 33. </span>        <span class="k">continue</span>
<span class="c"> 34. </span>
<span class="c"> 35. </span>    <span class="n">month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="c"> 36. </span>    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">month</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>
<span class="c"> 37. </span>        <span class="k">break</span>
<span class="c"> 38. </span>
<span class="c"> 39. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please enter a number from 1 to 12.&#39;</span><span class="p">)</span>
<span class="c"> 40. </span>
<span class="c"> 41. </span>
<span class="c"> 42. </span><span class="k">def</span> <span class="nf">getCalendarFor</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
<span class="c"> 43. </span>    <span class="n">calText</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># calText will contain the string of our calendar.</span>
<span class="c"> 44. </span>
<span class="c"> 45. </span>    <span class="c1"># Put the month and year at the top of the calendar:</span>
<span class="c"> 46. </span>    <span class="n">calText</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">34</span><span class="p">)</span> <span class="o">+</span> <span class="n">MONTHS</span><span class="p">[</span><span class="n">month</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c"> 47. </span>
<span class="c"> 48. </span>    <span class="c1"># Add the days of the week labels to the calendar:</span>
<span class="c"> 49. </span>    <span class="c1"># (!) Try changing this to abbreviations: SUN, MON, TUE, etc.</span>
<span class="c"> 50. </span>    <span class="n">calText</span> <span class="o">+=</span> <span class="s1">&#39;...Sunday.....Monday....Tuesday...Wednesday...Thursday....Friday....Saturday..</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c"> 51. </span>
<span class="c"> 52. </span>    <span class="c1"># The horizontal line string that separate weeks:</span>
<span class="c"> 53. </span>    <span class="n">weekSeparator</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;+----------&#39;</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c"> 54. </span>
<span class="c"> 55. </span>    <span class="c1"># The blank rows have ten spaces in between the | day separators:</span>
<span class="c"> 56. </span>    <span class="n">blankRow</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;|          &#39;</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;|</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c"> 57. </span>
<span class="c"> 58. </span>    <span class="c1"># Get the first date in the month. (The datetime module handles all</span>
<span class="c"> 59. </span>    <span class="c1"># the complicated calendar stuff for us here.)</span>
<span class="c"> 60. </span>    <span class="n">currentDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c"> 61. </span>
<span class="c"> 62. </span>    <span class="c1"># Roll back currentDate until it is Sunday. (weekday() returns 6</span>
<span class="c"> 63. </span>    <span class="c1"># for Sunday, not 0.)</span>
<span class="c"> 64. </span>    <span class="k">while</span> <span class="n">currentDate</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
<span class="c"> 65. </span>        <span class="n">currentDate</span> <span class="o">-=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c"> 66. </span>
<span class="c"> 67. </span>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Loop over each week in the month.</span>
<span class="c"> 68. </span>        <span class="n">calText</span> <span class="o">+=</span> <span class="n">weekSeparator</span>
<span class="c"> 69. </span>
<span class="c"> 70. </span>        <span class="c1"># dayNumberRow is the row with the day number labels:</span>
<span class="c"> 71. </span>        <span class="n">dayNumberRow</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c"> 72. </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
<span class="c"> 73. </span>            <span class="n">dayNumberLabel</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">currentDate</span><span class="o">.</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c"> 74. </span>            <span class="n">dayNumberRow</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">dayNumberLabel</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
<span class="c"> 75. </span>            <span class="n">currentDate</span> <span class="o">+=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Go to next day.</span>
<span class="c"> 76. </span>        <span class="n">dayNumberRow</span> <span class="o">+=</span> <span class="s1">&#39;|</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="c1"># Add the vertical line after Saturday.</span>
<span class="c"> 77. </span>
<span class="c"> 78. </span>        <span class="c1"># Add the day number row and 3 blank rows to the calendar text.</span>
<span class="c"> 79. </span>        <span class="n">calText</span> <span class="o">+=</span> <span class="n">dayNumberRow</span>
<span class="c"> 80. </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  <span class="c1"># (!) Try changing the 4 to a 5 or 10.</span>
<span class="c"> 81. </span>            <span class="n">calText</span> <span class="o">+=</span> <span class="n">blankRow</span>
<span class="c"> 82. </span>
<span class="c"> 83. </span>        <span class="c1"># Check if we&#39;re done with the month:</span>
<span class="c"> 84. </span>        <span class="k">if</span> <span class="n">currentDate</span><span class="o">.</span><span class="n">month</span> <span class="o">!=</span> <span class="n">month</span><span class="p">:</span>
<span class="c"> 85. </span>            <span class="k">break</span>
<span class="c"> 86. </span>
<span class="c"> 87. </span>    <span class="c1"># Add the horizontal line at the very bottom of the calendar.</span>
<span class="c"> 88. </span>    <span class="n">calText</span> <span class="o">+=</span> <span class="n">weekSeparator</span>
<span class="c"> 89. </span>    <span class="k">return</span> <span class="n">calText</span>
<span class="c"> 90. </span>
<span class="c"> 91. </span>
<span class="c"> 92. </span><span class="n">calText</span> <span class="o">=</span> <span class="n">getCalendarFor</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
<span class="c"> 93. </span><span class="nb">print</span><span class="p">(</span><span class="n">calText</span><span class="p">)</span>  <span class="c1"># Display the calendar.</span>
<span class="c"> 94. </span>
<span class="c"> 95. </span><span class="c1"># Save the calendar to a text file:</span>
<span class="c"> 96. </span><span class="n">calendarFilename</span> <span class="o">=</span> <span class="s1">&#39;calendar_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
<span class="c"> 97. </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">calendarFilename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fileObj</span><span class="p">:</span>
<span class="c"> 98. </span>    <span class="n">fileObj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">calText</span><span class="p">)</span>
<span class="c"> 99. </span>
<span class="c">100. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saved to &#39;</span> <span class="o">+</span> <span class="n">calendarFilename</span><span class="p">)</span>
</pre></div>

<p class="calibre19">After you’ve entered the code and run it a few times, try re-creating this program from scratch without looking at the source code in this book. It doesn’t have to be exactly the same as this program; you can invent your own version! On your own, you can also try to figure out how to do the following:</p>
<ul class="calibre25">
<li class="calibre8">Add text inside some of the boxes for holidays.</li>
<li class="calibre8">Add text inside some of the boxes for reoccurring events.</li>
<li class="calibre8">Print a “mini” calendar that has dates without boxes.</li>
</ul>
<h2 id="calibre_link-67" class="calibre5">Exploring the Program</h2>
<p class="bodyfirst">Try to find the answers to the following questions. Experiment with some modifications to the code and rerun the program to see what effect the changes have.</p>
<ol class="decimal">
<li value="1" class="calibre8">How can you make the calendar display abbreviated months? For example, show <code class="calibre22">'Jan'</code> instead of <code class="calibre22">'January'</code>?</li>
<li value="2" class="calibre8">What error message do you get if you delete or comment out <code class="calibre22">year = int(response)</code> on line 21?</li>
<li value="3" class="calibre8">How can you make the calendar not display the days of the week at the top?</li>
<li value="4" class="calibre8">How can you make the program not save the calendar to a file?</li>
<li value="5" class="calibre8">What happens if you delete or comment out <code class="calibre22">print(calText)</code> on line 93?</li>
</ol>
</section>
</div>








<a href="project7.html">Prev: Caesar Hacker</a> | <a href="project9.html">Next: Carrot in a Box</a>
</body></html>