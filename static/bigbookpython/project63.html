<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="pygments.css"><title>Royal Game of Ur</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="project62.html">Prev: Rotating Cube</a> | <a href="project64.html">Next: Seven-Segment Display Module</a>





<div type="bodymatter chapter" class="calibre1" id="calibre_link-263">
<section class="toclist">
<header class="calibre10">
<h1 class="chapter">
<span class="chapternumber">#63</span><br class="calibre14" />
<span class="chaptertitle">Royal Game of Ur</span></h1>
</header>
<figure class="opener">
<img src="images/000002.webp" alt="" class="calibre12" />
</figure>
<p class="chapterintro">The Royal Game of Ur is a 5,000-year-old game from Mesopotamia. Archeologists rediscovered the game in the Royal Cemetery at Ur, in modern-day southern Iraq, during excavations between 1922 and 1934. The rules were reconstructed from the game board (shown in <a href="#calibre_link-349" id="calibre_link-811" class="linkurl">Figure 63-1</a>) and a Babylonian clay tablet, and they’re similar to Parcheesi. You’ll need both luck and skill to win.</p>
<figure class="calibre28">
<img src="images/000018.webp" alt="f63001" class="calibre12" />
<figcaption class="calibre29"><p class="calibre30"><a id="calibre_link-349" class="linkurl">Figure 63-1</a>: One of the five game boards found in the Royal Cemetery at Ur</p></figcaption>
</figure>
<p class="calibre19">Two players each begin with seven tokens in their home, and the first player to move all seven to the goal is the winner. Players take turns throwing four dice. These dice are four-pointed pyramid shapes called tetrahedrons. Each die has two marked points, giving an even chance that the dice come up marked or unmarked. Instead of dice, our game uses coins whose heads act as the marked point. The player can move a token one space for each marked point that comes up. This means they can move a single token between zero and four spaces, though they’re most likely to roll two spaces.</p>
<p class="calibre19">The tokens travel along the path indicated in <a href="#calibre_link-350" id="calibre_link-812" class="linkurl">Figure 63-2</a>. Only one token may exist on a space at a time. If a token lands on an opponent’s token while in the shared middle path, the opponent’s token is sent back home. If a token lands on the middle flower square, it is safe from being landed on. If a token lands on any of the other four flower tiles, the player gets to roll again. Our game will represent the tokens with the letters <em class="calibre9">X</em> and <em class="calibre9">O</em>.</p>
<figure class="calibre28">
<img src="images/000016.webp" alt="f63002" class="calibre12" />
<figcaption class="calibre29"><p class="calibre30"><a id="calibre_link-350" class="linkurl">Figure 63-2</a>: The path each player’s token takes from their home to their goal</p></figcaption>
</figure>
<p class="calibre19">A video featuring YouTuber Tom Scott and British Museum curator Irving Finkel discussing the Royal Game of Ur can be found at <a href="https://www.youtube.com/watch?v=WZskjLq040I" class="linkurl">https://www.youtube.com/watch?v=WZskjLq040I</a>.</p>
<h2 id="calibre_link-264" class="calibre5">The Program in Action</h2>
<p class="bodyfirst">When you run <em class="calibre9">royalgameofur.py</em>, the output will look like this:</p>
<pre class="calibre24"><code class="calibre22">The Royal Game of Ur, by Al Sweigart
<var class="calibre27">--snip--</var>
                   XXXXXXX           .......
                   Home              Goal
                     v                 ^
+-----+-----+-----+--v--+           +--^--+-----+
|*****|     |     |     |           |*****|     |
|*   *&lt;     &lt;     &lt;     |           |*   *&lt;     |
|****h|    g|    f|    e|           |****t|    s|
+--v--+-----+-----+-----+-----+-----+-----+--^--+
|     |     |     |*****|     |     |     |     |
|     &gt;     &gt;     &gt;*   *&gt;     &gt;     &gt;     &gt;     |
|    i|    j|    k|****l|    m|    n|    o|    p|
+--^--+-----+-----+-----+-----+-----+-----+--v--+
|*****|     |     |     |           |*****|     |
|*   *&lt;     &lt;     &lt;     |           |*   *&lt;     |
|****d|    c|    b|    a|           |****r|    q|
+-----+-----+-----+--^--+           +--v--+-----+
                     ^                 v
                   Home              Goal
                   OOOOOOO           .......

It is O's turn. Press Enter to flip...
Flips: H-H-H-H  Select token to move 4 spaces: home quit
&gt; <b class="calibre6">home</b>
O landed on a flower space and gets to go again.
Press Enter to continue...
<var class="calibre27">--snip--</var></code></pre>
<h2 id="calibre_link-265" class="calibre5">How It Works</h2>
<p class="bodyfirst">Like in Project 43, “Mancala,” the spaces on the ASCII-art game board are labeled with the letters <em class="calibre9">a</em> through <em class="calibre9">t</em>. After rolling, the player can select a space that contains their token to move that token, or they can select <code class="calibre22">home</code> to begin moving a token from their home to the board. The program represents the board as a dictionary with the keys <code class="calibre22">'a'</code> to <code class="calibre22">'t'</code> and the values of <code class="calibre22">'X'</code> and <code class="calibre22">'O'</code> for the tokens (or <code class="calibre22">' '</code> for a blank space).</p>
<p class="calibre19">Additionally, this dictionary has keys <code class="calibre22">'x_home'</code>, <code class="calibre22">'o_home'</code>, <code class="calibre22">'x_goal'</code>, and <code class="calibre22">'o_goal'</code>, and the values for these keys are seven-character strings that represent how full the homes and goals are. The <code class="calibre22">'X'</code> or <code class="calibre22">'O'</code> characters in these strings represent tokens at the home or goal, and <code class="calibre22">'.'</code> represents an empty slot. The <code class="calibre22">displayBoard()</code> function displays these seven-character strings on the screen.</p>
<div class="highlight"><pre><span></span>
<span class="c">  1. </span><span class="sd">&quot;&quot;&quot;The Royal Game of Ur, by Al Sweigart al@inventwithpython.com</span>
<span class="c">  2. </span><span class="sd">A 5,000 year old board game from Mesopotamia. Two players knock each</span>
<span class="c">  3. </span><span class="sd">other back as they race for the goal.</span>
<span class="c">  4. </span><span class="sd">More info https://en.wikipedia.org/wiki/Royal_Game_of_Ur</span>
<span class="c">  5. </span><span class="sd">This code is available at https://nostarch.com/big-book-small-python-programming</span>
<span class="c">  6. </span><span class="sd">Tags: large, board game, game, two-player</span>
<span class="c">  7. </span><span class="sd">&quot;&quot;&quot;</span>
<span class="c">  8. </span>
<span class="c">  9. </span><span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">sys</span>
<span class="c"> 10. </span>
<span class="c"> 11. </span><span class="n">X_PLAYER</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
<span class="c"> 12. </span><span class="n">O_PLAYER</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>
<span class="c"> 13. </span><span class="n">EMPTY</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="c"> 14. </span>
<span class="c"> 15. </span><span class="c1"># Set up constants for the space labels:</span>
<span class="c"> 16. </span><span class="n">X_HOME</span> <span class="o">=</span> <span class="s1">&#39;x_home&#39;</span>
<span class="c"> 17. </span><span class="n">O_HOME</span> <span class="o">=</span> <span class="s1">&#39;o_home&#39;</span>
<span class="c"> 18. </span><span class="n">X_GOAL</span> <span class="o">=</span> <span class="s1">&#39;x_goal&#39;</span>
<span class="c"> 19. </span><span class="n">O_GOAL</span> <span class="o">=</span> <span class="s1">&#39;o_goal&#39;</span>
<span class="c"> 20. </span>
<span class="c"> 21. </span><span class="c1"># The spaces in left to right, top to bottom order:</span>
<span class="c"> 22. </span><span class="n">ALL_SPACES</span> <span class="o">=</span> <span class="s1">&#39;hgfetsijklmnopdcbarq&#39;</span>
<span class="c"> 23. </span><span class="n">X_TRACK</span> <span class="o">=</span> <span class="s1">&#39;HefghijklmnopstG&#39;</span>  <span class="c1"># (H stands for Home, G stands for Goal.)</span>
<span class="c"> 24. </span><span class="n">O_TRACK</span> <span class="o">=</span> <span class="s1">&#39;HabcdijklmnopqrG&#39;</span>
<span class="c"> 25. </span>
<span class="c"> 26. </span><span class="n">FLOWER_SPACES</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c"> 27. </span>
<span class="c"> 28. </span><span class="n">BOARD_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="c"> 29. </span><span class="s2">                   </span><span class="si">{}</span><span class="s2">           </span><span class="si">{}</span><span class="s2"></span>
<span class="c"> 30. </span><span class="s2">                   Home              Goal</span>
<span class="c"> 31. </span><span class="s2">                     v                 ^</span>
<span class="c"> 32. </span><span class="s2">+-----+-----+-----+--v--+           +--^--+-----+</span>
<span class="c"> 33. </span><span class="s2">|*****|     |     |     |           |*****|     |</span>
<span class="c"> 34. </span><span class="s2">|* </span><span class="si">{}</span><span class="s2"> *&lt;  </span><span class="si">{}</span><span class="s2">  &lt;  </span><span class="si">{}</span><span class="s2">  &lt;  </span><span class="si">{}</span><span class="s2">  |           |* </span><span class="si">{}</span><span class="s2"> *&lt;  </span><span class="si">{}</span><span class="s2">  |</span>
<span class="c"> 35. </span><span class="s2">|****h|    g|    f|    e|           |****t|    s|</span>
<span class="c"> 36. </span><span class="s2">+--v--+-----+-----+-----+-----+-----+-----+--^--+</span>
<span class="c"> 37. </span><span class="s2">|     |     |     |*****|     |     |     |     |</span>
<span class="c"> 38. </span><span class="s2">|  </span><span class="si">{}</span><span class="s2">  &gt;  </span><span class="si">{}</span><span class="s2">  &gt;  </span><span class="si">{}</span><span class="s2">  &gt;* </span><span class="si">{}</span><span class="s2"> *&gt;  </span><span class="si">{}</span><span class="s2">  &gt;  </span><span class="si">{}</span><span class="s2">  &gt;  </span><span class="si">{}</span><span class="s2">  &gt;  </span><span class="si">{}</span><span class="s2">  |</span>
<span class="c"> 39. </span><span class="s2">|    i|    j|    k|****l|    m|    n|    o|    p|</span>
<span class="c"> 40. </span><span class="s2">+--^--+-----+-----+-----+-----+-----+-----+--v--+</span>
<span class="c"> 41. </span><span class="s2">|*****|     |     |     |           |*****|     |</span>
<span class="c"> 42. </span><span class="s2">|* </span><span class="si">{}</span><span class="s2"> *&lt;  </span><span class="si">{}</span><span class="s2">  &lt;  </span><span class="si">{}</span><span class="s2">  &lt;  </span><span class="si">{}</span><span class="s2">  |           |* </span><span class="si">{}</span><span class="s2"> *&lt;  </span><span class="si">{}</span><span class="s2">  |</span>
<span class="c"> 43. </span><span class="s2">|****d|    c|    b|    a|           |****r|    q|</span>
<span class="c"> 44. </span><span class="s2">+-----+-----+-----+--^--+           +--v--+-----+</span>
<span class="c"> 45. </span><span class="s2">                     ^                 v</span>
<span class="c"> 46. </span><span class="s2">                   Home              Goal</span>
<span class="c"> 47. </span><span class="s2">                   </span><span class="si">{}</span><span class="s2">           </span><span class="si">{}</span><span class="s2"></span>
<span class="c"> 48. </span><span class="s2">&quot;&quot;&quot;</span>
<span class="c"> 49. </span>
<span class="c"> 50. </span>
<span class="c"> 51. </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="c"> 52. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;The Royal Game of Ur, by Al Sweigart</span>
<span class="c"> 53. </span>
<span class="c"> 54. </span><span class="s1">This is a 5,000 year old game. Two players must move their tokens</span>
<span class="c"> 55. </span><span class="s1">from their home to their goal. On your turn you flip four coins and can</span>
<span class="c"> 56. </span><span class="s1">move one token a number of spaces equal to the heads you got.</span>
<span class="c"> 57. </span>
<span class="c"> 58. </span><span class="s1">Ur is a racing game; the first player to move all seven of their tokens</span>
<span class="c"> 59. </span><span class="s1">to their goal wins. To do this, tokens must travel from their home to</span>
<span class="c"> 60. </span><span class="s1">their goal:</span>
<span class="c"> 61. </span>
<span class="c"> 62. </span><span class="s1">            X Home      X Goal</span>
<span class="c"> 63. </span><span class="s1">              v           ^</span>
<span class="c"> 64. </span><span class="s1">+---+---+---+-v-+       +-^-+---+</span>
<span class="c"> 65. </span><span class="s1">|v&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; |       | ^&lt;|&lt;&lt; |</span>
<span class="c"> 66. </span><span class="s1">|v  |   |   |   |       |   | ^ |</span>
<span class="c"> 67. </span><span class="s1">+v--+---+---+---+---+---+---+-^-+</span>
<span class="c"> 68. </span><span class="s1">|&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;^ |</span>
<span class="c"> 69. </span><span class="s1">|&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;v |</span>
<span class="c"> 70. </span><span class="s1">+^--+---+---+---+---+---+---+-v-+</span>
<span class="c"> 71. </span><span class="s1">|^  |   |   |   |       |   | v |</span>
<span class="c"> 72. </span><span class="s1">|^&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; |       | v&lt;&lt;&lt;&lt; |</span>
<span class="c"> 73. </span><span class="s1">+---+---+---+-^-+       +-v-+---+</span>
<span class="c"> 74. </span><span class="s1">              ^           v</span>
<span class="c"> 75. </span><span class="s1">            O Home      O Goal</span>
<span class="c"> 76. </span>
<span class="c"> 77. </span><span class="s1">If you land on an opponent&#39;s token in the middle track, it gets sent</span>
<span class="c"> 78. </span><span class="s1">back home. The **flower** spaces let you take another turn. Tokens in</span>
<span class="c"> 79. </span><span class="s1">the middle flower space are safe and cannot be landed on.&#39;&#39;&#39;</span><span class="p">)</span>
<span class="c"> 80. </span>    <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Press Enter to begin...&#39;</span><span class="p">)</span>
<span class="c"> 81. </span>
<span class="c"> 82. </span>    <span class="n">gameBoard</span> <span class="o">=</span> <span class="n">getNewBoard</span><span class="p">()</span>
<span class="c"> 83. </span>    <span class="n">turn</span> <span class="o">=</span> <span class="n">O_PLAYER</span>
<span class="c"> 84. </span>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Main game loop.</span>
<span class="c"> 85. </span>        <span class="c1"># Set up some variables for this turn:</span>
<span class="c"> 86. </span>        <span class="k">if</span> <span class="n">turn</span> <span class="o">==</span> <span class="n">X_PLAYER</span><span class="p">:</span>
<span class="c"> 87. </span>            <span class="n">opponent</span> <span class="o">=</span> <span class="n">O_PLAYER</span>
<span class="c"> 88. </span>            <span class="n">home</span> <span class="o">=</span> <span class="n">X_HOME</span>
<span class="c"> 89. </span>            <span class="n">track</span> <span class="o">=</span> <span class="n">X_TRACK</span>
<span class="c"> 90. </span>            <span class="n">goal</span> <span class="o">=</span> <span class="n">X_GOAL</span>
<span class="c"> 91. </span>            <span class="n">opponentHome</span> <span class="o">=</span> <span class="n">O_HOME</span>
<span class="c"> 92. </span>        <span class="k">elif</span> <span class="n">turn</span> <span class="o">==</span> <span class="n">O_PLAYER</span><span class="p">:</span>
<span class="c"> 93. </span>            <span class="n">opponent</span> <span class="o">=</span> <span class="n">X_PLAYER</span>
<span class="c"> 94. </span>            <span class="n">home</span> <span class="o">=</span> <span class="n">O_HOME</span>
<span class="c"> 95. </span>            <span class="n">track</span> <span class="o">=</span> <span class="n">O_TRACK</span>
<span class="c"> 96. </span>            <span class="n">goal</span> <span class="o">=</span> <span class="n">O_GOAL</span>
<span class="c"> 97. </span>            <span class="n">opponentHome</span> <span class="o">=</span> <span class="n">X_HOME</span>
<span class="c"> 98. </span>
<span class="c"> 99. </span>        <span class="n">displayBoard</span><span class="p">(</span><span class="n">gameBoard</span><span class="p">)</span>
<span class="c">100. </span>
<span class="c">101. </span>        <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;It is &#39;</span> <span class="o">+</span> <span class="n">turn</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">s turn. Press Enter to flip...&#39;</span><span class="p">)</span>
<span class="c">102. </span>
<span class="c">103. </span>        <span class="n">flipTally</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c">104. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Flips: &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">105. </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>  <span class="c1"># Flip 4 coins.</span>
<span class="c">106. </span>            <span class="n">result</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c">107. </span>            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="c">108. </span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Tails.</span>
<span class="c">109. </span>            <span class="k">else</span><span class="p">:</span>
<span class="c">110. </span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Heads.</span>
<span class="c">111. </span>            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
<span class="c">112. </span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Print separator.</span>
<span class="c">113. </span>            <span class="n">flipTally</span> <span class="o">+=</span> <span class="n">result</span>
<span class="c">114. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">115. </span>
<span class="c">116. </span>        <span class="k">if</span> <span class="n">flipTally</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="c">117. </span>            <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;You lose a turn. Press Enter to continue...&#39;</span><span class="p">)</span>
<span class="c">118. </span>            <span class="n">turn</span> <span class="o">=</span> <span class="n">opponent</span>  <span class="c1"># Swap turns to the other player.</span>
<span class="c">119. </span>            <span class="k">continue</span>
<span class="c">120. </span>
<span class="c">121. </span>        <span class="c1"># Ask the player for their move:</span>
<span class="c">122. </span>        <span class="n">validMoves</span> <span class="o">=</span> <span class="n">getValidMoves</span><span class="p">(</span><span class="n">gameBoard</span><span class="p">,</span> <span class="n">turn</span><span class="p">,</span> <span class="n">flipTally</span><span class="p">)</span>
<span class="c">123. </span>
<span class="c">124. </span>        <span class="k">if</span> <span class="n">validMoves</span> <span class="o">==</span> <span class="p">[]:</span>
<span class="c">125. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are no possible moves, so you lose a turn.&#39;</span><span class="p">)</span>
<span class="c">126. </span>            <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Press Enter to continue...&#39;</span><span class="p">)</span>
<span class="c">127. </span>            <span class="n">turn</span> <span class="o">=</span> <span class="n">opponent</span>  <span class="c1"># Swap turns to the other player.</span>
<span class="c">128. </span>            <span class="k">continue</span>
<span class="c">129. </span>
<span class="c">130. </span>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="c">131. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select move&#39;</span><span class="p">,</span> <span class="n">flipTally</span><span class="p">,</span> <span class="s1">&#39;spaces: &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">132. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">validMoves</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; quit&#39;</span><span class="p">)</span>
<span class="c">133. </span>            <span class="n">move</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="c">134. </span>
<span class="c">135. </span>            <span class="k">if</span> <span class="n">move</span> <span class="o">==</span> <span class="s1">&#39;quit&#39;</span><span class="p">:</span>
<span class="c">136. </span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thanks for playing!&#39;</span><span class="p">)</span>
<span class="c">137. </span>                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="c">138. </span>            <span class="k">if</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">validMoves</span><span class="p">:</span>
<span class="c">139. </span>                <span class="k">break</span>  <span class="c1"># Exit the loop when a valid move is selected.</span>
<span class="c">140. </span>
<span class="c">141. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;That is not a valid move.&#39;</span><span class="p">)</span>
<span class="c">142. </span>
<span class="c">143. </span>        <span class="c1"># Perform the selected move on the board:</span>
<span class="c">144. </span>        <span class="k">if</span> <span class="n">move</span> <span class="o">==</span> <span class="s1">&#39;home&#39;</span><span class="p">:</span>
<span class="c">145. </span>            <span class="c1"># Subtract tokens at home if moving from home:</span>
<span class="c">146. </span>            <span class="n">gameBoard</span><span class="p">[</span><span class="n">home</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="c">147. </span>            <span class="n">nextTrackSpaceIndex</span> <span class="o">=</span> <span class="n">flipTally</span>
<span class="c">148. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">149. </span>            <span class="n">gameBoard</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">EMPTY</span>  <span class="c1"># Set the &quot;from&quot; space to empty.</span>
<span class="c">150. </span>            <span class="n">nextTrackSpaceIndex</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">move</span><span class="p">)</span> <span class="o">+</span> <span class="n">flipTally</span>
<span class="c">151. </span>
<span class="c">152. </span>        <span class="n">movingOntoGoal</span> <span class="o">=</span> <span class="n">nextTrackSpaceIndex</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">track</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="c">153. </span>        <span class="k">if</span> <span class="n">movingOntoGoal</span><span class="p">:</span>
<span class="c">154. </span>            <span class="n">gameBoard</span><span class="p">[</span><span class="n">goal</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c">155. </span>            <span class="c1"># Check if the player has won:</span>
<span class="c">156. </span>            <span class="k">if</span> <span class="n">gameBoard</span><span class="p">[</span><span class="n">goal</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
<span class="c">157. </span>                <span class="n">displayBoard</span><span class="p">(</span><span class="n">gameBoard</span><span class="p">)</span>
<span class="c">158. </span>                <span class="nb">print</span><span class="p">(</span><span class="n">turn</span><span class="p">,</span> <span class="s1">&#39;has won the game!&#39;</span><span class="p">)</span>
<span class="c">159. </span>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thanks for playing!&#39;</span><span class="p">)</span>
<span class="c">160. </span>                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="c">161. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">162. </span>            <span class="n">nextBoardSpace</span> <span class="o">=</span> <span class="n">track</span><span class="p">[</span><span class="n">nextTrackSpaceIndex</span><span class="p">]</span>
<span class="c">163. </span>            <span class="c1"># Check if the opponent has a tile there:</span>
<span class="c">164. </span>            <span class="k">if</span> <span class="n">gameBoard</span><span class="p">[</span><span class="n">nextBoardSpace</span><span class="p">]</span> <span class="o">==</span> <span class="n">opponent</span><span class="p">:</span>
<span class="c">165. </span>                <span class="n">gameBoard</span><span class="p">[</span><span class="n">opponentHome</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c">166. </span>
<span class="c">167. </span>            <span class="c1"># Set the &quot;to&quot; space to the player&#39;s token:</span>
<span class="c">168. </span>            <span class="n">gameBoard</span><span class="p">[</span><span class="n">nextBoardSpace</span><span class="p">]</span> <span class="o">=</span> <span class="n">turn</span>
<span class="c">169. </span>
<span class="c">170. </span>        <span class="c1"># Check if the player landed on a flower space and can go again:</span>
<span class="c">171. </span>        <span class="k">if</span> <span class="n">nextBoardSpace</span> <span class="ow">in</span> <span class="n">FLOWER_SPACES</span><span class="p">:</span>
<span class="c">172. </span>            <span class="nb">print</span><span class="p">(</span><span class="n">turn</span><span class="p">,</span> <span class="s1">&#39;landed on a flower space and goes again.&#39;</span><span class="p">)</span>
<span class="c">173. </span>            <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Press Enter to continue...&#39;</span><span class="p">)</span>
<span class="c">174. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">175. </span>            <span class="n">turn</span> <span class="o">=</span> <span class="n">opponent</span>  <span class="c1"># Swap turns to the other player.</span>
<span class="c">176. </span>
<span class="c">177. </span><span class="k">def</span> <span class="nf">getNewBoard</span><span class="p">():</span>
<span class="c">178. </span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="c">179. </span><span class="sd">    Returns a dictionary that represents the state of the board. The</span>
<span class="c">180. </span><span class="sd">    keys are strings of the space labels, the values are X_PLAYER,</span>
<span class="c">181. </span><span class="sd">    O_PLAYER, or EMPTY. There are also counters for how many tokens are</span>
<span class="c">182. </span><span class="sd">    at the home and goal of both players.</span>
<span class="c">183. </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="c">184. </span>    <span class="n">board</span> <span class="o">=</span> <span class="p">{</span><span class="n">X_HOME</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="n">X_GOAL</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">O_HOME</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="n">O_GOAL</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="c">185. </span>    <span class="c1"># Set each space as empty to start:</span>
<span class="c">186. </span>    <span class="k">for</span> <span class="n">spaceLabel</span> <span class="ow">in</span> <span class="n">ALL_SPACES</span><span class="p">:</span>
<span class="c">187. </span>        <span class="n">board</span><span class="p">[</span><span class="n">spaceLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">EMPTY</span>
<span class="c">188. </span>    <span class="k">return</span> <span class="n">board</span>
<span class="c">189. </span>
<span class="c">190. </span>
<span class="c">191. </span><span class="k">def</span> <span class="nf">displayBoard</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
<span class="c">192. </span>    <span class="sd">&quot;&quot;&quot;Display the board on the screen.&quot;&quot;&quot;</span>
<span class="c">193. </span>    <span class="c1"># &quot;Clear&quot; the screen by printing many newlines, so the old</span>
<span class="c">194. </span>    <span class="c1"># board isn&#39;t visible anymore.</span>
<span class="c">195. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="c">196. </span>
<span class="c">197. </span>    <span class="n">xHomeTokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span> <span class="o">*</span> <span class="n">board</span><span class="p">[</span><span class="n">X_HOME</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="c">198. </span>    <span class="n">xGoalTokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span> <span class="o">*</span> <span class="n">board</span><span class="p">[</span><span class="n">X_GOAL</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="c">199. </span>    <span class="n">oHomeTokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span> <span class="o">*</span> <span class="n">board</span><span class="p">[</span><span class="n">O_HOME</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="c">200. </span>    <span class="n">oGoalTokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span> <span class="o">*</span> <span class="n">board</span><span class="p">[</span><span class="n">O_GOAL</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="c">201. </span>
<span class="c">202. </span>    <span class="c1"># Add the strings that should populate BOARD_TEMPLATE in order,</span>
<span class="c">203. </span>    <span class="c1"># going from left to right, top to bottom.</span>
<span class="c">204. </span>    <span class="n">spaces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c">205. </span>    <span class="n">spaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xHomeTokens</span><span class="p">)</span>
<span class="c">206. </span>    <span class="n">spaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xGoalTokens</span><span class="p">)</span>
<span class="c">207. </span>    <span class="k">for</span> <span class="n">spaceLabel</span> <span class="ow">in</span> <span class="n">ALL_SPACES</span><span class="p">:</span>
<span class="c">208. </span>        <span class="n">spaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">spaceLabel</span><span class="p">])</span>
<span class="c">209. </span>    <span class="n">spaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oHomeTokens</span><span class="p">)</span>
<span class="c">210. </span>    <span class="n">spaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oGoalTokens</span><span class="p">)</span>
<span class="c">211. </span>
<span class="c">212. </span>    <span class="nb">print</span><span class="p">(</span><span class="n">BOARD_TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">spaces</span><span class="p">))</span>
<span class="c">213. </span>
<span class="c">214. </span>
<span class="c">215. </span><span class="k">def</span> <span class="nf">getValidMoves</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">flipTally</span><span class="p">):</span>
<span class="c">216. </span>    <span class="n">validMoves</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Contains the spaces with tokens that can move.</span>
<span class="c">217. </span>    <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="n">X_PLAYER</span><span class="p">:</span>
<span class="c">218. </span>        <span class="n">opponent</span> <span class="o">=</span> <span class="n">O_PLAYER</span>
<span class="c">219. </span>        <span class="n">track</span> <span class="o">=</span> <span class="n">X_TRACK</span>
<span class="c">220. </span>        <span class="n">home</span> <span class="o">=</span> <span class="n">X_HOME</span>
<span class="c">221. </span>    <span class="k">elif</span> <span class="n">player</span> <span class="o">==</span> <span class="n">O_PLAYER</span><span class="p">:</span>
<span class="c">222. </span>        <span class="n">opponent</span> <span class="o">=</span> <span class="n">X_PLAYER</span>
<span class="c">223. </span>        <span class="n">track</span> <span class="o">=</span> <span class="n">O_TRACK</span>
<span class="c">224. </span>        <span class="n">home</span> <span class="o">=</span> <span class="n">O_HOME</span>
<span class="c">225. </span>
<span class="c">226. </span>    <span class="c1"># Check if the player can move a token from home:</span>
<span class="c">227. </span>    <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">home</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">track</span><span class="p">[</span><span class="n">flipTally</span><span class="p">]]</span> <span class="o">==</span> <span class="n">EMPTY</span><span class="p">:</span>
<span class="c">228. </span>        <span class="n">validMoves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">)</span>
<span class="c">229. </span>
<span class="c">230. </span>    <span class="c1"># Check which spaces have a token the player can move:</span>
<span class="c">231. </span>    <span class="k">for</span> <span class="n">trackSpaceIndex</span><span class="p">,</span> <span class="n">space</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">track</span><span class="p">):</span>
<span class="c">232. </span>        <span class="k">if</span> <span class="n">space</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span> <span class="ow">or</span> <span class="n">space</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span> <span class="ow">or</span> <span class="n">board</span><span class="p">[</span><span class="n">space</span><span class="p">]</span> <span class="o">!=</span> <span class="n">player</span><span class="p">:</span>
<span class="c">233. </span>            <span class="k">continue</span>
<span class="c">234. </span>        <span class="n">nextTrackSpaceIndex</span> <span class="o">=</span> <span class="n">trackSpaceIndex</span> <span class="o">+</span> <span class="n">flipTally</span>
<span class="c">235. </span>        <span class="k">if</span> <span class="n">nextTrackSpaceIndex</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">track</span><span class="p">):</span>
<span class="c">236. </span>            <span class="c1"># You must flip an exact number of moves onto the goal,</span>
<span class="c">237. </span>            <span class="c1"># otherwise you can&#39;t move on the goal.</span>
<span class="c">238. </span>            <span class="k">continue</span>
<span class="c">239. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">240. </span>            <span class="n">nextBoardSpaceKey</span> <span class="o">=</span> <span class="n">track</span><span class="p">[</span><span class="n">nextTrackSpaceIndex</span><span class="p">]</span>
<span class="c">241. </span>            <span class="k">if</span> <span class="n">nextBoardSpaceKey</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>
<span class="c">242. </span>                <span class="c1"># This token can move off the board:</span>
<span class="c">243. </span>                <span class="n">validMoves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
<span class="c">244. </span>                <span class="k">continue</span>
<span class="c">245. </span>        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">nextBoardSpaceKey</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">EMPTY</span><span class="p">,</span> <span class="n">opponent</span><span class="p">):</span>
<span class="c">246. </span>            <span class="c1"># If the next space is the protected middle space, you</span>
<span class="c">247. </span>            <span class="c1"># can only move there if it is empty:</span>
<span class="c">248. </span>            <span class="k">if</span> <span class="n">nextBoardSpaceKey</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">opponent</span><span class="p">:</span>
<span class="c">249. </span>                <span class="k">continue</span>  <span class="c1"># Skip this move, the space is protected.</span>
<span class="c">250. </span>            <span class="n">validMoves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
<span class="c">251. </span>
<span class="c">252. </span>    <span class="k">return</span> <span class="n">validMoves</span>
<span class="c">253. </span>
<span class="c">254. </span>
<span class="c">255. </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="c">256. </span>    <span class="n">main</span><span class="p">()</span>
</pre></div>

<h2 id="calibre_link-266" class="calibre5">Exploring the Program</h2>
<p class="bodyfirst">Try to find the answers to the following questions. Experiment with some modifications to the code and rerun the program to see what effect the changes have.</p>
<ol class="decimal">
<li value="1" class="calibre8">What happens if you change <code class="calibre22">nextTrackSpaceIndex == len(track) - 1</code> on line 152 to <code class="calibre22">nextTrackSpaceIndex == 1</code>?</li>
<li value="2" class="calibre8">What happens if you change <code class="calibre22">result = random.randint(0, 1)</code> on line 106 to <code class="calibre22">result = 1</code>?</li>
<li value="3" class="calibre8">What error do you cause if you change <code class="calibre22">board = {X_HOME: 7, X_GOAL: 0, O_HOME: 7, O_GOAL: 0}</code> on line 184 to <code class="calibre22">board = {}</code>?</li>
</ol>
</section>
</div>








<a href="project62.html">Prev: Rotating Cube</a> | <a href="project64.html">Next: Seven-Segment Display Module</a>
</body></html>