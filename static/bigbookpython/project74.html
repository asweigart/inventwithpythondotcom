<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="pygments.css"><title>Text To Speech Talker</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="project73.html">Prev: Sudoku Puzzle</a> | <a href="project75.html">Next: Three-Card Monte</a>





<div type="bodymatter chapter" class="calibre1" id="calibre_link-306">
<section class="toclist">
<header class="calibre10">
<h1 class="chapter">
<span class="chapternumber">#74</span><br class="calibre14" />
<span class="chaptertitle">Text-to-Speech Talker</span></h1>
</header>
<figure class="opener">
<img src="images/000002.webp" alt="" class="calibre12" />
</figure>
<p class="chapterintro">This program demonstrates the use of the <code class="calibre17">pyttsx3</code> third-party module. Any message you enter will be spoken out loud by your operating system’s text-to-speech capabilities. Although computer-generated speech is an incredibly complex branch of computer science, the <code class="calibre17">pyttsx3</code> module provides an easy interface for it, making this small program suitable for beginners. Once you’ve learned how to use the module, you can add generated speech to your own programs.</p>
<p class="calibre18">More information about the <code class="calibre22">pyttsx3</code> module can be found at <a href="https://pypi.org/project/pyttsx3/" class="linkurl">https://pypi.org/project/pyttsx3/</a>.</p>
<h2 id="calibre_link-307" class="calibre5">The Program in Action</h2>
<p class="bodyfirst">When you run <em class="calibre9">texttospeechtalker.py</em>, the output will look like this:</p>
<pre class="calibre24"><code class="calibre22">Text To Speech Talker, by Al Sweigart al@inventwithpython.com
Text-to-speech using the pyttsx3 module, which in turn uses
the NSSpeechSynthesizer (on macOS), SAPI5 (on Windows), or
eSpeak (on Linux) speech engines.

Enter the text to speak, or QUIT to quit.
&gt; <b class="calibre6">Hello. My name is Guido van Robot.</b>
<var class="calibre27">&lt;computer speaks text out loud&gt;</var>
&gt; <b class="calibre6">quit</b>
Thanks for playing!</code></pre>
<h2 id="calibre_link-308" class="calibre5">How It Works</h2>
<p class="bodyfirst">This program is short because the <code class="calibre22">pyttsx3</code> module handles all of the text-to-speech code. To use this module, install it by following the instructions in this book’s introduction. Once you’ve done so, your Python script can import it with <code class="calibre22">import pyttsx3</code> and call the <code class="calibre22">pyttsc3.init()</code> function. This returns an Engine object that represents the text-to-speech engine. This object has a <code class="calibre22">say()</code> method to which you can pass a string of text for the computer to speak when you run the <code class="calibre22">runAndWait()</code> method.</p>
<div class="highlight"><pre><span></span>
<span class="c"> 1. </span><span class="sd">&quot;&quot;&quot;Text To Speech Talker, by Al Sweigart al@inventwithpython.com</span>
<span class="c"> 2. </span><span class="sd">An example program using the text-to-speech features of the pyttsx3</span>
<span class="c"> 3. </span><span class="sd">module.</span>
<span class="c"> 4. </span><span class="sd">View this code at https://nostarch.com/big-book-small-python-projects</span>
<span class="c"> 5. </span><span class="sd">Tags: tiny, beginner&quot;&quot;&quot;</span>
<span class="c"> 6. </span>
<span class="c"> 7. </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="c"> 8. </span>
<span class="c"> 9. </span><span class="k">try</span><span class="p">:</span>
<span class="c">10. </span>    <span class="kn">import</span> <span class="nn">pyttsx3</span>
<span class="c">11. </span><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="c">12. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The pyttsx3 module needs to be installed to run this&#39;</span><span class="p">)</span>
<span class="c">13. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;program. On Windows, open a Command Prompt and run:&#39;</span><span class="p">)</span>
<span class="c">14. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pip install pyttsx3&#39;</span><span class="p">)</span>
<span class="c">15. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;On macOS and Linux, open a Terminal and run:&#39;</span><span class="p">)</span>
<span class="c">16. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pip3 install pyttsx3&#39;</span><span class="p">)</span>
<span class="c">17. </span>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="c">18. </span>
<span class="c">19. </span><span class="n">tts</span> <span class="o">=</span> <span class="n">pyttsx3</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>  <span class="c1"># Initialize the TTS engine.</span>
<span class="c">20. </span>
<span class="c">21. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Text To Speech Talker, by Al Sweigart al@inventwithpython.com&#39;</span><span class="p">)</span>
<span class="c">22. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Text-to-speech using the pyttsx3 module, which in turn uses&#39;</span><span class="p">)</span>
<span class="c">23. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the NSSpeechSynthesizer (on macOS), SAPI5 (on Windows), or&#39;</span><span class="p">)</span>
<span class="c">24. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eSpeak (on Linux) speech engines.&#39;</span><span class="p">)</span>
<span class="c">25. </span><span class="nb">print</span><span class="p">()</span>
<span class="c">26. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter the text to speak, or QUIT to quit.&#39;</span><span class="p">)</span>
<span class="c">27. </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="c">28. </span>    <span class="n">text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span>
<span class="c">29. </span>
<span class="c">30. </span>    <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;QUIT&#39;</span><span class="p">:</span>
<span class="c">31. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thanks for playing!&#39;</span><span class="p">)</span>
<span class="c">32. </span>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="c">33. </span>
<span class="c">34. </span>    <span class="n">tts</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># Add some text for the TTS engine to say.</span>
<span class="c">35. </span>    <span class="n">tts</span><span class="o">.</span><span class="n">runAndWait</span><span class="p">()</span>  <span class="c1"># Make the TTS engine say it.</span>
</pre></div>

<h2 id="calibre_link-309" class="calibre5">Exploring the Program</h2>
<p class="bodyfirst">This is a base program, so there aren’t many options to customize it. Instead, consider what other programs of yours would benefit from text-to-speech. </p>
</section>
</div>








<a href="project73.html">Prev: Sudoku Puzzle</a> | <a href="project75.html">Next: Three-Card Monte</a>
</body></html>