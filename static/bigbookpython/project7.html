<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="pygments.css"><title>Caesar Hacker</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="project6.html">Prev: Caesar Cipher</a> | <a href="project8.html">Next: Calendar Maker</a>





<div type="bodymatter chapter" class="calibre1" id="calibre_link-60">
<section class="toclist">
<header class="calibre10">
<h1 class="chapter">
<span class="chapternumber">#7</span><br class="calibre14" />
<span class="chaptertitle">Caesar Hacker</span></h1>
</header>
<figure class="opener">
<img src="images/000002.webp" alt="" class="calibre12" />
</figure>
<p class="chapterintro">This program can hack messages encrypted with the Caesar cipher from Project 6, even if you don’t know the key. There are only 26 possible keys for the Caesar cipher, so a computer can easily try all possible decryptions and display the results to the user. In cryptography, we call this technique a <em class="calibre9">brute-force attack</em>. If you’d like to learn more about ciphers and code breaking, you can read my book <em class="calibre9">Cracking Codes with Python</em> (No Starch Press, 2018; <a href="https://nostarch.com/crackingcodes/" class="linkurl">https://nostarch.com/crackingcodes/</a>).</p>
<h2 id="calibre_link-61" class="calibre5">The Program in Action</h2>
<p class="bodyfirst">When you run <em class="calibre9">caesarhacker.py</em>, the output will look like this:</p>
<pre class="calibre24"><code class="calibre22">Caesar Cipher Hacker, by Al Sweigart al@inventwithpython.com
Enter the encrypted Caesar cipher message to hack.
&gt; <b class="calibre6">QIIX QI FC XLI VSWI FYWLIW XSRMKLX.</b>
Key #0: QIIX QI FC XLI VSWI FYWLIW XSRMKLX.
Key #1: PHHW PH EB WKH URVH EXVKHV WRQLJKW.
Key #2: OGGV OG DA VJG TQUG DWUJGU VQPKIJV.
Key #3: NFFU NF CZ UIF SPTF CVTIFT UPOJHIU.
Key #4: MEET ME BY THE ROSE BUSHES TONIGHT.
Key #5: LDDS LD AX SGD QNRD ATRGDR SNMHFGS.
Key #6: KCCR KC ZW RFC PMQC ZSQFCQ RMLGEFR.
<var class="calibre27">--snip--</var></code></pre>
<h2 id="calibre_link-62" class="calibre5">How It Works</h2>
<p class="bodyfirst">Note that lines 20 to 36 in this program are nearly identical to lines 55 to 78 in the Caesar cipher program. The hacking program implements the same decryption code, except that it does so in a <code class="calibre22">for</code> loop, which runs the code for every possible key.</p>
<p class="calibre19">Unfortunately, the hacking program isn’t sophisticated enough to identify when it has found the correct key. It relies on a human to read the output and identify which decryption produced the original English (or whichever written language was encrypted). Chapter 11 of the book <em class="calibre9">Cracking Codes with Python</em> (No Starch Press, 2018) details how you can write Python code to detect English messages.</p>
<div class="highlight"><pre><span></span>
<span class="c"> 1. </span><span class="sd">&quot;&quot;&quot;Caesar Cipher Hacker, by Al Sweigart al@inventwithpython.com</span>
<span class="c"> 2. </span><span class="sd">This programs hacks messages encrypted with the Caesar cipher by doing</span>
<span class="c"> 3. </span><span class="sd">a brute force attack against every possible key.</span>
<span class="c"> 4. </span><span class="sd">More info at:</span>
<span class="c"> 5. </span><span class="sd">https://en.wikipedia.org/wiki/Caesar_cipher#Breaking_the_cipher</span>
<span class="c"> 6. </span><span class="sd">This code is available at https://nostarch.com/big-book-small-python-programming</span>
<span class="c"> 7. </span><span class="sd">Tags: tiny, beginner, cryptography, math&quot;&quot;&quot;</span>
<span class="c"> 8. </span>
<span class="c"> 9. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Caesar Cipher Hacker, by Al Sweigart al@inventwithpython.com&#39;</span><span class="p">)</span>
<span class="c">10. </span>
<span class="c">11. </span><span class="c1"># Let the user specify the message to hack:</span>
<span class="c">12. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter the encrypted Caesar cipher message to hack.&#39;</span><span class="p">)</span>
<span class="c">13. </span><span class="n">message</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span>
<span class="c">14. </span>
<span class="c">15. </span><span class="c1"># Every possible symbol that can be encrypted/decrypted:</span>
<span class="c">16. </span><span class="c1"># (This must match the SYMBOLS used when encrypting the message.)</span>
<span class="c">17. </span><span class="n">SYMBOLS</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
<span class="c">18. </span>
<span class="c">19. </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SYMBOLS</span><span class="p">)):</span>  <span class="c1"># Loop through every possible key.</span>
<span class="c">20. </span>    <span class="n">translated</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c">21. </span>
<span class="c">22. </span>    <span class="c1"># Decrypt each symbol in the message:</span>
<span class="c">23. </span>    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
<span class="c">24. </span>        <span class="k">if</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">SYMBOLS</span><span class="p">:</span>
<span class="c">25. </span>            <span class="n">num</span> <span class="o">=</span> <span class="n">SYMBOLS</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>  <span class="c1"># Get the number of the symbol.</span>
<span class="c">26. </span>            <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">-</span> <span class="n">key</span>  <span class="c1"># Decrypt the number.</span>
<span class="c">27. </span>
<span class="c">28. </span>            <span class="c1"># Handle the wrap-around if num is less than 0:</span>
<span class="c">29. </span>            <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="c">30. </span>                <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">SYMBOLS</span><span class="p">)</span>
<span class="c">31. </span>
<span class="c">32. </span>            <span class="c1"># Add decrypted number&#39;s symbol to translated:</span>
<span class="c">33. </span>            <span class="n">translated</span> <span class="o">=</span> <span class="n">translated</span> <span class="o">+</span> <span class="n">SYMBOLS</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
<span class="c">34. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">35. </span>            <span class="c1"># Just add the symbol without decrypting:</span>
<span class="c">36. </span>            <span class="n">translated</span> <span class="o">=</span> <span class="n">translated</span> <span class="o">+</span> <span class="n">symbol</span>
<span class="c">37. </span>
<span class="c">38. </span>    <span class="c1"># Display the key being tested, along with its decrypted text:</span>
<span class="c">39. </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Key #</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">translated</span><span class="p">))</span>
</pre></div>

<p class="calibre19">After entering the source code and running it a few times, try making experimental changes to it. Keep in mind that the string stored in the <code class="calibre22">SYMBOLS</code> variable must match the <code class="calibre22">SYMBOLS</code> variable in the Caesar cipher program that produced the encrypted text.</p>
<h2 id="calibre_link-63" class="calibre5">Exploring the Program</h2>
<p class="bodyfirst">Try to find the answers to the following questions. Experiment with some modifications to the code and rerun the program to see what effect the changes have.</p>
<ol class="decimal">
<li value="1" class="calibre8">What error message do you get if you delete or comment out <code class="calibre22">translated = ''</code> on line 20?</li>
<li value="2" class="calibre8">What happens if you change <code class="calibre22">translated = translated + SYMBOLS[num]</code> on line 33 to <code class="calibre22">translated = translated + symbol</code>?</li>
<li value="3" class="calibre8">What happens if you enter an unencrypted message into the Caesar cipher hacker program?</li>
</ol>
</section>
</div>








<a href="project6.html">Prev: Caesar Cipher</a> | <a href="project8.html">Next: Calendar Maker</a>
</body></html>