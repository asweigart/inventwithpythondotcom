<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="pygments.css"><title>Dice Roller</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="project17.html">Prev: Dice Math</a> | <a href="project19.html">Next: Digital Clock</a>





<div type="bodymatter chapter" class="calibre1" id="calibre_link-98">
<section class="toclist">
<header class="calibre10">
<h1 class="chapter">
<span class="chapternumber">#18</span><br class="calibre14" />
<span class="chaptertitle">Dice Roller</span></h1>
</header>
<figure class="opener">
<img src="images/000002.webp" alt="" class="calibre12" />
</figure>
<p class="chapterintro"><em class="calibre9">Dungeons &amp; Dragons</em> and other tabletop role-playing games use special dice that can have 4, 8, 10, 12, or even 20 sides. These games also have a specific notation for indicating which dice to roll. For example, 3d6 means rolling three six-sided dice, while 1d10+2 means rolling one ten-sided die and adding a two-point bonus to the roll. This program simulates this dice rolling, in case you forgot to bring your own. It can also simulate rolling dice that donâ€™t physically exist, such as a 38-sided die.</p>
<h2 id="calibre_link-99" class="calibre5">The Program in Action</h2>
<p class="bodyfirst">When you run <em class="calibre9">diceroller.py</em>, the output will look like this:</p>
<pre class="calibre24"><code class="calibre22">Dice Roller, by Al Sweigart al@inventwithpython.com
<var class="calibre27">--snip--</var>
&gt; <b class="calibre6">3d6</b>
7 (3, 2, 2)
&gt; <b class="calibre6">1d10+2</b>
9 (7, +2)
&gt; <b class="calibre6">2d38-1</b>
32 (20, 13, -1)
&gt; <b class="calibre6">100d6</b>
364 (3, 3, 2, 4, 2, 1, 4, 2, 4, 6, 4, 5, 4, 3, 3, 3, 2, 5, 1, 5, 6, 6, 6, 4, 5, 5, 1, 5, 2, 2, 2, 5, 1, 1, 2, 1, 4, 5, 6, 2, 4, 3, 4, 3, 5, 2, 2, 1, 1, 5, 1, 3, 6, 6, 6, 6, 5, 2, 6, 5, 4, 4, 5, 1, 6, 6, 6, 4, 2, 6, 2, 6, 2, 2, 4, 3, 6, 4, 6, 4, 2, 4, 3, 3, 1, 6, 3, 3, 4, 4, 5, 5, 5, 6, 2, 3, 6, 1, 1, 1)
<var class="calibre27">--snip--</var></code></pre>
<h2 id="calibre_link-100" class="calibre5">How It Works</h2>
<p class="bodyfirst">Most of the code in this program is dedicated to ensuring that the input the user entered is properly formatted. The actual random dice rolls themselves are simple calls to <code class="calibre22">random.randint()</code>. This function has no bias: each integer in the range passed to it is equally likely to be returned. This makes <code class="calibre22">random.randint()</code> ideal for simulating dice rolls.</p>
<div class="highlight"><pre><span></span>
<span class="c"> 1. </span><span class="sd">&quot;&quot;&quot;Dice Roller, by Al Sweigart al@inventwithpython.com</span>
<span class="c"> 2. </span><span class="sd">Simulates dice rolls using the Dungeons &amp; Dragons dice roll notation.</span>
<span class="c"> 3. </span><span class="sd">This code is available at https://nostarch.com/big-book-small-python-programming</span>
<span class="c"> 4. </span><span class="sd">Tags: short, simulation&quot;&quot;&quot;</span>
<span class="c"> 5. </span>
<span class="c"> 6. </span><span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">sys</span>
<span class="c"> 7. </span>
<span class="c"> 8. </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Dice Roller, by Al Sweigart al@inventwithpython.com</span>
<span class="c"> 9. </span>
<span class="c">10. </span><span class="s1">Enter what kind and how many dice to roll. The format is the number of</span>
<span class="c">11. </span><span class="s1">dice, followed by &quot;d&quot;, followed by the number of sides the dice have.</span>
<span class="c">12. </span><span class="s1">You can also add a plus or minus adjustment.</span>
<span class="c">13. </span>
<span class="c">14. </span><span class="s1">Examples:</span>
<span class="c">15. </span><span class="s1">  3d6 rolls three 6-sided dice</span>
<span class="c">16. </span><span class="s1">  1d10+2 rolls one 10-sided die, and adds 2</span>
<span class="c">17. </span><span class="s1">  2d38-1 rolls two 38-sided die, and subtracts 1</span>
<span class="c">18. </span><span class="s1">  QUIT quits the program</span>
<span class="c">19. </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="c">20. </span>
<span class="c">21. </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Main program loop:</span>
<span class="c">22. </span>    <span class="k">try</span><span class="p">:</span>
<span class="c">23. </span>        <span class="n">diceStr</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">)</span>  <span class="c1"># The prompt to enter the dice string.</span>
<span class="c">24. </span>        <span class="k">if</span> <span class="n">diceStr</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;QUIT&#39;</span><span class="p">:</span>
<span class="c">25. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thanks for playing!&#39;</span><span class="p">)</span>
<span class="c">26. </span>            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="c">27. </span>
<span class="c">28. </span>        <span class="c1"># Clean up the dice string:</span>
<span class="c">29. </span>        <span class="n">diceStr</span> <span class="o">=</span> <span class="n">diceStr</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">30. </span>
<span class="c">31. </span>        <span class="c1"># Find the &quot;d&quot; in the dice string input:</span>
<span class="c">32. </span>        <span class="n">dIndex</span> <span class="o">=</span> <span class="n">diceStr</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="c">33. </span>        <span class="k">if</span> <span class="n">dIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="c">34. </span>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Missing the &quot;d&quot; character.&#39;</span><span class="p">)</span>
<span class="c">35. </span>
<span class="c">36. </span>        <span class="c1"># Get the number of dice. (The &quot;3&quot; in &quot;3d6+1&quot;):</span>
<span class="c">37. </span>        <span class="n">numberOfDice</span> <span class="o">=</span> <span class="n">diceStr</span><span class="p">[:</span><span class="n">dIndex</span><span class="p">]</span>
<span class="c">38. </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">numberOfDice</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
<span class="c">39. </span>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Missing the number of dice.&#39;</span><span class="p">)</span>
<span class="c">40. </span>        <span class="n">numberOfDice</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numberOfDice</span><span class="p">)</span>
<span class="c">41. </span>
<span class="c">42. </span>        <span class="c1"># Find if there is a plus or minus sign for a modifier:</span>
<span class="c">43. </span>        <span class="n">modIndex</span> <span class="o">=</span> <span class="n">diceStr</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="c">44. </span>        <span class="k">if</span> <span class="n">modIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="c">45. </span>            <span class="n">modIndex</span> <span class="o">=</span> <span class="n">diceStr</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="c">46. </span>
<span class="c">47. </span>        <span class="c1"># Find the number of sides. (The &quot;6&quot; in &quot;3d6+1&quot;):</span>
<span class="c">48. </span>        <span class="k">if</span> <span class="n">modIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="c">49. </span>            <span class="n">numberOfSides</span> <span class="o">=</span> <span class="n">diceStr</span><span class="p">[</span><span class="n">dIndex</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
<span class="c">50. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">51. </span>            <span class="n">numberOfSides</span> <span class="o">=</span> <span class="n">diceStr</span><span class="p">[</span><span class="n">dIndex</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">modIndex</span><span class="p">]</span>
<span class="c">52. </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">numberOfSides</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
<span class="c">53. </span>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Missing the number of sides.&#39;</span><span class="p">)</span>
<span class="c">54. </span>        <span class="n">numberOfSides</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numberOfSides</span><span class="p">)</span>
<span class="c">55. </span>
<span class="c">56. </span>        <span class="c1"># Find the modifier amount. (The &quot;1&quot; in &quot;3d6+1&quot;):</span>
<span class="c">57. </span>        <span class="k">if</span> <span class="n">modIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="c">58. </span>            <span class="n">modAmount</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c">59. </span>        <span class="k">else</span><span class="p">:</span>
<span class="c">60. </span>            <span class="n">modAmount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">diceStr</span><span class="p">[</span><span class="n">modIndex</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:])</span>
<span class="c">61. </span>            <span class="k">if</span> <span class="n">diceStr</span><span class="p">[</span><span class="n">modIndex</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
<span class="c">62. </span>                <span class="c1"># Change the modification amount to negative:</span>
<span class="c">63. </span>                <span class="n">modAmount</span> <span class="o">=</span> <span class="o">-</span><span class="n">modAmount</span>
<span class="c">64. </span>
<span class="c">65. </span>        <span class="c1"># Simulate the dice rolls:</span>
<span class="c">66. </span>        <span class="n">rolls</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c">67. </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfDice</span><span class="p">):</span>
<span class="c">68. </span>            <span class="n">rollResult</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numberOfSides</span><span class="p">)</span>
<span class="c">69. </span>            <span class="n">rolls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rollResult</span><span class="p">)</span>
<span class="c">70. </span>
<span class="c">71. </span>        <span class="c1"># Display the total:</span>
<span class="c">72. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total:&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rolls</span><span class="p">)</span> <span class="o">+</span> <span class="n">modAmount</span><span class="p">,</span> <span class="s1">&#39;(Each die:&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">73. </span>
<span class="c">74. </span>        <span class="c1"># Display the individual rolls:</span>
<span class="c">75. </span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">roll</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rolls</span><span class="p">):</span>
<span class="c">76. </span>            <span class="n">rolls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>
<span class="c">77. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rolls</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">78. </span>
<span class="c">79. </span>        <span class="c1"># Display the modifier amount:</span>
<span class="c">80. </span>        <span class="k">if</span> <span class="n">modAmount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="c">81. </span>            <span class="n">modSign</span> <span class="o">=</span> <span class="n">diceStr</span><span class="p">[</span><span class="n">modIndex</span><span class="p">]</span>
<span class="c">82. </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, </span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">modSign</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">modAmount</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c">83. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="c">84. </span>
<span class="c">85. </span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="c">86. </span>        <span class="c1"># Catch any exceptions and display the message to the user:</span>
<span class="c">87. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid input. Enter something like &quot;3d6&quot; or &quot;1d10+2&quot;.&#39;</span><span class="p">)</span>
<span class="c">88. </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input was invalid because: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span>
<span class="c">89. </span>        <span class="k">continue</span>  <span class="c1"># Go back to the dice string prompt.</span>
</pre></div>

<p class="calibre19">After entering the source code and running it a few times, try making experimental changes to it. On your own, you can also try to figure out how to do the following:</p>
<ul class="calibre25">
<li class="calibre8">Add a multiplication modifier to complement the addition and subtraction modifier.</li>
<li class="calibre8">Add the ability to automatically remove the lowest die roll.</li>
</ul>
<h2 id="calibre_link-101" class="calibre5">Exploring the Program</h2>
<p class="bodyfirst">Try to find the answers to the following questions. Experiment with some modifications to the code and rerun the program to see what effect the changes have.</p>
<ol class="decimal">
<li value="1" class="calibre8">What happens if you delete or comment out <code class="calibre22">rolls.append(rollResult)</code> on line 69?</li>
<li value="2" class="calibre8">What happens if you change <code class="calibre22">rolls.append(rollResult)</code> on line 69 to <code class="calibre22">rolls.append(-rollResult)</code>?</li>
<li value="3" class="calibre8">What happens if you delete or comment out <code class="calibre22">print(', '.join(rolls), end='')</code> on line 77?</li>
<li value="4" class="calibre8">What happens if instead of a dice roll you enter nothing?</li>
</ol>
</section>
</div>








<a href="project17.html">Prev: Dice Math</a> | <a href="project19.html">Next: Digital Clock</a>
</body></html>