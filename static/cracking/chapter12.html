<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style_cracking.css" rel="stylesheet" type="text/css" /><title>Chapter 12 - Hacking the Transposition Cipher</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="chapter11.html">Prev: Chapter 11 - Detecting English Programmatically</a> | <a href="chapter13.html">Next: Chapter 13 - A Modular Arithmetic Module for the Affine Cipher</a>





<div><a target="_blank" href="https://www.amazon.com/gp/product/1593278225/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593278225&linkCode=as2&tag=playwithpyth-20&linkId=bf3b22819f0886d277e88b8a653b81ad">
<img src="images/cover_crackingcodes_thumb.webp" /><br />Buy the print or ebook online.</a></div>
<div><a href="chapter11.html">Previous Chapter - Detecting English Programmatically</a> | <a href="chapter13.html">Next Chapter - A Modular Arithmetic Module for the Affine Cipher</a></div>
<div id="calibre_link-27" class="calibre">
<h2 class="h2a1" id="calibre_link-37"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-936" class="calibre1"></span><span class="big">12</span><br class="calibre15" />HACKING THE TRANSPOSITION CIPHER</h2>
<p class="epigraph"><em class="calibre7">“Ron Rivest, one of the inventors of RSA, thinks that restricting cryptography would be foolhardy: ‘It is poor policy to clamp down indiscriminately on a technology just because some criminals might be able to use it to their advantage.’”<br class="calibre9" />&mdash; Simon Singh,</em> The Code Book</p>
<div class="image"><img src="images/00078.jpeg" alt="Images" class="calibre4" /></div>
<p class="noindent">In this chapter, we’ll use a brute-force approach to hack the transposition cipher. Of the thousands of keys that could possibly be associated with the transposition cipher, the correct key should be the only one that results in legible English. Using the <em class="calibre7">detectEnglish.py</em> module we wrote in <a href="#calibre_link-28" class="calibre8">Chapter 11</a>, our transposition cipher hacker program will help us find the correct key.</p>
<div class="sidebar">
<p class="sidebart"><strong class="calibre5">TOPICS COVERED IN THIS CHAPTER</strong></p>
<ul class="calibre10">
<li class="calibre11"><p class="noindent">Multiline strings with triple quotes</p></li>
<li class="calibre11"><p class="noindent">The <span class="literal">strip()</span> string method</p></li>
</ul>
</div>
<h3 class="h1" id="calibre_link-628"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-325" class="calibre1"></span><strong class="calibre3">Source Code of the Transposition Cipher Hacker Program</strong></h3>
<p class="noindent">Open a new file editor window by selecting <strong class="calibre5">File</strong><span class="ent">▸</span><strong class="calibre5">New File</strong>. Enter the following code into the file editor and save it as <em class="calibre7">transpositionHacker.py</em>. As with previous programs, make sure the <em class="calibre7">pyperclip.py</em> module, the <em class="calibre7">transpositionDecrypt.py</em> module (<a href="#calibre_link-26" class="calibre8">Chapter 8</a>), and the <em class="calibre7">detectEnglish.py</em> module and <em class="calibre7">dictionary.txt</em> file (<a href="#calibre_link-28" class="calibre8">Chapter 11</a>) are in the same directory as the <em class="calibre7">transpositionHacker.py</em> file. Then press F5 to run the program.</p>
<p class="noindentz"><em class="calibre7">transposition<br class="calibre9" />Hacker.py</em></p>
<p class="programs1">&nbsp;1. # Transposition Cipher Hacker<br class="calibre9" />&nbsp;2. # https://www.nostarch.com/crackingcodes/ (BSD Licensed)<br class="calibre9" />&nbsp;3.<br class="calibre9" />&nbsp;4. import pyperclip, detectEnglish, transpositionDecrypt<br class="calibre9" />&nbsp;5.<br class="calibre9" />&nbsp;6. def main():<br class="calibre9" />&nbsp;7.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# You might want to copy &amp; paste this text from the source code at<br class="calibre9" />&nbsp;8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# https://www.nostarch.com/crackingcodes/:<br class="calibre9" />&nbsp;9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myMessage = """AaKoosoeDe5 b5sn ma reno ora'lhlrrceey e&nbsp;&nbsp;enlh<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;na&nbsp;&nbsp;indeit n uhoretrm au ieu v er Ne2 gmanw,forwnlbsya apor tE.no<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;euarisfatt&nbsp;&nbsp;e mealefedhsppmgAnlnoe(c -or)alat r lw o eb&nbsp;&nbsp;nglom,Ain<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one dtes ilhetcdba. t tg eturmudg,tfl1e1 v&nbsp;&nbsp;nitiaicynhrCsaemie-sp<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ncgHt nie cetrgmnoa yc r,ieaa&nbsp;&nbsp;toesa- e a0m82e1w shcnth&nbsp;&nbsp;ekh<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gaecnpeutaaieetgn iodhso d ro hAe snrsfcegrt NCsLc b17m8aEheideikfr<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aBercaeu thllnrshicwsg etriebruaisss&nbsp;&nbsp;d iorr."""<br class="calibre9" />10.<br class="calibre9" />11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hackedMessage = hackTransposition(myMessage)<br class="calibre9" />12.<br class="calibre9" />13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if hackedMessage == None:<br class="calibre9" />14.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Failed to hack encryption.')<br class="calibre9" />15.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre9" />16.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Copying hacked message to clipboard:')<br class="calibre9" />17.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(hackedMessage)<br class="calibre9" />18.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pyperclip.copy(hackedMessage)<br class="calibre9" />19.<br class="calibre9" />20.<br class="calibre9" />21. def hackTransposition(message):<br class="calibre9" />22.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Hacking...')<br class="calibre9" />23.<br class="calibre9" />24.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Python programs can be stopped at any time by pressing<br class="calibre9" />25.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ctrl-C (on Windows) or Ctrl-D (on macOS and Linux):<br class="calibre9" />26.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('(Press Ctrl-C (on Windows) or Ctrl-D (on macOS and Linux) to<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quit at any time.)')<br class="calibre9" />27.<br class="calibre9" />28.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Brute-force by looping through every possible key:<br class="calibre9" />29.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for key in range(1, len(message)):<br class="calibre9" />30.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Trying key #%s...' % (key))<br class="calibre9" />31.<br class="calibre9" />32.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedText = transpositionDecrypt.decryptMessage(key, message)<br class="calibre9" />33.<br class="calibre9" />34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if detectEnglish.isEnglish(decryptedText):<br class="calibre9" />35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ask user if this is the correct decryption:<br class="calibre9" />36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre9" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-275"></span>37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Possible encryption hack:')<br class="calibre9" />38.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Key %s: %s' % (key, decryptedText[:100]))<br class="calibre9" />39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre9" />40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Enter D if done, anything else to continue hacking:')<br class="calibre9" />41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response = input('&gt; ')<br class="calibre9" />42.<br class="calibre9" />43.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if response.strip().upper().startswith('D'):<br class="calibre9" />44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return decryptedText<br class="calibre9" />45.<br class="calibre9" />46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None<br class="calibre9" />47.<br class="calibre9" />48. if __name__ == '__main__':<br class="calibre9" />49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main()</p>
<h3 class="h1" id="calibre_link-629"><strong class="calibre3">Sample Run of the Transposition Cipher Hacker Program</strong></h3>
<p class="noindent">When you run the <em class="calibre7">transpositionHacker.py</em> program, the output should look like this:</p>
<p class="programs1">Hacking...<br class="calibre9" />(Press Ctrl-C (on Windows) or Ctrl-D (on macOS and Linux) to quit at any time.)<br class="calibre9" />Trying key #1...<br class="calibre9" />Trying key #2...<br class="calibre9" />Trying key #3...<br class="calibre9" />Trying key #4...<br class="calibre9" />Trying key #5...<br class="calibre9" />Trying key #6...<br class="calibre9" />Possible encryption hack:<br class="calibre9" />Key 6: Augusta Ada King-Noel, Countess of Lovelace (10 December 1815 - 27<br class="calibre9" />November 1852) was an English mat<br class="calibre9" />Enter D if done, anything else to continue hacking:<br class="calibre9" />&gt; <span class="codestrong">D</span><br class="calibre9" />Copying hacked message to clipboard:<br class="calibre9" />Augusta Ada King-Noel, Countess of Lovelace (10 December 1815 - 27 November<br class="calibre9" />1852) was an English mathematician and writer, chiefly known for her work on<br class="calibre9" />Charles Babbage's early mechanical general-purpose computer, the Analytical<br class="calibre9" />Engine. Her notes on the engine include what is recognised as the first<br class="calibre9" />algorithm intended to be carried out by a machine. As a result, she is often<br class="calibre9" />regarded as the first computer programmer.</p>
<p class="indent">After trying key #6, the program returns a snippet of the decrypted message for the user to confirm that it has found the right key. In this example, the message looks promising. When the user confirms the decryption is correct by entering <span class="literal">D</span>, the program returns the entire hacked message. You can see it’s a biographical note about Ada Lovelace. (Her algorithm for calculating Bernoulli numbers, devised in 1842 and 1843, made her the first computer programmer.) If the decryption is a false positive, the user can press anything else, and the program will continue to try other keys.</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-95"></span>Run the program again and skip the correct decryption by pressing anything other than <span class="literal">D</span>. The program assumes that it didn’t find the correct decryption and continues its brute-force approach through the other possible keys.</p>
<p class="programs1">--<span class="codeitalic">snip</span>--<br class="calibre9" />Trying key #417...<br class="calibre9" />Trying key #418...<br class="calibre9" />Trying key #419...<br class="calibre9" />Failed to hack encryption.</p>
<p class="indent">Eventually, the program runs through all the possible keys and then gives up, informing the user that it was unable to hack the ciphertext.</p>
<p class="indent">Let’s take a closer look at the source code to see how the program works.</p>
<h3 class="h1" id="calibre_link-630"><strong class="calibre3">Importing the Modules</strong></h3>
<p class="noindent">The first few lines of the code tell the user what this program will do. Line 4 imports several modules that we’ve written or seen in previous chapters: <em class="calibre7">pyperclip.py</em>, <em class="calibre7">detectEnglish.py</em>, and <em class="calibre7">transpositionDecrypt.py</em>.</p>
<p class="programs1">&nbsp;1. # Transposition Cipher Hacker<br class="calibre9" />&nbsp;2. # https://www.nostarch.com/crackingcodes/ (BSD Licensed)<br class="calibre9" />&nbsp;3.<br class="calibre9" />&nbsp;4. import pyperclip, detectEnglish, transpositionDecrypt</p>
<p class="indent">The transposition cipher hacker program, containing approximately 50 lines of code, is fairly short because much of it exists in other programs that we’re using as modules.</p>
<h3 class="h1" id="calibre_link-631"><strong class="calibre3">Multiline Strings with Triple Quotes</strong></h3>
<p class="noindent">The <span class="literal">myMessage</span> variable stores the ciphertext we’re trying to hack. Line 9 stores a string value that begins and ends with triple quotes. Notice that it’s a very long string.</p>
<p class="programs1">&nbsp;6. def main():<br class="calibre9" />&nbsp;7.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# You might want to copy &amp; paste this text from the source code at<br class="calibre9" />&nbsp;8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# https://www.nostarch.com/crackingcodes/:<br class="calibre9" />&nbsp;9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myMessage = """AaKoosoeDe5 b5sn ma reno ora'lhlrrceey e&nbsp;&nbsp;enlh <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;na&nbsp;&nbsp;indeit n uhoretrm au ieu v er Ne2 gmanw,forwnlbsya apor tE.no <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;euarisfatt&nbsp;&nbsp;e mealefedhsppmgAnlnoe(c -or)alat r lw o eb&nbsp;&nbsp;nglom,Ain <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one dtes ilhetcdba. t tg eturmudg,tfl1e1 v&nbsp;&nbsp;nitiaicynhrCsaemie-sp <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ncgHt nie cetrgmnoa yc r,ieaa&nbsp;&nbsp;toesa- e a0m82e1w shcnth&nbsp;&nbsp;ekh <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gaecnpeutaaieetgn iodhso d ro hAe snrsfcegrt NCsLc b17m8aEheideikfr <br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aBercaeu thllnrshicwsg etriebruaisss&nbsp;&nbsp;d iorr."""</p>
<p class="indent">Triple quote strings are also called <em class="calibre7">multiline strings</em> because they span multiple lines and can contain line breaks within them. Multiline strings are <span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-96"></span>useful for putting large strings into a program’s source code and because single and double quotes don’t need to be escaped within them. To see an example of a multiline string, enter the following into the interactive shell:</p>
<p class="programs1">&gt;&gt;&gt; <span class="codestrong">spam =</span> """<span class="codestrong">Dear Alice,</span><br class="calibre9" /><span class="codestrong">Why did you dress up my hamster in doll clothing?</span><br class="calibre9" /><span class="codestrong">I look at Mr. Fuzz and think,</span> "<span class="codestrong">I know this was Alice's doing.</span>"<br class="calibre9" /><span class="codestrong">Sincerely,</span><br class="calibre9" /><span class="codestrong">Brienne</span>"""<br class="calibre9" />&gt;&gt;&gt; <span class="codestrong">print(spam)</span><br class="calibre9" />Dear Alice,<br class="calibre9" />Why did you dress up my hamster in doll clothing?<br class="calibre9" />I look at Mr. Fuzz and think, "I know this was Alice's doing."<br class="calibre9" />Sincerely,<br class="calibre9" />Brienne</p>
<p class="indent">Notice that this string value, like our ciphertext string, spans multiple lines. Everything after the opening triple quotes will be interpreted as part of the string until the program reaches the triple quotes ending it. You can make multiline strings using either three double-quote characters or three single-quote characters.</p>
<h3 class="h1" id="calibre_link-632"><strong class="calibre3">Displaying the Results of Hacking the Message</strong></h3>
<p class="noindent">The ciphertext-hacking code exists inside the <span class="literal">hackTransposition()</span> function, which is called on line 11 and which we’ll define on line 21. This function takes one string argument: the encrypted ciphertext message we’re trying to hack. If the function can hack the ciphertext, it returns a string of the decrypted text. Otherwise, it returns the <span class="literal">None</span> value.</p>
<p class="programs1">11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hackedMessage = hackTransposition(myMessage)<br class="calibre9" />12.<br class="calibre9" />13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if hackedMessage == None:<br class="calibre9" />14.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Failed to hack encryption.')<br class="calibre9" />15.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre9" />16.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Copying hacked message to clipboard:')<br class="calibre9" />17.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(hackedMessage)<br class="calibre9" />18.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pyperclip.copy(hackedMessage)</p>
<p class="indent">Line 11 calls the <span class="literal">hackTransposition()</span> function to return the hacked message if the attempt is successful or the <span class="literal">None</span> value if the attempt is unsuccessful, and it stores the returned value in <span class="literal">hackedMessage</span>.</p>
<p class="indent">Lines 13 and 14 tell the program what to do if the function is unable to hack the ciphertext. If <span class="literal">None</span> was stored in <span class="literal">hackedMessage</span>, the program lets the user know by printing that it was unable to break the encryption on the message.</p>
<p class="indent">The next four lines show what the program does if the function is able to hack the ciphertext. Line 17 prints the decrypted message, and line 18 copies it to the clipboard. However, for this code to work, we also need to define the <span class="literal">hackTransposition()</span> function, which we’ll do next.</p>
<h3 class="h1" id="calibre_link-633"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-256" class="calibre1"></span><strong class="calibre3">Getting the Hacked Message</strong></h3>
<p class="noindent">The <span class="literal">hackTransposition()</span> function starts with a couple <span class="literal">print()</span> statements.</p>
<p class="programs1">21. def hackTransposition(message):<br class="calibre9" />22.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Hacking...')<br class="calibre9" />23.<br class="calibre9" />24.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Python programs can be stopped at any time by pressing<br class="calibre9" />25.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ctrl-C (on Windows) or Ctrl-D (on macOS and Linux):<br class="calibre9" />26.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('(Press Ctrl-C (on Windows) or Ctrl-D (on macOS and Linux) to<br class="calibre9" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quit at any time.)')</p>
<p class="indent">Because the program can try many keys, the program displays a message telling the user that the hacking has started and that it might take a moment to finish the process. The <span class="literal">print()</span> call on line 26 tells the user to press <small class="calibre14">ctrl</small>-C (on Windows) or <small class="calibre14">ctrl</small>-D (on macOS and Linux) to exit the program at any point. You can actually press these keys to exit any running Python program.</p>
<p class="indent">The next couple lines tell the program which keys to loop through by specifying the range of possible keys for the transposition cipher:</p>
<p class="programs1">28.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Brute-force by looping through every possible key:<br class="calibre9" />29.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for key in range(1, len(message)):<br class="calibre9" />30.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Trying key #%s...' % (key))</p>
<p class="indent">The possible keys for the transposition cipher range between 1 and the length of the message. The <span class="literal">for</span> loop on line 29 runs the hacking part of the function with each of these keys. Line 30 uses string interpolation to print the key currently being tested using string interpolation to provide feedback to the user.</p>
<p class="indent">Using the <span class="literal">decryptMessage()</span> function in the <em class="calibre7">transpositionDecrypt.py</em> program that we’ve already written, line 32 gets the decrypted output from the current key being tested and stores it in the <span class="literal">decryptedText</span> variable:</p>
<p class="programs1">32.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptedText = transpositionDecrypt.decryptMessage(key, message)</p>
<p class="indent">The decrypted output in <span class="literal">decryptedText</span> will be English only if the correct key was used. Otherwise, it will appear as garbage text.</p>
<p class="indent">Then the program passes the string in <span class="literal">decryptedText</span> to the <span class="literal">detectEnglish</span><span class="literal">.isEnglish()</span> function we wrote in <a href="#calibre_link-28" class="calibre8">Chapter 11</a> and prints part of <span class="literal">decryptedText</span>, the <span class="literal">key</span> used, and instructions for the user:</p>
<p class="programs1">34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if detectEnglish.isEnglish(decryptedText):<br class="calibre9" />35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Ask user if this is the correct decryption:<br class="calibre9" />36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre9" />37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Possible encryption hack:')<br class="calibre9" />38.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Key %s: %s' % (key, decryptedText[:100]))<br class="calibre9" />39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre9" />40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Enter D if done, anything else to continue hacking:')<br class="calibre9" />41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response = input('&gt; ')</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-296"></span>But just because <span class="literal">detectEnglish.isEnglish()</span> returns <span class="literal">True</span> and moves the execution to line 35 doesn’t mean the program has found the correct key. It could be a false positive, meaning the program detected some text as English that is actually garbage text. To make sure, line 38 gives a preview of the text so the user can confirm that the text is indeed English. It uses the slice <span class="literal">decryptedText[:100]</span> to print out the first 100 characters of <span class="literal">decryptedText</span>.</p>
<p class="indent">The program pauses when line 41 executes, waits for the user to enter either <span class="literal">D</span> or anything else, and then stores this input as a string in <span class="literal">response</span>.</p>
<h4 class="h2" id="calibre_link-634"><strong class="calibre3"><em class="calibre12">The strip() String Method</em></strong></h4>
<p class="noindent">When a program gives a user specific instructions but the user doesn’t follow them exactly, an error results. When the <em class="calibre7">transpositionHacker.py</em> program prompts the user to enter <span class="literal">D</span> to confirm the hacked message, it means the program won’t accept any input other than <span class="literal">D</span>. If a user enters an extra space or character along with <span class="literal">D</span>, the program won’t accept it. Let’s look at how to use the <span class="literal">strip()</span> string method to make the program accept other inputs as long as they’re similar enough to <span class="literal">D</span>.</p>
<p class="indent">The <span class="literal">strip()</span> string method returns a version of the string with any whitespace characters at the beginning and end of the string stripped out. The <em class="calibre7">whitespace characters</em> are the space character, the tab character, and the newline character. Enter the following into the interactive shell to see how this works:</p>
<p class="programs1">&gt;&gt;&gt; <span class="codestrong">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello'.strip()</span><br class="calibre9" />'Hello'<br class="calibre9" />&gt;&gt;&gt; <span class="codestrong">'Hello&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.strip()</span><br class="calibre9" />'Hello'<br class="calibre9" />&gt;&gt;&gt; <span class="codestrong">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello World&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.strip()</span><br class="calibre9" />'Hello World'</p>
<p class="indent">In this example, <span class="literal">strip()</span> removes the space characters at the beginning or the end of the first two strings. If a string like <span class="literal">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello World&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</span> includes spaces at the beginning and end of the string, the method removes them from both sides but doesn’t remove any spaces between other characters.</p>
<p class="indent">The <span class="literal">strip()</span> method can also have a string argument passed to it that tells the method to remove characters other than whitespace from the beginning and end of the string. To see an example, enter the following into the interactive shell:</p>
<p class="programs1">&gt;&gt;&gt; <span class="codestrong">'aaaaaHELLOaa'.strip('a')</span><br class="calibre9" />'HELLO'<br class="calibre9" />&gt;&gt;&gt; <span class="codestrong">'ababaHELLObaba'.strip('ab')</span><br class="calibre9" />'HELLO'<br class="calibre9" />&gt;&gt;&gt; <span class="codestrong">'abccabcbacbXYZabcXYZacccab'.strip('abc')</span><br class="calibre9" />'XYZabcXYZ'</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-257"></span>Notice that passing the string arguments <span class="literal">'a'</span> and <span class="literal">'ab'</span> removes these characters when they occur at the beginning or end of the string. However, <span class="literal">strip()</span> doesn’t remove characters embedded in the middle of the string. As you can see in the third example, the string <span class="literal">'abc'</span> remains in <span class="literal">'</span><span class="literal">XYZabcXYZ'</span>.</p>
<h4 class="h2" id="calibre_link-635"><strong class="calibre3"><em class="calibre12">Applying the strip() String Method</em></strong></h4>
<p class="noindent">Let’s return to the source code in <em class="calibre7">transpositionHacker.py</em> to see how to apply <span class="literal">strip()</span> in the program. Line 43 sets a condition using the <span class="literal">if</span> statement to give the user some input flexibility:</p>
<p class="programs1">43.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if response.strip().upper().startswith('D'):<br class="calibre9" />44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return decryptedText</p>
<p class="indent">If the condition for the statement were simply <span class="literal">response == 'D'</span>, the user would have to enter <span class="literal">D</span> exactly and nothing else to end the program. For example, if the user enters <span class="literal">'d'</span>, <span class="literal">'&nbsp;&nbsp;&nbsp;&nbsp;D'</span>, or <span class="literal">'Done'</span>, the condition would be <span class="literal">False</span> and the program would continue checking other keys instead of returning the hacked message.</p>
<p class="indent">To avoid this issue, the string in <span class="literal">response</span> removes whitespace from the start or end of the string with the call to <span class="literal">strip()</span>. Then the string that <span class="literal">response.strip()</span> evaluates to has the <span class="literal">upper()</span> method called on it. Whether the user enters <span class="literal">'d'</span> or <span class="literal">'D'</span>, the string returned from <span class="literal">upper()</span> will always be capitalized as <span class="literal">'D'</span>. Adding flexibility in the type of input the program can accept makes it easier to use.</p>
<p class="indent">To make the program accept user input that starts with <span class="literal">'D'</span> but is a full word, we use <span class="literal">startswith()</span> to check only the first letter. For example, if the user inputs <span class="literal">'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done'</span> as <span class="literal">response</span>, the whitespace would be stripped and then the string <span class="literal">'done'</span> would be passed to <span class="literal">upper()</span>. After <span class="literal">upper()</span> capitalizes the whole string to <span class="literal">'DONE'</span>, the string is passed to <span class="literal">startswith()</span>, which returns <span class="literal">True</span> because the string does start with the substring <span class="literal">'D'</span>.</p>
<p class="indent">If the user indicates that the decrypted string is correct, the function <span class="literal">hackTransposition</span><span class="literal">()</span> on line 44 returns the decrypted text.</p>
<h4 class="h2" id="calibre_link-636"><strong class="calibre3"><em class="calibre12">Failing to Hack the Message</em></strong></h4>
<p class="noindent">Line 46 is the first line after the <span class="literal">for</span> loop that began on line 29:</p>
<p class="programs1">46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None</p>
<p class="indent">If the program execution reaches this point, it means the program never reached the <span class="literal">return</span> statement on line 44, which would happen if the correctly decrypted text was never found for any of the keys that were tried. In that case, line 46 returns the <span class="literal">None</span> value to indicate that the hacking failed.</p>
<h3 class="h1" id="calibre_link-637"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-287" class="calibre1"></span><strong class="calibre3">Calling the main() Function</strong></h3>
<p class="noindent">Lines 48 and 49 call the <span class="literal">main()</span> function if this program was run by itself rather than being imported by another program using its <span class="literal">hackTransposition</span><span class="literal">()</span> function:</p>
<p class="programs1">48. if __name__ == '__main__':<br class="calibre9" />49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main()</p>
<p class="indent">Remember that the <span class="literal">__name__</span> variable is set by Python. The <span class="literal">main()</span> function will not be called if <em class="calibre7">transpositionHacker.py</em> is imported as a module.</p>
<h3 class="h1" id="calibre_link-638"><strong class="calibre3">Summary</strong></h3>
<p class="noindent">Like <a href="#calibre_link-20" class="calibre8">Chapter 6</a>, this chapter was short because most of the code was already written in other programs. Our hacking program can use functions from other programs by importing them as modules.</p>
<p class="indent">You learned how to use triple quotes to include a string value that spans multiple lines in the source code. You also learned that the <span class="literal">strip()</span> string method is useful for removing whitespace or other characters from the beginning or end of a string.</p>
<p class="indent">Using the <em class="calibre7">detectEnglish.py</em> program saved us a lot of time we would have had to spend manually inspecting every decrypted output to see if it was English. It allowed us to use the brute-force technique to hack a cipher that has thousands of possible keys.</p>
<div class="sidebar">
<p class="sidebart" id="calibre_link-639"><strong class="calibre5">PRACTICE QUESTIONS</strong></p>
<p class="noindent">Answers to the practice questions can be found on the book’s website at <em class="calibre7"><a href="https://www.nostarch.com/crackingcodes/" class="calibre8">https://www.nostarch.com/crackingcodes/</a></em>.</p>
<ol class="calibre13">
<li value="1" class="calibre11"><p class="noindent">What does this expression evaluate to?</p>
<p class="programs1">'&nbsp;&nbsp;&nbsp;Hello world'.strip()</p>
</li>
<li value="2" class="calibre11"><p class="noindent">Which characters are whitespace characters?</p>
</li>
<li value="3" class="calibre11"><p class="noindent">Why does <span class="literal">'Hello world'.strip('o')</span> evaluate to a string that still has <em class="calibre7">O</em>s in it?</p></li>
<li value="4" class="calibre11"><p class="noindent">Why does <span class="literal">'xxxHelloxxx'.strip('X')</span> evaluate to a string that still has <em class="calibre7">X</em>s in it?</p></li>
</ol>
<span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-937"></span>
</div>
</div>



<a href="chapter11.html">Prev: Chapter 11 - Detecting English Programmatically</a> | <a href="chapter13.html">Next: Chapter 13 - A Modular Arithmetic Module for the Affine Cipher</a>
</body></html>