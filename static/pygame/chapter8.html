<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpFirst
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpMiddle
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpLast
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:black;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Tahoma","sans-serif";}
span.MsoPlaceholderText
	{color:gray;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpFirst, li.MsoTocHeadingCxSpFirst, div.MsoTocHeadingCxSpFirst
	{margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpMiddle, li.MsoTocHeadingCxSpMiddle, div.MsoTocHeadingCxSpMiddle
	{margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpLast, li.MsoTocHeadingCxSpLast, div.MsoTocHeadingCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:black;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.TableHeading
	{mso-style-name:"Table Heading";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:black;
	text-decoration:underline;}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";
	color:#1F497D;}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";
	color:#1F497D;}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";
	color:#1F497D;}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";
	color:#1F497D;}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code Headline";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code HeadlineCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code HeadlineCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code HeadlineCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";
	font-family:"Times New Roman","serif";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.XXX
	{mso-style-name:XXX;
	font-family:Courier;
	color:red;}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style="background-color: #fffeee;">


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">Other programming books by Al Sweigart:<br>
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">X</a>

  <a target="_blank" href="https://www.amazon.com/gp/product/1593275994/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593275994&linkCode=as2&tag=playwithpyth-20&linkId=385b77199fa1e9f4fd21652cc57dab33" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1503212300?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1503212300" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.png" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1482614375/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1482614375&amp;linkCode=as2&amp;tag=playwithpyth-20" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1593277628/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593277628&linkCode=as2&tag=playwithpyth-20&linkId=0f1bd157c25d2e97db13d6434e5476a8"><img src="/images/cover_scratchprogrammingplayground_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://www.udemy.com/automate/?couponCode=INVENT_WITH_PYTHON">Use this link to get 80%% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>




<div class=WordSection1>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 4.0pt 0in'>

<h1><a name="_Toc316488698"><span style='font-variant:normal !important;
text-transform:uppercase'>Chapter 8 – Squirrel Eat Squirrel</span></a></h1>

</div>

<p class=MsoNormal align=center style='text-align:center'><img width=274
height=216 id="Picture 42" src="chapter8_files/image001.jpg">    <img
width=274 height=216 id="Picture 43" src="chapter8_files/image002.jpg"></p>

<h2><a name="_Toc316488699">How to Play Squirrel Eat Squirrel</a></h2>

<p class=MsoNormal>Squirrel Eat Squirrel is loosely based on the game “Katamari
Damacy”. The player controls a small squirrel that must hop around the screen
eating smaller squirrels and avoiding larger squirrels. Each time the player’s
squirrel eats a squirrel that is smaller than it, it grows larger. If the
player’s squirrel gets hit by a larger squirrel larger than it, it loses a life
point. The player wins when the squirrel becomes a monstrously large squirrel
called the Omega Squirrel. The player loses if their squirrel gets hit three
times.</p>

<p class=MsoNormal>I’m not really sure where I got the idea for a video game where
squirrels eat each other. I’m a little strange sometimes.</p>

<h2><a name="_Toc316488700">The Design of Squirrel Eat Squirrel</a></h2>

<p class=MsoNormal>There are three types of data structures in this game, which
are represented as dictionary values. The types are player squirrels, enemy
squirrels, and grass objects. There is only one player squirrel object at a
time in the game.</p>

<p class=MsoNormal>Note: Technically, “object” means something specific in
Object-Oriented Programming. Python does have OOP features, but they aren’t
covered in this book. Technically the Pygame objects such as “Rect object” or
“Surface object” are objects. But I’m going to use the term “object” in this
book to refer to “things that exist in the game world”. But really, the player
squirrel, enemy squirrels, and grass “objects” are just dictionary values.</p>

<p class=MsoNormal>All the objects have the following keys in their dictionary
value: <span class=Literal>'x'</span>, <span class=Literal>'y'</span>, and <span
class=Literal>'rect'</span>. The <span class=Literal>'x'</span> and <span
class=Literal>'y'</span> key’s value give the coordinates of the top left of
the object in <em>game world coordinates</em>. These are different from pixel
coordinates (which is what the <span class=Literal>'rect'</span> key’s value
tracks). The difference between game world and pixel coordinates will be
explained when you learn about the concept of cameras.</p>

<p class=MsoNormal>In addition, the player squirrel, enemy squirrel, and grass
objects have other keys which are explained in a large comment at the start of
the source code. </p>

<h2><a name="_Toc316488701">Source Code to Squirrel Eat Squirrel</a></h2>

<p class=MsoNormal>This source code can be downloaded from <span class=URL><a href="//invpy.com/squirrel.py">http://invpy.com/squirrel.py</a></span>.
If you get any error messages, look at the line number that is mentioned in the
error message and check your code for any typos. You can also copy and paste your
code into the web form at <span class=URL><a href="//invpy.com/diff/squirrel">http://invpy.com/diff/squirrel</a></span>
to see if the differences between your code and the code in the book.</p>

<p class=MsoNormal>You will also need to download the following image files:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/gameicon.png">http://invpy.com/gameicon.png</a></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/squirrel.png">http://invpy.com/squirrel.png</a></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/grass1.png">http://invpy.com/grass1.png</a></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/grass2.png">http://invpy.com/grass2.png</a></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/grass3.png">http://invpy.com/grass3.png</a></span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=URL><a href="//invpy.com/grass4.png">http://invpy.com/grass4.png</a></span></p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst>  <span class=SourceLineNumber>1. </span><span
class=SourceCodeComment># Squirrel Eat Squirrel (a 2D Katamari Damacy clone)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>2. </span><span
class=SourceCodeComment># By Al Sweigart al@inventwithpython.com</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>3. </span><span
class=SourceCodeComment># http://inventwithpython.com/pygame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>4. </span><span
class=SourceCodeComment># Creative Commons BY-NC-SA 3.0 US</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>6. </span>import
random, sys, time, math, pygame</p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>7. </span>from
pygame.locals import *</p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>8. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>9. </span>FPS
= 30 <span class=SourceCodeComment># frames per second to update the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>10. </span>WINWIDTH
= 640 <span class=SourceCodeComment># width of the program's window, in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>11. </span>WINHEIGHT
= 480 <span class=SourceCodeComment># height in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>12. </span>HALF_WINWIDTH
= int(WINWIDTH / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>13. </span>HALF_WINHEIGHT
= int(WINHEIGHT / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>14. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>15. </span>GRASSCOLOR
= (24, 255, 0)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>16. </span>WHITE
= (255, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>17. </span>RED
= (255, 0, 0)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>18. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19. </span>CAMERASLACK
= 90     <span class=SourceCodeComment># how far from the center the squirrel
moves before moving the camera</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20. </span>MOVERATE
= 9         <span class=SourceCodeComment># how fast the player moves</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>21. </span>BOUNCERATE
= 6       <span class=SourceCodeComment># how fast the player bounces (large is
slower)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>22. </span>BOUNCEHEIGHT
= 30    <span class=SourceCodeComment># how high the player bounces</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>23. </span>STARTSIZE
= 25       <span class=SourceCodeComment># how big the player starts off</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>24. </span>WINSIZE
= 300        <span class=SourceCodeComment># how big the player needs to be to
win</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>25. </span>INVULNTIME
= 2       <span class=SourceCodeComment># how long the player is invulnerable
after being hit in seconds</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>26. </span>GAMEOVERTIME
= 4     <span class=SourceCodeComment># how long the &quot;game over&quot; text
stays on the screen in seconds</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>27. </span>MAXHEALTH
= 3        <span class=SourceCodeComment># how much health the player starts
with</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>29. </span>NUMGRASS
= 80        <span class=SourceCodeComment># number of grass objects in the active
area</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>30. </span>NUMSQUIRRELS
= 30    <span class=SourceCodeComment># number of squirrels in the active area</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>31. </span>SQUIRRELMINSPEED
= 3 <span class=SourceCodeComment># slowest squirrel speed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>32. </span>SQUIRRELMAXSPEED
= 7 <span class=SourceCodeComment># fastest squirrel speed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>33. </span>DIRCHANGEFREQ
= 2    <span class=SourceCodeComment># % chance of direction change per frame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>34. </span>LEFT
= 'left'</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>35. </span>RIGHT
= 'right'</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>36. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37. </span><span
class=SourceCodeComment>&quot;&quot;&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>38. </span><span
class=SourceCodeComment>This program has three data structures to represent the
player, enemy squirrels, and grass background objects. The data structures are
dictionaries with the following keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>39. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>40. </span><span
class=SourceCodeComment>Keys used by all three data structures:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>41. </span>    <span
class=SourceCodeComment>'x' - the left edge coordinate of the object in the
game world (not a pixel coordinate on the screen)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>42. </span>    <span
class=SourceCodeComment>'y' - the top edge coordinate of the object in the game
world (not a pixel coordinate on the screen)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>43. </span>    <span
class=SourceCodeComment>'rect' - the pygame.Rect object representing where on
the screen the object is located.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>44. </span><span
class=SourceCodeComment>Player data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>45. </span>    <span
class=SourceCodeComment>'surface' - the pygame.Surface object that stores the
image of the squirrel which will be drawn to the screen.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>46. </span>    <span
class=SourceCodeComment>'facing' - either set to LEFT or RIGHT, stores which
direction the player is facing.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>47. </span>    <span
class=SourceCodeComment>'size' - the width and height of the player in pixels.
(The width &amp; height are always the same.)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>48. </span>    <span
class=SourceCodeComment>'bounce' - represents at what point in a bounce the
player is in. 0 means standing (no bounce), up to BOUNCERATE (the completion of
the bounce)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>49. </span>    <span
class=SourceCodeComment>'health' - an integer showing how many more times the
player can be hit by a larger squirrel before dying.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>50. </span><span
class=SourceCodeComment>Enemy Squirrel data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>51. </span>    <span
class=SourceCodeComment>'surface' - the pygame.Surface object that stores the
image of the squirrel which will be drawn to the screen.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>52. </span>    <span
class=SourceCodeComment>'movex' - how many pixels per frame the squirrel moves
horizontally. A negative integer is moving to the left, a positive to the
right.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>53. </span>    <span
class=SourceCodeComment>'movey' - how many pixels per frame the squirrel moves
vertically. A negative integer is moving up, a positive moving down.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>54. </span>    <span
class=SourceCodeComment>'width' - the width of the squirrel's image, in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>55. </span>    <span
class=SourceCodeComment>'height' - the height of the squirrel's image, in
pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>56. </span>    <span
class=SourceCodeComment>'bounce' - represents at what point in a bounce the
player is in. 0 means standing (no bounce), up to BOUNCERATE (the completion of
the bounce)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>57. </span>    <span
class=SourceCodeComment>'bouncerate' - how quickly the squirrel bounces. A
lower number means a quicker bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>58. </span>    <span
class=SourceCodeComment>'bounceheight' - how high (in pixels) the squirrel
bounces</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>59. </span><span
class=SourceCodeComment>Grass data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>60. </span>    <span
class=SourceCodeComment>'grassImage' - an integer that refers to the index of
the pygame.Surface object in GRASSIMAGES used for this grass object</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>61. </span><span
class=SourceCodeComment>&quot;&quot;&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>62. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span>def
main():</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>64. </span>    global
FPSCLOCK, DISPLAYSURF, BASICFONT, L_SQUIR_IMG, R_SQUIR_IMG, GRASSIMAGES</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>65. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>66. </span>    pygame.init()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>67. </span>    FPSCLOCK
= pygame.time.Clock()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>68. </span>    pygame.display.set_icon(pygame.image.load('gameicon.png'))</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>69. </span>    DISPLAYSURF
= pygame.display.set_mode((WINWIDTH, WINHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>70. </span>    pygame.display.set_caption('Squirrel
Eat Squirrel')</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>71. </span>    BASICFONT
= pygame.font.Font('freesansbold.ttf', 32)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>72. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73. </span>    <span
class=SourceCodeComment># load the image files</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>74. </span>    L_SQUIR_IMG
= pygame.image.load('squirrel.png')</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>75. </span>    R_SQUIR_IMG
= pygame.transform.flip(L_SQUIR_IMG, True, False)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>76. </span>    GRASSIMAGES
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>77. </span>    for
i in range(1, 5):</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>78. </span>        GRASSIMAGES.append(pygame.image.load('grass%s.png'
% i))</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>79. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80. </span>    while
True:</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>81. </span>        runGame()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>82. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>83. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84. </span>def
runGame():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>    
<span class=SourceCodeComment># set up variables for the start of a new game</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>86. </span>    invulnerableMode
= False  <span class=SourceCodeComment># if the player is invulnerable</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>87. </span>    invulnerableStartTime
= 0 <span class=SourceCodeComment># time the player became invulnerable</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>88. </span>    gameOverMode
= False      <span class=SourceCodeComment># if the player has lost</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>89. </span>    gameOverStartTime
= 0     <span class=SourceCodeComment># time the player lost</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>90. </span>    winMode
= False           <span class=SourceCodeComment># if the player has won</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>91. </span>    </p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92. </span>    <span
class=SourceCodeComment># create the surfaces to hold game text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>93. </span>    gameOverSurf
= BASICFONT.render('Game Over', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>94. </span>    gameOverRect
= gameOverSurf.get_rect()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>95. </span>    gameOverRect.center
= (HALF_WINWIDTH, HALF_WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>96. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>97. </span>    winSurf
= BASICFONT.render('You have achieved OMEGA SQUIRREL!', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>98. </span>    winRect
= winSurf.get_rect()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>99. </span>    winRect.center
= (HALF_WINWIDTH, HALF_WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101. </span>    winSurf2
= BASICFONT.render('(Press &quot;r&quot; to restart.)', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102. </span>    winRect2
= winSurf2.get_rect()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>103. </span>    winRect2.center
= (HALF_WINWIDTH, HALF_WINHEIGHT + 30)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>104. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105. </span>    <span
class=SourceCodeComment># camerax and cameray are where the middle of the
camera view is</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106. </span>    camerax
= 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107. </span>    cameray
= 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>108. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>109. </span>    grassObjs
= []    <span class=SourceCodeComment># stores all the grass objects in the
game</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110. </span>    squirrelObjs
= [] <span class=SourceCodeComment># stores all the non-player squirrel objects</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111. </span>    <span
class=SourceCodeComment># stores the player object:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112. </span>    playerObj
= {'surface': pygame.transform.scale(L_SQUIR_IMG, (STARTSIZE, STARTSIZE)),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113. </span>                 'facing':
LEFT,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114. </span>                 'size':
STARTSIZE,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115. </span>                 'x':
HALF_WINWIDTH,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span>                 'y':
HALF_WINHEIGHT,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117. </span>                 'bounce':0,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118. </span>                 'health':
MAXHEALTH}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120. </span>    moveLeft 
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121. </span>    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>122. </span>    moveUp   
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>123. </span>    moveDown 
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>124. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>125. </span>    <span
class=SourceCodeComment># start off with some random grass images on the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126. </span>    for
i in range(10):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127. </span>        grassObjs.append(makeNewGrass(camerax,
cameray))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128. </span>        grassObjs[i]['x']
= random.randint(0, WINWIDTH)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>129. </span>        grassObjs[i]['y']
= random.randint(0, WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>130. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>131. </span>    while
True: <span class=SourceCodeComment># main game loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132. </span>        <span
class=SourceCodeComment># Check if we should turn off invulnerability</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133. </span>        if
invulnerableMode and time.time() - invulnerableStartTime &gt; INVULNTIME:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>134. </span>            invulnerableMode
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>135. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>136. </span>        <span
class=SourceCodeComment># move all the squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>137. </span>        for
sObj in squirrelObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138. </span>            <span
class=SourceCodeComment># move the squirrel, and adjust for their bounce</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139. </span>            sObj['x']
+= sObj['movex']</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140. </span>            sObj['y']
+= sObj['movey']</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141. </span>            sObj['bounce']
+= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142. </span>            if
sObj['bounce'] &gt; sObj['bouncerate']:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>143. </span>                sObj['bounce']
= 0 <span class=SourceCodeComment># reset bounce amount</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>144.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145. </span>            <span
class=SourceCodeComment># random chance they change direction</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146. </span>            if
random.randint(0, 99) &lt; DIRCHANGEFREQ:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147. </span>                sObj['movex']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148. </span>                sObj['movey']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149. </span>                if
sObj['movex'] &gt; 0: <span class=SourceCodeComment># faces right</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150. </span>                    sObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (sObj['width'], sObj['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151. </span>                else:
<span class=SourceCodeComment># faces left</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>152. </span>                    sObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (sObj['width'], sObj['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>153.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>154. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>155. </span>        <span
class=SourceCodeComment># go through all the objects and see if any need to be
deleted.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156. </span>        for
i in range(len(grassObjs) - 1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157. </span>            if
isOutsideActiveArea(camerax, cameray, grassObjs[i]):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158. </span>                del
grassObjs[i]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159. </span>        for
i in range(len(squirrelObjs) - 1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160. </span>            if
isOutsideActiveArea(camerax, cameray, squirrelObjs[i]):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>161. </span>                del
squirrelObjs[i]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>162. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>163. </span>        <span
class=SourceCodeComment># add more grass &amp; squirrels if we don't have
enough.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>164. </span>        while
len(grassObjs) &lt; NUMGRASS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165. </span>            grassObjs.append(makeNewGrass(camerax,
cameray))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166. </span>        while
len(squirrelObjs) &lt; NUMSQUIRRELS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>167. </span>            squirrelObjs.append(makeNewSquirrel(camerax,
cameray))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>168. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>169. </span>        <span
class=SourceCodeComment># adjust camerax and cameray if beyond the &quot;camera
slack&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>170. </span>        playerCenterx
= playerObj['x'] + int(playerObj['size'] / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>171. </span>        playerCentery
= playerObj['y'] + int(playerObj['size'] / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>172.</span>         if
(camerax + HALF_WINWIDTH) - playerCenterx &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>173.</span>             camerax
= playerCenterx + CAMERASLACK - HALF_WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>174.</span>         elif
playerCenterx – (camerax + HALF_WINWIDTH) &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>175.</span>             camerax
= playerCenterx – CAMERASLACK - HALF_WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>176.</span>         if
(cameray + HALF_WINHEIGHT) - playerCentery &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>177.</span>             cameray
= playerCentery + CAMERASLACK - HALF_WINHEIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>178.</span>         elif
playerCentery – (cameray + HALF_WINHEIGHT) &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>179.</span>             cameray
= playerCentery – CAMERASLACK - HALF_WINHEIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>180. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>181. </span>        <span
class=SourceCodeComment># draw the green background</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>182. </span>        DISPLAYSURF.fill(GRASSCOLOR)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>183. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>184. </span>        <span
class=SourceCodeComment># draw all the grass objects on the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>185. </span>        for
gObj in grassObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>186. </span>            gRect
= pygame.Rect( (gObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187. </span>                                  gObj['y']
- cameray,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>188. </span>                                  gObj['width'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>189. </span>                                  gObj['height'])
)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>190. </span>            DISPLAYSURF.blit(GRASSIMAGES[gObj['grassImage']],
gRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>191.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>192. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>193. </span>        <span
class=SourceCodeComment># draw the other squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>194. </span>        for
sObj in squirrelObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>195. </span>            sObj['rect']
= pygame.Rect( (sObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>196. </span>                                         sObj['y']
- cameray - getBounceAmount(sObj['bounce'], sObj['bouncerate'],
sObj['bounceheight']),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>197. </span>                                         sObj['width'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span>                                         sObj['height'])
)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>199. </span>            DISPLAYSURF.blit(sObj['surface'],
sObj['rect'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>200.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>201. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>202. </span>        <span
class=SourceCodeComment># draw the player squirrel</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>203. </span>        flashIsOn
= round(time.time(), 1) * 10 % 2 == 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>204. </span>        if
not gameOverMode and not (invulnerableMode and flashIsOn):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>205. </span>            playerObj['rect']
= pygame.Rect( (playerObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>206. </span>                                              playerObj['y']
– cameray - getBounceAmount(playerObj['bounce'], BOUNCERATE, BOUNCEHEIGHT),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>207. </span>                                              playerObj['size'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>208. </span>                                              playerObj['size'])
)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>209. </span>            DISPLAYSURF.blit(playerObj['surface'],
playerObj['rect'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>210.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>211. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>212. </span>        <span
class=SourceCodeComment># draw the health meter</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>213. </span>        drawHealthMeter(playerObj['health'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>214. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>215. </span>        for
event in pygame.event.get(): <span class=SourceCodeComment># event handling
loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216. </span>            if
event.type == QUIT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>217. </span>                terminate()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>218.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>219. </span>            elif
event.type == KEYDOWN:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>220. </span>                if
event.key in (K_UP, K_w):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>221. </span>                    moveDown
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>222. </span>                    moveUp
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>223. </span>                elif
event.key in (K_DOWN, K_s):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224. </span>                    moveUp
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>225. </span>                    moveDown
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>226. </span>                elif
event.key in (K_LEFT, K_a):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>227. </span>                    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228. </span>                    moveLeft
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229. </span>                    if
playerObj['facing'] == RIGHT: <span class=SourceCodeComment># change player
image</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230. </span>                        playerObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>231. </span>                    playerObj['facing']
= LEFT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>232. </span>                elif
event.key in (K_RIGHT, K_d):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>233. </span>                    moveLeft
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>234. </span>                    moveRight
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235. </span>                    if
playerObj['facing'] == LEFT: <span class=SourceCodeComment># change player
image</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236. </span>                        playerObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>237. </span>                    playerObj['facing']
= RIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>238. </span>                elif
winMode and event.key == K_r:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>239. </span>                    return</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>240.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>241. </span>            elif
event.type == KEYUP:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242. </span>                <span
class=SourceCodeComment># stop moving the player's squirrel</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243. </span>                if
event.key in (K_LEFT, K_a):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244. </span>                    moveLeft
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>245. </span>                elif
event.key in (K_RIGHT, K_d):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>246. </span>                    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>247. </span>                elif
event.key in (K_UP, K_w):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>248. </span>                    moveUp
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249. </span>                elif
event.key in (K_DOWN, K_s):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>250. </span>                    moveDown
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>251.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>252. </span>                elif
event.key == K_ESCAPE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>253. </span>                    terminate()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>254.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>255. </span>        if
not gameOverMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>256. </span>            <span
class=SourceCodeComment># actually move the player</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257. </span>            if
moveLeft:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258. </span>                playerObj['x']
-= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>259. </span>            if
moveRight:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>260. </span>                playerObj['x']
+= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>261. </span>            if
moveUp:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>262. </span>                playerObj['y']
-= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>263. </span>            if
moveDown:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>264. </span>                playerObj['y']
+= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>265.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>266. </span>            if
(moveLeft or moveRight or moveUp or moveDown) or playerObj['bounce'] != 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>267. </span>                playerObj['bounce']
+= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>268. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>269. </span>            if
playerObj['bounce'] &gt; BOUNCERATE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>270. </span>                playerObj['bounce']
= 0 <span class=SourceCodeComment># reset bounce amount</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>271.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>272. </span>            <span
class=SourceCodeComment># check if the player has collided with any squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>273. </span>            for
i in range(len(squirrelObjs)-1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>274. </span>                sqObj
= squirrelObjs[i]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>275. </span>                if
'rect' in sqObj and playerObj['rect'].colliderect(sqObj['rect']):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>276. </span>                    <span
class=SourceCodeComment># a player/squirrel collision has occurred</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>277.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>278. </span>                    if
sqObj['width'] * sqObj['height'] &lt;= playerObj['size']**2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>279. </span>                        <span
class=SourceCodeComment># player is larger and eats the squirrel</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>280. </span>                        playerObj['size']
+= int( (sqObj['width'] * sqObj['height'])**0.2 ) + 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>281. </span>                        del
squirrelObjs[i]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>282.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>283. </span>                        if
playerObj['facing'] == LEFT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>284. </span>                            playerObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>285. </span>                        if
playerObj['facing'] == RIGHT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>286. </span>                            playerObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>287.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>288. </span>                        if
playerObj['size'] &gt; WINSIZE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>289. </span>                            winMode
= True <span class=SourceCodeComment># turn on &quot;win mode&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>290.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>291. </span>                    elif
not invulnerableMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>292. </span>                        <span
class=SourceCodeComment># player is smaller and takes damage</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>293. </span>                        invulnerableMode
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>294. </span>                        invulnerableStartTime
= time.time()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>295. </span>                        playerObj['health']
-= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>296. </span>                        if
playerObj['health'] == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>297. </span>                            gameOverMode
= True <span class=SourceCodeComment># turn on &quot;game over mode&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>298. </span>                            gameOverStartTime
= time.time()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>299. </span>        else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>300. </span>            <span
class=SourceCodeComment># game is over, show &quot;game over&quot; text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>301. </span>            DISPLAYSURF.blit(gameOverSurf,
gameOverRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>302. </span>            if
time.time() - gameOverStartTime &gt; GAMEOVERTIME:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>303. </span>                return
<span class=SourceCodeComment># end the current game</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>304. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>305. </span>        <span
class=SourceCodeComment># check if the player has won.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>306. </span>        if
winMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>307. </span>            DISPLAYSURF.blit(winSurf,
winRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>308. </span>            DISPLAYSURF.blit(winSurf2,
winRect2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>309. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>310. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>311. </span>        FPSCLOCK.tick(FPS)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>312. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>313. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>314.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>315.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>316. </span>def
drawHealthMeter(currentHealth):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>317. </span>    for
i in range(currentHealth): <span class=SourceCodeComment># draw red health bars</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>318. </span>        pygame.draw.rect(DISPLAYSURF,
RED,   (15, 5 + (10 * MAXHEALTH) - i * 10, 20, 10))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>319. </span>    for
i in range(MAXHEALTH): <span class=SourceCodeComment># draw the white outlines</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>320. </span>        pygame.draw.rect(DISPLAYSURF,
WHITE, (15, 5 + (10 * MAXHEALTH) - i * 10, 20, 10), 1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>321. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>322. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>323. </span>def
terminate():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>324. </span>    pygame.quit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>325. </span>    sys.exit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>326.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>327.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>328. </span>def
getBounceAmount(currentBounce, bounceRate, bounceHeight):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>329. </span>    <span
class=SourceCodeComment># Returns the number of pixels to offset based on the
bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>330. </span>    <span
class=SourceCodeComment># Larger bounceRate means a slower bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>331. </span>    <span
class=SourceCodeComment># Larger bounceHeight means a higher bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>332.</span>     <span
class=SourceCodeComment># currentBounce will always be less than bounceRate</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>333. </span>    return
int(math.sin( (math.pi / float(bounceRate)) * currentBounce ) * bounceHeight)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>334.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>335. </span>def
getRandomVelocity():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>336. </span>    speed
= random.randint(SQUIRRELMINSPEED, SQUIRRELMAXSPEED)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>337. </span>    if
random.randint(0, 1) == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>338. </span>        return
speed</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>339. </span>    else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>340. </span>        return
-speed</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>341. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>342. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>343. </span>def
getRandomOffCameraPos(camerax, cameray, objWidth, objHeight):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>344. </span>    <span
class=SourceCodeComment># create a Rect of the camera view</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>345. </span>    cameraRect
= pygame.Rect(camerax, cameray, WINWIDTH, WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>346. </span>    while
True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>347. </span>        x
= random.randint(camerax - WINWIDTH, camerax + (2 * WINWIDTH))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>348. </span>        y
= random.randint(cameray - WINHEIGHT, cameray + (2 * WINHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>349.        
</span><span class=SourceCodeComment># create a Rect object with the random
coordinates and use colliderect()</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>350.</span><span
class=SourceCodeComment>         # to make sure the right edge isn't in the
camera view.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>351. </span>        objRect
= pygame.Rect(x, y, objWidth, objHeight)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>352. </span>        if
not objRect.colliderect(cameraRect):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>353. </span>            return
x, y</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>354. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>355. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>356. </span>def
makeNewSquirrel(camerax, cameray):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>357. </span>    sq
= {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>358. </span>    generalSize
= random.randint(5, 25)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>359. </span>    multiplier
= random.randint(1, 3)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>360. </span>    sq['width'] 
= (generalSize + random.randint(0, 10)) * multiplier</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>361. </span>    sq['height']
= (generalSize + random.randint(0, 10)) * multiplier</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>362. </span>    sq['x'],
sq['y'] = getRandomOffCameraPos(camerax, cameray, sq['width'], sq['height'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>363. </span>    sq['movex']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>364. </span>    sq['movey']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>365. </span>    if
sq['movex'] &lt; 0: <span class=SourceCodeComment># squirrel is facing left</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>366. </span>        sq['surface']
= pygame.transform.scale(L_SQUIR_IMG, (sq['width'], sq['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>367. </span>    else:
<span class=SourceCodeComment># squirrel is facing right</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>368. </span>        sq['surface']
= pygame.transform.scale(R_SQUIR_IMG, (sq['width'], sq['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>369. </span>    sq['bounce']
= 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>370. </span>    sq['bouncerate']
= random.randint(10, 18)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>371. </span>    sq['bounceheight']
= random.randint(10, 50)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>372. </span>    return
sq</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>373. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>374. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>375. </span>def
makeNewGrass(camerax, cameray):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>376. </span>    gr
= {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>377. </span>    gr['grassImage']
= random.randint(0, len(GRASSIMAGES) - 1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>378. </span>    gr['width'] 
= GRASSIMAGES[0].get_width()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>379. </span>    gr['height']
= GRASSIMAGES[0].get_height()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>380.</span>   
 gr['x'], gr['y'] = getRandomOffCameraPos(camerax, cameray, gr['width'],
gr['height'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>381.</span>    
gr['rect'] = pygame.Rect( (gr['x'], gr['y'], gr['width'], gr['height']) )</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>382. </span>    return
gr</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>383.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>384.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>385. </span>def
isOutsideActiveArea(camerax, cameray, obj):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>386. </span>    <span
class=SourceCodeComment># Return False if camerax and cameray are more than</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>387. </span>    <span
class=SourceCodeComment># a half-window length beyond the edge of the window.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>388. </span>    boundsLeftEdge
= camerax - WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>389. </span>    boundsTopEdge
= cameray - WINHEIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>390. </span>    boundsRect
= pygame.Rect(boundsLeftEdge, boundsTopEdge, WINWIDTH * 3, WINHEIGHT * 3)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>391. </span>    objRect
= pygame.Rect(obj['x'], obj['y'], obj['width'], obj['height'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>392. </span>    return
not boundsRect.colliderect(objRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>393. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>394. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>395. </span>if
__name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>396. </span>    main()</p>

</div>

<h2><a name="_Toc316488702">The Usual Setup Code</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst>  <span class=SourceLineNumber>1. </span><span
class=SourceCodeComment># Squirrel Eat Squirrel (a 2D Katamari Damacy clone)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>2. </span><span
class=SourceCodeComment># By Al Sweigart al@inventwithpython.com</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>3. </span><span
class=SourceCodeComment># http://inventwithpython.com/pygame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>4. </span><span
class=SourceCodeComment># Creative Commons BY-NC-SA 3.0 US</span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>6. </span>import
random, sys, time, math, pygame</p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>7. </span>from
pygame.locals import *</p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>8. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle>  <span class=SourceLineNumber>9. </span>FPS
= 30 <span class=SourceCodeComment># frames per second to update the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>10. </span>WINWIDTH
= 640 <span class=SourceCodeComment># width of the program's window, in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>11. </span>WINHEIGHT
= 480 <span class=SourceCodeComment># height in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>12. </span>HALF_WINWIDTH
= int(WINWIDTH / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>13. </span>HALF_WINHEIGHT
= int(WINHEIGHT / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>14. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>15. </span>GRASSCOLOR
= (24, 255, 0)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>16. </span>WHITE
= (255, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>17. </span>RED
= (255, 0, 0)</p>

</div>

<p class=MsoNormal>The start of the program assigns several constant variables.
This program frequently makes use of the half length of the width and height of
the window so much that the <span class=Literal>HALF_WINWIDTH</span> and <span
class=Literal>HALF_WINHEIGHT</span> variables store these numbers.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 19. </span>CAMERASLACK
= 90     <span class=SourceCodeComment># how far from the center the squirrel
moves before moving the camera</span></p>

</div>

<p class=MsoNormal>The “camera slack” is described later. Basically, it means
that the camera will begin following the player squirrel when it moves 90
pixels away from the center of the window.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>20. </span>MOVERATE
= 9         <span class=SourceCodeComment># how fast the player moves</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>21. </span>BOUNCERATE
= 6       <span class=SourceCodeComment># how fast the player bounces (large is
slower)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>22. </span>BOUNCEHEIGHT
= 30    <span class=SourceCodeComment># how high the player bounces</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>23. </span>STARTSIZE
= 25       <span class=SourceCodeComment># how big the player starts off</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>24. </span>WINSIZE
= 300        <span class=SourceCodeComment># how big the player needs to be to
win</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>25. </span>INVULNTIME
= 2       <span class=SourceCodeComment># how long the player is invulnerable
after being hit in seconds</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>26. </span>GAMEOVERTIME
= 4     <span class=SourceCodeComment># how long the &quot;game over&quot; text
stays on the screen in seconds</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>27. </span>MAXHEALTH
= 3        <span class=SourceCodeComment># how much health the player starts
with</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>29. </span>NUMGRASS
= 80        <span class=SourceCodeComment># number of grass objects in the active
area</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>30. </span>NUMSQUIRRELS
= 30    <span class=SourceCodeComment># number of squirrels in the active area</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>31. </span>SQUIRRELMINSPEED
= 3 <span class=SourceCodeComment># slowest squirrel speed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>32. </span>SQUIRRELMAXSPEED
= 7 <span class=SourceCodeComment># fastest squirrel speed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>33. </span>DIRCHANGEFREQ
= 2    <span class=SourceCodeComment># % chance of direction change per frame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>34. </span>LEFT
= 'left'</p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>35. </span>RIGHT
= 'right'</p>

</div>

<p class=MsoNormal>The comments next to these constants explains what the
constant variable is used for. </p>

<h2><a name="_Toc316488703">Describing the Data Structures</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>37. </span><span
class=SourceCodeComment>&quot;&quot;&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>38. </span><span
class=SourceCodeComment>This program has three data structures to represent the
player, enemy squirrels, and grass background objects. The data structures are
dictionaries with the following keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>39. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>40. </span><span
class=SourceCodeComment>Keys used by all three data structures:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>41. </span>    <span
class=SourceCodeComment>'x' - the left edge coordinate of the object in the
game world (not a pixel coordinate on the screen)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>42. </span>    <span
class=SourceCodeComment>'y' - the top edge coordinate of the object in the game
world (not a pixel coordinate on the screen)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>43. </span>    <span
class=SourceCodeComment>'rect' - the pygame.Rect object representing where on
the screen the object is located.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>44. </span><span
class=SourceCodeComment>Player data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>45. </span>    <span
class=SourceCodeComment>'surface' - the pygame.Surface object that stores the
image of the squirrel which will be drawn to the screen.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>46. </span>    <span
class=SourceCodeComment>'facing' - either set to LEFT or RIGHT, stores which
direction the player is facing.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>47. </span>    <span
class=SourceCodeComment>'size' - the width and height of the player in pixels.
(The width &amp; height are always the same.)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>48. </span>    <span
class=SourceCodeComment>'bounce' - represents at what point in a bounce the
player is in. 0 means standing (no bounce), up to BOUNCERATE (the completion of
the bounce)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>49. </span>    <span
class=SourceCodeComment>'health' - an integer showing how many more times the
player can be hit by a larger squirrel before dying.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>50. </span><span
class=SourceCodeComment>Enemy Squirrel data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>51. </span>    <span
class=SourceCodeComment>'surface' - the pygame.Surface object that stores the
image of the squirrel which will be drawn to the screen.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>52. </span>    <span
class=SourceCodeComment>'movex' - how many pixels per frame the squirrel moves
horizontally. A negative integer is moving to the left, a positive to the
right.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>53. </span>    <span
class=SourceCodeComment>'movey' - how many pixels per frame the squirrel moves
vertically. A negative integer is moving up, a positive moving down.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>54. </span>    <span
class=SourceCodeComment>'width' - the width of the squirrel's image, in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>55. </span>    <span
class=SourceCodeComment>'height' - the height of the squirrel's image, in
pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>56. </span>    <span
class=SourceCodeComment>'bounce' - represents at what point in a bounce the
player is in. 0 means standing (no bounce), up to BOUNCERATE (the completion of
the bounce)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>57. </span>    <span
class=SourceCodeComment>'bouncerate' - how quickly the squirrel bounces. A
lower number means a quicker bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>58. </span>    <span
class=SourceCodeComment>'bounceheight' - how high (in pixels) the squirrel
bounces</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>59. </span><span
class=SourceCodeComment>Grass data structure keys:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>60. </span>    <span
class=SourceCodeComment>'grassImage' - an integer that refers to the index of
the pygame.Surface object in GRASSIMAGES used for this grass object</span></p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>61. </span><span
class=SourceCodeComment>&quot;&quot;&quot;</span></p>

</div>

<p class=MsoNormal>The comments from lines 37 to 61 are in one large,
multi-line string. They describe the keys in the player squirrel, enemy
squirrel, and grass objects. In Python, a multi-line string value by itself
works as a multi-line comment.</p>

<h2><a name="_Toc316488704">The </a><span class=Literal>main()</span> Function</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>63. </span>def
main():</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>64. </span>    global
FPSCLOCK, DISPLAYSURF, BASICFONT, L_SQUIR_IMG, R_SQUIR_IMG, GRASSIMAGES</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>65. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>66. </span>    pygame.init()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>67. </span>    FPSCLOCK
= pygame.time.Clock()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>68. </span>    pygame.display.set_icon(pygame.image.load('gameicon.png'))</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>69. </span>    DISPLAYSURF
= pygame.display.set_mode((WINWIDTH, WINHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>70. </span>    pygame.display.set_caption('Squirrel
Eat Squirrel')</p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>71. </span>    BASICFONT
= pygame.font.Font('freesansbold.ttf', 32)</p>

</div>

<p class=MsoNormal>The first several lines of the <span class=Literal>main()</span>
function are the same setup code that we’ve seen in our previous game programs.
The <span class=Literal>pygame.display.set_icon()</span> is a Pygame function
that sets the icon in the window’s title bar (just like <span class=Literal>pygame.display.set_caption()</span>
sets the caption text in the title bar). The single argument to <span
class=Literal>pygame.display.set_icon()</span> is a Surface object of a small
image. The ideal image size is 32 x 32 pixels, although you can use other sized
images. The image will just be compressed into a smaller size to be used as the
window’s icon.</p>

<h2><a name="_Toc316488705">The </a><span class=Literal>pygame.transform.flip()</span>
Function</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>73. </span>    <span
class=SourceCodeComment># load the image files</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>74. </span>    L_SQUIR_IMG
= pygame.image.load('squirrel.png')</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>75. </span>    R_SQUIR_IMG
= pygame.transform.flip(L_SQUIR_IMG, True, False)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>76. </span>    GRASSIMAGES
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>77. </span>    for
i in range(1, 5):</p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>78. </span>        GRASSIMAGES.append(pygame.image.load('grass%s.png'
% i))</p>

</div>

<p class=MsoNormal>The image for the player and enemy squirrels is loaded from <em>squirrel.png</em>
on line 74. Make sure that this PNG file is in the same folder as <em>squirrel.py</em>,
otherwise you will get the error <span class=Literal>pygame.error: Couldn't open
squirrel.png</span>.</p>

<p class=MsoNormal>The image in <em>squirrel.png</em> (which you can download
from <span class=URL><a href="//invpy.com/squirrel.png">http://invpy.com/squirrel.png</a></span>) is of a
squirrel facing to the left. We also need a Surface object that contains a
picture of the squirrel facing to the right. Instead of creating a second PNG
image file, we can call the <span class=Literal>pygame.transform.flip()</span>
function. This function has three parameters: the Surface object with the image
to flip, a Boolean value to do a horizontal flip, and a Boolean value to do a
vertical flip. By passing <span class=Literal>True</span> for the second
parameter and <span class=Literal>False</span> for the third parameter, the
Surface object that returns has the image of the squirrel facing to the right.
The original Surface object in <span class=Literal>L_SQUIR_IMG</span> that we
passed in is unchanged.</p>

<p class=MsoNormal>Here are examples of images being horizontally and
vertically flipped:</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=71
  height=71 id="Picture 38" src="chapter8_files/image003.jpg"></p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=71
  height=71 id="Picture 40" src="chapter8_files/image004.jpg"></p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=71
  height=71 id="Picture 41" src="chapter8_files/image005.jpg"></p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=71
  height=71 id="Picture 35" src="chapter8_files/image006.jpg"></p>
  </td>
 </tr>
 <tr>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>Original</p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>Horizontal Flip</p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>Vertical Flip</p>
  </td>
  <td width=148 valign=top style='width:110.7pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>Horizontal and
  Vertical Flip</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>80. </span>    while
True:</p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>81. </span>        runGame()</p>

</div>

<p class=MsoNormal>After the setup in <span class=Literal>main()</span> is
complete, the game begins with <span class=Literal>runGame()</span> being
called. </p>

<h2><a name="_Toc316488706">A More Detailed Game State than Usual</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>84. </span>def
runGame():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>    
<span class=SourceCodeComment># set up variables for the start of a new game</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>86. </span>    invulnerableMode
= False  <span class=SourceCodeComment># if the player is invulnerable</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>87. </span>    invulnerableStartTime
= 0 <span class=SourceCodeComment># time the player became invulnerable</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>88. </span>    gameOverMode
= False      <span class=SourceCodeComment># if the player has lost</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>89. </span>    gameOverStartTime
= 0     <span class=SourceCodeComment># time the player lost</span></p>

<p class=SourceCodeFeaturedCxSpLast> <span class=SourceLineNumber>90. </span>    winMode
= False           <span class=SourceCodeComment># if the player has won</span></p>

</div>

<p class=MsoNormal>The Squirrel Eat Squirrel game has quite a few variables
that track the game state. These variables will be explained in more detail
later when they are used in the code.</p>

<h2><a name="_Toc316488707">The Usual Text Creation Code</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst> <span class=SourceLineNumber>92. </span>    <span
class=SourceCodeComment># create the surfaces to hold game text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>93. </span>    gameOverSurf
= BASICFONT.render('Game Over', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>94. </span>    gameOverRect
= gameOverSurf.get_rect()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>95. </span>    gameOverRect.center
= (HALF_WINWIDTH, HALF_WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>96. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>97. </span>    winSurf
= BASICFONT.render('You have achieved OMEGA SQUIRREL!', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>98. </span>    winRect
= winSurf.get_rect()</p>

<p class=SourceCodeFeaturedCxSpMiddle> <span class=SourceLineNumber>99. </span>    winRect.center
= (HALF_WINWIDTH, HALF_WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101. </span>    winSurf2
= BASICFONT.render('(Press &quot;r&quot; to restart.)', True, WHITE)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102. </span>    winRect2
= winSurf2.get_rect()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>103. </span>    winRect2.center
= (HALF_WINWIDTH, HALF_WINHEIGHT + 30)</p>

</div>

<p class=MsoNormal>These variables contain Surface objects with the “Game
Over”, “You have achieved OMEGA SQUIRREL!”, and “(Press &quot;r&quot; to
restart.)” text that appears on the screen after the game ends (with either the
player losing or winning).</p>

<h2><a name="_Toc316488708">Cameras</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>105. </span>    <span
class=SourceCodeComment># camerax and cameray are where the middle of the
camera view is</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106. </span>    camerax
= 0</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>107. </span>    cameray
= 0</p>

</div>

<p class=MsoNormal>The <span class=Literal>camerax</span> and <span
class=Literal>cameray</span> variables track the game coordinates of the
“camera”. Imagine the game world as an infinite 2D space. This could, of
course, never fit on any screen. We can only draw a portion of the infinite 2D
space on the screen. We call the area of this portion a <span class=Definition>camera</span>,
because it is as though our screen is just the area of the game world in front what
a camera would see. Here’s a picture of the game world (an infinite green
field) and the area that the camera can view:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=384
height=346 id="Picture 64" src="chapter8_files/image007.png"></p>

<p class=MsoNormal>As you can see, the game world XY coordinates keep getting
bigger and smaller forever. The game world origin is where the (0, 0) game
world coordinates are. You can see that the three squirrels are located (in
game world coordinates) at (-384, -84), (384, 306), and (585, -234).</p>

<p class=MsoNormal>But we can only display 640 x 480 pixel area on the screen
(though this can change if we pass different numbers to the <span
class=Literal>pygame.display.set_mode()</span> function), so we need to track
where the camera’s origin is located in game world coordinates. In the picture above,
the camera is placed at (-486, -330) in game world coordinates.</p>

<p class=MsoNormal>The picture below shows the same field and squirrels, except
everything is given in camera coordinates:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=269
height=196 id="Picture 65" src="chapter8_files/image008.png"></p>

<p class=MsoNormal>The area that the camera can see (called the camera view)
has it’s center (that is, its origin) at the game world coordinates (-486, -330).
Since what the camera sees is displayed on the player’s screen, the “camera”
coordinates are the same as the “pixel” coordinates. To find out the pixel
coordinates of the squirrels (that is, where on the screen they appear), take
the game coordinates of the squirrel and subtract the game coordinates of the
camera’s origin.</p>

<p class=MsoNormal>So the squirrel on the left has game world coordinates of (-384,
-84) but appears at (102, 246) on the screen in pixel coordinates. (For the X
coordinate, -384 - -486 = 102 and for the Y coordinate, -84 - -330 = 246.)</p>

<p class=MsoNormal>When we do the same calculation to find the pixel
coordinates of the other two squirrels, we find that they exist outside of the
range of the screen. This is why they don’t appear in the camera’s view.</p>

<h2><a name="_Toc316488709">The “Active Area”</a></h2>

<p class=MsoNormal>The “active area” is just a name I came up with to describe
the area of the game world that the camera views plus an area around it the
size of the camera area:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=269
height=196 id="Picture 48" src="chapter8_files/image009.png"></p>

<p class=MsoNormal>Calculating if something is in the active area or not is
explained in the <span class=Literal>isOutsideActiveArea()</span> function’s
explanation later in this chapter. When we create new enemy squirrel or grass
objects, we don’t want them to be created inside the view of the camera, since
it’ll appear that they just pop out of nowhere.</p>

<p class=MsoNormal>But we also don’t want to create them too far away from the
camera, because then they may never wander into the camera’s view. Inside the
active area but outside the camera is where squirrel and grass objects can safely
be created.</p>

<p class=MsoNormal>Also, when squirrel and grass objects are beyond the border
of the active area then they are far away enough to delete so that they don’t
take up memory any more. Objects that far away aren’t needed since it is much
less likely that they’ll come back into view of the camera.</p>

<p class=MsoNormal>If you have ever played Super Mario World on the Super
Nintendo, there is a good YouTube video explaining how Super Mario World’s
camera system works. You can find this video at <span class=URL><a href="//invpy.com/mariocamera">http://invpy.com/mariocamera</a></span>.</p>

<h2><a name="_Toc316488710">Keeping Track of the Location of Things in the Game
World</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>109. </span>    grassObjs
= []    <span class=SourceCodeComment># stores all the grass objects in the
game</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110. </span>    squirrelObjs
= [] <span class=SourceCodeComment># stores all the non-player squirrel objects</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111. </span>    <span
class=SourceCodeComment># stores the player object:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112. </span>    playerObj
= {'surface': pygame.transform.scale(L_SQUIR_IMG, (STARTSIZE, STARTSIZE)),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113. </span>                 'facing':
LEFT,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114. </span>                 'size':
STARTSIZE,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115. </span>                 'x':
HALF_WINWIDTH,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span>                 'y':
HALF_WINHEIGHT,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117. </span>                 'bounce':0,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118. </span>                 'health':
MAXHEALTH}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120. </span>    moveLeft 
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121. </span>    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>122. </span>    moveUp   
= False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>123. </span>    moveDown 
= False</p>

</div>

<p class=MsoNormal>The <span class=Literal>grassObjs</span> variable holds a
list of all the grass objects in the game. As new grass objects are created,
they are added to this list. As grass objects are deleted, they are removed
from this list. The same goes for the <span class=Literal>squirrelObjs</span>
variable and the enemy squirrel objects.</p>

<p class=MsoNormal>The <span class=Literal>playerObj</span> variable is not a
list, but just the dictionary value itself.</p>

<p class=MsoNormal>The move variables on lines 120 to 123 track which of arrow
keys (or WASD keys) are being held down, just like in a few of the previous
game programs.</p>

<h2><a name="_Toc316488711">Starting Off with Some Grass</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>125. </span>    <span
class=SourceCodeComment># start off with some random grass images on the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126. </span>    for
i in range(10):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127. </span>        grassObjs.append(makeNewGrass(camerax,
cameray))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128. </span>        grassObjs[i]['x']
= random.randint(0, WINWIDTH)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>129. </span>        grassObjs[i]['y']
= random.randint(0, WINHEIGHT)</p>

</div>

<p class=MsoNormal>The active area should start off with a few grass objects
visible on the screen. The <span class=Literal>makeNewGrass()</span> function
will create and return a grass object that is randomly located somewhere in the
active area but outside the camera view. This is what we normally want when we
call <span class=Literal>makeNewGrass()</span>, but since we want to make sure
the first few grass objects are on the screen, the X and Y coordinates are
overwritten.</p>

<h2><a name="_Toc316488712">The Game Loop</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeatured><span class=SourceLineNumber>131. </span>    while
True: <span class=SourceCodeComment># main game loop</span></p>

</div>

<p class=MsoNormal>The game loop, like the game loops in the previous game
programs, will do event handling, updating the game state, and drawing
everything to the screen.</p>

<h2><a name="_Toc316488713">Checking to Disable Invulnerability</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>132. </span>        <span
class=SourceCodeComment># Check if we should turn off invulnerability</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133. </span>        if
invulnerableMode and time.time() - invulnerableStartTime &gt; INVULNTIME:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>134. </span>            invulnerableMode
= False</p>

</div>

<p class=MsoNormal>When the player gets hit by an enemy squirrel and does not
die, we make the player invulnerable for a couple seconds (since the <span
class=Literal>INVULNTIME</span> constant is set to <span class=Literal>2</span>).
During this time, the player’s squirrel flashes and the won’t take any damage
from other squirrels. If the “invulnerability mode” time is over, line 134 will
set <span class=Literal>invulnerableMode</span> to <span class=Literal>False</span>.</p>

<h2><a name="_Toc316488714">Moving the Enemy Squirrels</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>136. </span>        <span
class=SourceCodeComment># move all the squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>137. </span>        for
sObj in squirrelObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138. </span>            <span
class=SourceCodeComment># move the squirrel, and adjust for their bounce</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139. </span>            sObj['x']
+= sObj['movex']</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>140. </span>            sObj['y']
+= sObj['movey']</p>

</div>

<p class=MsoNormal>The enemy squirrels all move according to the values in
their <span class=Literal>'movex'</span> and <span class=Literal>'movey'</span>
keys. If these values are positive, the squirrels move right or down. If these
values are negative, they move left or up. The larger the value, the farther
they move on each iteration through the game loop (which means they move
faster).</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 137 will
apply this moving code to each of the enemy squirrel objects in the <span
class=Literal>squirrelObjs</span> list. First, line 139 and 140 will adjust
their <span class=Literal>'x'</span> and <span class=Literal>'y'</span> keys’
values.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>141. </span>            sObj['bounce']
+= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142. </span>            if
sObj['bounce'] &gt; sObj['bouncerate']:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>143. </span>                sObj['bounce']
= 0 <span class=SourceCodeComment># reset bounce amount</span></p>

</div>

<p class=MsoNormal>The value in <span class=Literal>sObj['bounce']</span> is
incremented on each iteration of the game loop for each squirrel. When this
value is <span class=Literal>0</span>, the squirrel is at the very beginning of
its bounce. When this value is equal to the value in <span class=Literal>sObj['bouncerate']</span>
the value is at its end. (This is why a smaller <span class=Literal>sObj['bouncerate']</span>
value makes for a faster bounce. If <span class=Literal>sObj['bouncerate']</span>
is <span class=Literal>3</span>, then it only takes three iterations through
the game loop for the squirrel to do a full bounce. If <span class=Literal>sObj['bouncerate']</span>
were <span class=Literal>10</span>, then it would take ten iterations.)</p>

<p class=MsoNormal>When <span class=Literal>sObj['bounce']</span> gets larger
than <span class=Literal>sObj['bouncerate']</span>, then it needs to be reset
to <span class=Literal>0</span>. This is what lines 142 and 143 do.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>145. </span>            <span
class=SourceCodeComment># random chance they change direction</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146. </span>            if
random.randint(0, 99) &lt; DIRCHANGEFREQ:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147. </span>                sObj['movex']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148. </span>                sObj['movey']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149. </span>                if
sObj['movex'] &gt; 0: <span class=SourceCodeComment># faces right</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150. </span>                    sObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (sObj['width'], sObj['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151. </span>                else:
<span class=SourceCodeComment># faces left</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>152. </span>                    sObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (sObj['width'], sObj['height']))</p>

</div>

<p class=MsoNormal>There is a 2% chance on each iteration through the game loop
that the squirrel will randomly change speed and direction. On line 146 the <span
class=Literal>random.randint(0, 99)</span> call randomly selects an integer out
of 100 possible integers. If this number is less than <span class=Literal>DIRCHANGEFREQ</span>
(which we set to <span class=Literal>2</span> on line 33) then a new value will
be set for <span class=Literal>sObj['movex']</span> and <span class=Literal>sObj['movey']</span>.
</p>

<p class=MsoNormal>Because this means the squirrel might have changed
direction, the Surface object in <span class=Literal>sObj['surface']</span>
should be replaced by a new one that is properly facing left or right and
scaled to the squirrel’s size. This is what lines 149 to 152 determine. Note
that line 150 gets a Surface object scaled from <span class=Literal>R_SQUIR_IMG</span>
and line 152 gets one scaled from <span class=Literal>L_SQUIR_IMG</span>.</p>

<h2><a name="_Toc316488715">Removing the Far Away Grass and Squirrel Objects</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>155. </span>        <span
class=SourceCodeComment># go through all the objects and see if any need to be
deleted.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156. </span>        for
i in range(len(grassObjs) - 1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157. </span>            if
isOutsideActiveArea(camerax, cameray, grassObjs[i]):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158. </span>                del
grassObjs[i]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159. </span>        for
i in range(len(squirrelObjs) - 1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160. </span>            if
isOutsideActiveArea(camerax, cameray, squirrelObjs[i]):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>161. </span>                del
squirrelObjs[i]</p>

</div>

<p class=MsoNormal>During each iteration of the game loop, the code will check
all of the grass and enemy squirrel objects to see if they are outside the
“active area”. The <span class=Literal>isOutsideActiveArea()</span> function
takes the current coordinates of the camera (which are stored in <span
class=Literal>camerax</span> and <span class=Literal>cameray</span>) and the
grass/enemy squirrel object, and returns <span class=Literal>True</span> if the
object is not located in the active area.</p>

<p class=MsoNormal>If this is the case, this object is deleted on line 158 (for
grass objects) or line 161 (for squirrel objects). This is how squirrel and
grass objects get deleted when the player moves far enough away from them (or
when the enemy squirrels move away far enough from the player). This ensures
that there is always a number of squirrels and grass objects near the player.</p>

<h2><a name="_Toc316488716">When Deleting Items in a List, Iterate Over the
List in Reverse</a></h2>

<p class=MsoNormal>Deleting squirrel and grass objects is done with the <span
class=Literal>del</span> operator. However, notice that the <span
class=Literal>for</span> loop on line 156 and 159 pass arguments to the <span
class=Literal>range()</span> function so that the numbering starts at the index
of the last item and then decrements by <span class=Literal>-1</span> (unlike
incrementing by <span class=Literal>1</span> as it normally does) until it
reaches the number <span class=Literal>-1</span>. We are iterating backwards
over the list’s indexes compared to how it is normally done. This is done
because we are iterating over the list that we are also deleting items from.</p>

<p class=MsoNormal>To see why this reverse order is needed, say we had the
following list value:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>animals = ['cat', 'mouse',
'dog', 'horse']</p>

</div>

<p class=MsoNormal>So we wanted to write code to delete any instances of the
string <span class=Literal>'dog'</span> from this list. We might think to write
out code like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>for i in
range(len(animals)):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    if
animals[i] == 'dog':</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>        del
animals[i]</p>

</div>

<p class=MsoNormal>But if we ran this code, we would get an <span
class=Literal>IndexError</span> error that looks like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>Traceback (most
recent call last):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;stdin&gt;&quot;, line 2, in &lt;module&gt;</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>IndexError: list
index out of range</p>

</div>

<p class=MsoNormal>To see why this error happens, let’s walk through the code.
First, the <span class=Literal>animals</span> list would be set to <span
class=Literal>['cat', 'mouse', 'dog', 'horse']</span> and <span class=Literal>len(animals)</span>
would return <span class=Literal>4</span>. This means that the call to <span
class=Literal>range(4)</span> would cause the <span class=Literal>for</span>
loop to iterate with the values <span class=Literal>0</span>, <span
class=Literal>1</span>, <span class=Literal>2</span>, and <span class=Literal>3</span>.</p>

<p class=MsoNormal>When the <span class=Literal>for</span> loop iterates with <span
class=Literal>i</span> set to <span class=Literal>2</span>, the <span
class=Literal>if</span> statement’s condition will be <span class=Literal>True</span>
and the <span class=Literal>del animals[i]</span> statement will delete <span
class=Literal>animals[2]</span>. This means that afterwards the animals list
will be <span class=Literal>['cat', 'mouse', 'horse']</span>. The indexes of
all the items after <span class=Literal>'dog'</span> are all shifted down by
one because the <span class=Literal>'dog'</span> value was removed.</p>

<p class=MsoNormal>But on the next iteration through the <span class=Literal>for</span>
loop, <span class=Literal>i</span> is set to <span class=Literal>3</span>. But <span
class=Literal>animals[3]</span> is out of bounds because the valid indexes of
the animals list is no longer <span class=Literal>0</span> to <span
class=Literal>3</span> but <span class=Literal>0</span> to <span class=Literal>2</span>.
The original call to <span class=Literal>range()</span> was for a list with 4
items in it. The list changed in length, but the <span class=Literal>for</span>
loop is set up for the original length.</p>

<p class=MsoNormal>However, if we iterate from the last index of the list to <span
class=Literal>0</span>, we don’t run into this problem. The following program
deletes the <span class=Literal>'dog'</span> string from the <span
class=Literal>animals</span> list without causing an <span class=Literal>IndexError</span>
error:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>animals = ['cat',
'mouse', 'dog', 'horse']</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>for i in
range(len(animals) - 1, -1, -1):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    if
animals[i] == 'dog':</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>        del
animals[i]</p>

</div>

<p class=MsoNormal>The reason this code doesn’t cause an error is because the <span
class=Literal>for</span> loop iterates over <span class=Literal>3</span>, <span
class=Literal>2</span>, <span class=Literal>1</span>, and <span class=Literal>0</span>.
On the first iteration, the code checks if <span class=Literal>animals[3]</span>
is equal to <span class=Literal>'dog'</span>. It isn’t (<span class=Literal>animals[3]</span>
is <span class=Literal>'horse'</span>) so the code moves on to the next
iteration. Then <span class=Literal>animals[2]</span> is checked if it equals <span
class=Literal>'dog'</span>. It does, so <span class=Literal>animals[2]</span>
is deleted.</p>

<p class=MsoNormal>After <span class=Literal>animals[2]</span> is deleted, the <span
class=Literal>animals</span> list is set to <span class=Literal>['cat',
'mouse', 'horse']</span>. On the next iteration, <span class=Literal>i</span>
is set to <span class=Literal>1</span>. There is a value at <span
class=Literal>animals[1]</span> (the <span class=Literal>'mouse'</span> value),
so no error is caused. It doesn’t matter that all the items in the list after <span
class=Literal>'dog'</span> have shifted down by one, because since we started
at the end of the list and are going towards the front, all of those items have
already been checked.</p>

<p class=MsoNormal>Similarly, we can delete grass and squirrel objects from the
<span class=Literal>grassObjs</span> and <span class=Literal>squirrelObjs</span>
lists without error because the <span class=Literal>for</span> loop on lines
156 and 159 iterate in reverse order.</p>

<h2><a name="_Toc316488717">Adding New Grass and Squirrel Objects</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>163. </span>        <span
class=SourceCodeComment># add more grass &amp; squirrels if we don't have
enough.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>164. </span>        while
len(grassObjs) &lt; NUMGRASS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165. </span>            grassObjs.append(makeNewGrass(camerax,
cameray))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166. </span>        while
len(squirrelObjs) &lt; NUMSQUIRRELS:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>167. </span>            squirrelObjs.append(makeNewSquirrel(camerax,
cameray))</p>

</div>

<p class=MsoNormal>Remember that the <span class=Literal>NUMGRASS</span>
constant was set to <span class=Literal>80</span> and the <span class=Literal>NUMSQUIRRELS</span>
constant was set to <span class=Literal>30</span> at the beginning of the
program? These variables are set so that we can be sure there are always plenty
of grass and squirrel objects in the active area at all times. If the length of
the <span class=Literal>grassObjs</span> or <span class=Literal>squirrelObjs</span>
drops below <span class=Literal>NUMGRASS</span> or <span class=Literal>NUMSQUIRRELS</span>
respectively, then new grass and squirrel objects are created. The <span
class=Literal>makeNewGrass()</span> and <span class=Literal>makeNewSquirrel()</span>
functions that create these objects are explained later in this chapter.</p>

<h2><a name="_Toc316488718">Camera Slack, and Moving the Camera View</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>169. </span>        <span
class=SourceCodeComment># adjust camerax and cameray if beyond the &quot;camera
slack&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>170. </span>        playerCenterx
= playerObj['x'] + int(playerObj['size'] / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>171. </span>        playerCentery
= playerObj['y'] + int(playerObj['size'] / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>172.</span>         if
(camerax + HALF_WINWIDTH) - playerCenterx &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>173.</span>             camerax
= playerCenterx + CAMERASLACK - HALF_WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>174.</span>         elif
playerCenterx – (camerax + HALF_WINWIDTH) &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>175.</span>             camerax
= playerCenterx – CAMERASLACK - HALF_WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>176.</span>         if
(cameray + HALF_WINHEIGHT) - playerCentery &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>177.</span>             cameray
= playerCentery + CAMERASLACK - HALF_WINHEIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>178.</span>         elif
playerCentery – (cameray + HALF_WINHEIGHT) &gt; CAMERASLACK:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>179.</span>             cameray
= playerCentery – CAMERASLACK - HALF_WINHEIGHT</p>

</div>

<p class=MsoNormal>The camera’s position (which is stored as integers in the <span
class=Literal>camerax</span> and <span class=Literal>cameray</span> variables) needs
to be updated when the player moves over. I’ve called the number of pixels the
player can move before the camera gets updated the “camera slack”. Line 19 set
the <span class=Literal>CAMERASLACK</span> constant to <span class=Literal>90</span>,
which our program will take to mean that the player squirrel can move 90 pixels
from the center before the camera position gets updated to follow the squirrel.</p>

<p class=MsoNormal>In order to understand the equations used in the <span
class=Literal>if</span> statements on lines 172, 174, 176, and 178, you should
note that <span class=Literal>(camerax + HALF_WINWIDTH)</span> and <span
class=Literal>(cameray + HALF_WINHEIGHT)</span> are the XY game world coordinates
currently at the center of the screen. The <span class=Literal>playerCenterx</span>
and <span class=Literal>playerCentery</span> is set to the middle of the player’s
squirrel’s position, also in game world coordinates.</p>

<p class=MsoNormal>For line 172, if the center X coordinate minus the player’s
center X coordinate is greater than the <span class=Literal>CAMERASLACK</span>
value, that means the player is more pixels to the right of the center of the
camera than the camera slack should allow. The <span class=Literal>camerax</span>
value needs to be updated so that the player squirrel is just at the edge of
the camera slack. This is why line 173 sets <span class=Literal>camerax</span>
to <span class=Literal>playerCenterx + CAMERASLACK – HALF_WINWIDTH</span>. Note
that the <span class=Literal>camerax</span> variable is changed, not the <span
class=Literal>playerObj['x']</span> value. We want to move the camera, not the
player.</p>

<p class=MsoNormal>The other three <span class=Literal>if</span> statements
follow similar logic for the left, up and down sides.</p>

<h2><a name="_Toc316488719">Drawing the Background, Grass, Squirrels, and
Health Meter</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>181. </span>        <span
class=SourceCodeComment># draw the green background</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>182. </span>        DISPLAYSURF.fill(GRASSCOLOR)</p>

</div>

<p class=MsoNormal>Line 182 begins the code that starts drawing the contents of
the display Surface object. First, line 182 draws a green color for the
background. This will paint over all of the previous contents of the Surface so
that we can start drawing the frame from scratch.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>184. </span>        <span
class=SourceCodeComment># draw all the grass objects on the screen</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>185. </span>        for
gObj in grassObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>186. </span>            gRect
= pygame.Rect( (gObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187. </span>                                  gObj['y']
- cameray,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>188. </span>                                  gObj['width'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>189. </span>                                  gObj['height'])
)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>190. </span>            DISPLAYSURF.blit(GRASSIMAGES[gObj['grassImage']],
gRect)</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 185 goes
through all the grass objects in the <span class=Literal>grassObjs</span> list
and creates a Rect object from the x, y, width, and height information stored
in it. This Rect object is stored in a variable named <span class=Literal>gRect</span>.
On line 190, <span class=Literal>gRect</span> is used in the <span
class=Literal>blit()</span> method call to draw the grass image on the display
Surface. Note that <span class=Literal>gObj['grassImage']</span> only contains
an integer that is an index to <span class=Literal>GRASSIMAGES</span>. <span
class=Literal>GRASSIMAGES</span> is a list of Surface objects that contain all
the grass images. Surface objects take up much more memory than just a single
integer, and all the grass objects with similar <span class=Literal>gObj['grassImage']</span>
values look identical. So it makes sense to only have each grass image stored
once in <span class=Literal>GRASSIMAGES</span> and simply store integers in the
grass objects themselves.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>193. </span>        <span
class=SourceCodeComment># draw the other squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>194. </span>        for
sObj in squirrelObjs:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>195. </span>            sObj['rect']
= pygame.Rect( (sObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>196. </span>                                         sObj['y']
- cameray - getBounceAmount(sObj['bounce'], sObj['bouncerate'],
sObj['bounceheight']),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>197. </span>                                         sObj['width'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span>                                         sObj['height'])
)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>199. </span>            DISPLAYSURF.blit(sObj['surface'],
sObj['rect'])</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop that draws all the
enemy squirrel game objects is similar to the previous <span class=Literal>for</span>
loop, except that the Rect object it creates is saved in the <span
class=Literal>'rect'</span> key’s value of the squirrel dictionary. The reason
the code does this is because we will use this Rect object later to check if
the enemy squirrels have collided with the player squirrel.</p>

<p class=MsoNormal>Note that the top parameter for the Rect constructor is not
just <span class=Literal>sObj['y'] - cameray</span> but <span class=Literal>sObj['y']
- cameray - getBounceAmount(sObj['bounce'], sObj['bouncerate'],
sObj['bounceheight'])</span>. The <span class=Literal>getBounceAmount()</span>
function will return the number of pixels that the top value should be raised.</p>

<p class=MsoNormal>Also, there is no common list of Surface objects of the squirrel
images, like there was with grass game objects and <span class=Literal>GRASSIMAGES</span>.
Each enemy squirrel game object has its own Surface object stored in the <span
class=Literal>'surface'</span> key. This is because the squirrel images can be scaled
to different sizes.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>202. </span>        <span
class=SourceCodeComment># draw the player squirrel</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>203. </span>        flashIsOn
= round(time.time(), 1) * 10 % 2 == 1</p>

</div>

<p class=MsoNormal>After drawing the grass and enemy squirrels, the code will
draw the player’s squirrel. However, there is one case where we would skip
drawing the player’s squirrel. When the player collides with a larger enemy
squirrel, the player takes damage and flashes for a little bit to indicate that
the player is temporarily invulnerable. This flashing effect is done by drawing
the player squirrel on some iterations through the game loop but not on others.
</p>

<p class=MsoNormal>The player squirrel will be drawn on game loop iterations
for a tenth of a second, and then not drawn on the game loop iterations for a
tenth of second. This repeats over and over again as long as the player is
invulnerable (which, in the code, means that the <span class=Literal>invulnerableMode</span>
variable is set to <span class=Literal>True</span>). Our code will make the
flashing last for two seconds, since <span class=Literal>2</span> was stored in
the <span class=Literal>INVULNTIME</span> constant variable on line 25.</p>

<p class=MsoNormal>To determine if the flash is on or not, line 202 grabs the
current time from <span class=Literal>time.time()</span>. Let’s use the example
where this function call returns <span class=Literal>1323926893.622</span>.
This value is passed to <span class=Literal>round()</span>, which rounds it to
one digit past the decimal point (since <span class=Literal>1</span> is passed
as <span class=Literal>round()</span>’s second parameter). This means <span
class=Literal>round()</span> will return the value <span class=Literal>1323926893.6</span>.</p>

<p class=MsoNormal>This value is then multiplied by <span class=Literal>10</span>,
to become <span class=Literal>13239268936</span>. Once we have it as an
integer, we can do the “mod two” trick first discussed in the Memory Puzzle
chapter to see if it is even or odd. <span class=Literal>13239268936 % 2</span>
evaluates to <span class=Literal>0</span>, which means that <span
class=Literal>flashIsOn</span> will be set to <span class=Literal>False</span>,
since <span class=Literal>0 == 1</span> is <span class=Literal>False</span>.</p>

<p class=MsoNormal>In fact, <span class=Literal>time.time()</span> will keep
returning values that will end up putting <span class=Literal>False</span> into
<span class=Literal>flashIsOn</span> until <span class=Literal>1323926893.700</span>,
which is the next tenth second. This is why the <span class=Literal>flashIsOn</span>
variable will constantly have <span class=Literal>False</span> for one tenth of
a second, and then <span class=Literal>True</span> for the next one tenth of a
second (no matter how many iterations happen in that tenth of a second).</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>204. </span>        if
not gameOverMode and not (invulnerableMode and flashIsOn):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>205. </span>            playerObj['rect']
= pygame.Rect( (playerObj['x'] - camerax,</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>206. </span>                                              playerObj['y']
– cameray - getBounceAmount(playerObj['bounce'], BOUNCERATE, BOUNCEHEIGHT),</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>207. </span>                                              playerObj['size'],</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>208. </span>                                              playerObj['size'])
)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>209. </span>            DISPLAYSURF.blit(playerObj['surface'],
playerObj['rect'])</p>

</div>

<p class=MsoNormal>There are three things that must be <span class=Literal>True</span>
before we draw the player’s squirrel. The game must currently be going on
(which happens while <span class=Literal>gameOverMode</span> is <span
class=Literal>False</span>) and the player is not invulnerable and not flashing
(which happens while <span class=Literal>invulnerableMode</span> and <span
class=Literal>flashIsOn</span> are <span class=Literal>False</span>).</p>

<p class=MsoNormal>The code for drawing the player’s squirrel is almost
identical to the code for drawing the enemy squirrels.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>212. </span>        <span
class=SourceCodeComment># draw the health meter</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>213. </span>        drawHealthMeter(playerObj['health'])</p>

</div>

<p class=MsoNormal>The <span class=Literal>drawHealthMeter()</span> function
draws the indicator at the top left corner of the screen that tells the player
how many times the player squirrel can be hit before dying. This function will
be explained later in this chapter.</p>

<h2><a name="_Toc316488720">The Event Handling Loop</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>215. </span>        for
event in pygame.event.get(): <span class=SourceCodeComment># event handling
loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216. </span>            if
event.type == QUIT:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>217. </span>                terminate()</p>

</div>

<p class=MsoNormal>The first thing that is checked in the event handling loop
is if the <span class=Literal>QUIT</span> event has been generated. If so, then
the program should be terminated.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>219. </span>            elif
event.type == KEYDOWN:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>220. </span>                if
event.key in (K_UP, K_w):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>221. </span>                    moveDown
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>222. </span>                    moveUp
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>223. </span>                elif
event.key in (K_DOWN, K_s):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224. </span>                    moveUp
= False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>225. </span>                    moveDown
= True</p>

</div>

<p class=MsoNormal>If the up or down arrow keys have been pressed (or their
WASD equivalents), then the move variable (<span class=Literal>moveRight</span>,
<span class=Literal>moveDown</span>, etc.) for that direction should be set to <span
class=Literal>True</span> and the move variable for the opposite direction
should be set to <span class=Literal>False</span>.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>226. </span>                elif
event.key in (K_LEFT, K_a):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>227. </span>                    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228. </span>                    moveLeft
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229. </span>                    if
playerObj['facing'] == RIGHT: <span class=SourceCodeComment># change player
image</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230. </span>                        playerObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>231. </span>                    playerObj['facing']
= LEFT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>232. </span>                elif
event.key in (K_RIGHT, K_d):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>233. </span>                    moveLeft
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>234. </span>                    moveRight
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235. </span>                    if
playerObj['facing'] == LEFT: <span class=SourceCodeComment># change player
image</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236. </span>                        playerObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>237. </span>                    playerObj['facing']
= RIGHT</p>

</div>

<p class=MsoNormal>The <span class=Literal>moveLeft</span> and <span
class=Literal>moveRight</span> variables should also be set when the left or
right arrow keys are pressed. Also, the value in <span class=Literal>playerObj['facing']</span>
should be updated to either <span class=Literal>LEFT</span> or <span
class=Literal>RIGHT</span>. If the player squirrel is now facing a new
direction, the <span class=Literal>playerObj['surface']</span> value should be
replaced with a correctly scaled image of the squirrel facing the new
direction.</p>

<p class=MsoNormal>Line 229 is run if the left arrow key was pressed and checks
if the player squirrel was facing right. If that was so, then a new scaled
Surface object of the player squirrel image is stored in <span class=Literal>playerObj['surface']</span>.
The code in line 232’s <span class=Literal>elif</span> statement handles the
opposite case.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>238. </span>                elif
winMode and event.key == K_r:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>239. </span>                    return</p>

</div>

<p class=MsoNormal>If the player has won the game by growing large enough (in
which case, <span class=Literal>winMode</span> will be set to <span
class=Literal>True</span>) and the R key has been pressed, then <span
class=Literal>runGame()</span>should return. This will end the current game,
and a new game will start the next time that <span class=Literal>runGame()</span>
gets called.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>241. </span>            elif
event.type == KEYUP:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242. </span>                <span
class=SourceCodeComment># stop moving the player's squirrel</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243. </span>                if
event.key in (K_LEFT, K_a):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244. </span>                    moveLeft
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>245. </span>                elif
event.key in (K_RIGHT, K_d):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>246. </span>                    moveRight
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>247. </span>                elif
event.key in (K_UP, K_w):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>248. </span>                    moveUp
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249. </span>                elif
event.key in (K_DOWN, K_s):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>250. </span>                    moveDown
= False</p>

</div>

<p class=MsoNormal>If the player lets up on any of the arrow or WASD keys, then
the code should set the move variable for that direction to <span
class=Literal>False</span>. This will stop the squirrel from moving in that
direction any more.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>252. </span>                elif
event.key == K_ESCAPE:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>253. </span>                    terminate()</p>

</div>

<p class=MsoNormal>If the key that was pressed was the Esc key, then terminate
the program.</p>

<h2><a name="_Toc316488721">Moving the Player, and Accounting for Bounce</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>255. </span>        if
not gameOverMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>256. </span>            <span
class=SourceCodeComment># actually move the player</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257. </span>            if
moveLeft:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258. </span>                playerObj['x']
-= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>259. </span>            if
moveRight:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>260. </span>                playerObj['x']
+= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>261. </span>            if
moveUp:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>262. </span>                playerObj['y']
-= MOVERATE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>263. </span>            if
moveDown:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>264. </span>                playerObj['y']
+= MOVERATE</p>

</div>

<p class=MsoNormal>The code inside the <span class=Literal>if</span> statement
on line 255 will move the player’s squirrel around only if the game is not
over. (This is why pressing on the arrow keys after the player’s squirrel dies
will have no effect.) Depending on which of the move variables is set to <span
class=Literal>True</span>, the <span class=Literal>playerObj</span> dictionary
should have its <span class=Literal>playerObj['x']</span> and <span
class=Literal>playerObj['y']</span> values changed by <span class=Literal>MOVERATE</span>.
(This is why a larger value in <span class=Literal>MOVERATE</span> makes the
squirrel move faster.)</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>266. </span>            if
(moveLeft or moveRight or moveUp or moveDown) or playerObj['bounce'] != 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>267. </span>                playerObj['bounce']
+= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>268. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>269. </span>            if
playerObj['bounce'] &gt; BOUNCERATE:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>270. </span>                playerObj['bounce']
= 0 <span class=SourceCodeComment># reset bounce amount</span></p>

</div>

<p class=MsoNormal>The value in <span class=Literal>playerObj['bounce']</span>
keeps track of at what point in bouncing the player is at. This variable stores
an integer value from <span class=Literal>0</span> to <span class=Literal>BOUNCERATE</span>.
Just like the bounce value for the enemy squirrels, a <span class=Literal>playerObj['bounce']</span>
value of <span class=Literal>0</span> means the player squirrel is at the start
of a bounce and a value of <span class=Literal>BOUNCERATE</span> means the
player squirrel is at the end of the bounce.</p>

<p class=MsoNormal>The player squirrel will bounce whenever the player is
moving, or if the player has stopped moving but the squirrel hasn’t finished
its current bounce. This condition is captured in the <span class=Literal>if</span>
statement on line 266. If any of the move variables is set to <span
class=Literal>True</span> or the current <span class=Literal>playerObj['bounce']</span>
is not <span class=Literal>0</span> (which means the player is currently in a
bounce), then the variable should be incremented on line 267.</p>

<p class=MsoNormal>Because the <span class=Literal>playerObj['bounce']</span>
variable should only be in the range of <span class=Literal>0</span> to <span
class=Literal>BOUNCERATE</span>, if incrementing it makes it larger than <span
class=Literal>BOUNCERATE</span>, it should be reset back to <span
class=Literal>0</span>.</p>

<h2><a name="_Toc316488722">Collision Detection: Eat or Be Eaten</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>272. </span>            <span
class=SourceCodeComment># check if the player has collided with any squirrels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>273. </span>            for
i in range(len(squirrelObjs)-1, -1, -1):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>274. </span>                sqObj
= squirrelObjs[i]</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on 273 will go run
code on each of the enemy squirrel game objects in <span class=Literal>squirrelObjs</span>.
Notice that the parameters to <span class=Literal>range()</span> on line 273
start at the last index of <span class=Literal>squirrelObjs</span> and
decrement. This is because the code inside this <span class=Literal>for</span>
loop may end up deleting some of these enemy squirrel game objects (if the
player’s squirrel ends up eating them), so it is important to iterate from the
end down to the front. The reason why was explained previously in the “When
Deleting Items in a List, Iterate Over the List in Reverse” section.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>275. </span>                if
'rect' in sqObj and playerObj['rect'].colliderect(sqObj['rect']):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>276. </span>                    <span
class=SourceCodeComment># a player/squirrel collision has occurred</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>277.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>278. </span>                    if
sqObj['width'] * sqObj['height'] &lt;= playerObj['size']**2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>279. </span>                        <span
class=SourceCodeComment># player is larger and eats the squirrel</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>280. </span>                        playerObj['size']
+= int( (sqObj['width'] * sqObj['height'])**0.2 ) + 1</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>281. </span>                        del
squirrelObjs[i]</p>

</div>

<p class=MsoNormal>If the player’s squirrel is equal or larger than the size of
the enemy squirrel it has collided with, then the player’s squirrel will eat
that squirrel and grow. The number that is added to the <span class=Literal>'size'</span>
key in the player object (that is, the growth) is calculated based on the enemy
squirrel’s size on line 280. Here’s a graph showing the growth from different
sized squirrels. Notice that larger squirrels cause more growth:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=577
height=275 id="Chart 52" src="chapter8_files/image010.png"></p>

<p class=MsoNormal>So, according to the chart, eating a squirrel that has a
width and height of 45 (that is, an area of 1600 pixels) would cause the player
to grow 5 pixels wider and taller.</p>

<p class=MsoNormal>Line 281 deletes the eaten squirrel object from the <span
class=Literal>squirrelObjs</span> list so that it will no longer appear on the
screen or have its position updated.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>283. </span>                        if
playerObj['facing'] == LEFT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>284. </span>                            playerObj['surface']
= pygame.transform.scale(L_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>285. </span>                        if
playerObj['facing'] == RIGHT:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>286. </span>                            playerObj['surface']
= pygame.transform.scale(R_SQUIR_IMG, (playerObj['size'], playerObj['size']))</p>

</div>

<p class=MsoNormal>The player’s squirrel image needs to be updated now that the
squirrel is larger. This can be done by passing the original squirrel image in <span
class=Literal>L_SQUIR_IMG</span> or <span class=Literal>R_SQUIR_IMG</span> to
the <span class=Literal>pygame.transform.scale()</span> function, which will
return an enlarged version of the image. Depending on whether <span
class=Literal>playerObj['facing']</span> is equal to <span class=Literal>LEFT</span>
or <span class=Literal>RIGHT</span> determines which original squirrel image we
pass to the function.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>288. </span>                        if
playerObj['size'] &gt; WINSIZE:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>289. </span>                            winMode
= True <span class=SourceCodeComment># turn on &quot;win mode&quot;</span></p>

</div>

<p class=MsoNormal>The way the player wins the game is by getting the squirrel
to have a size larger than the integer stored in the <span class=Literal>WINSIZE</span>
constant variable. If this is true, then the <span class=Literal>winMode</span>
variable is set to <span class=Literal>True</span>. Code in the other parts of
this function will handle displaying the congratulations text and checking for
the player to press the R key to restart the game.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>291. </span>                    elif
not invulnerableMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>292. </span>                        <span
class=SourceCodeComment># player is smaller and takes damage</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>293. </span>                        invulnerableMode
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>294. </span>                        invulnerableStartTime
= time.time()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>295. </span>                        playerObj['health']
-= 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>296. </span>                        if
playerObj['health'] == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>297. </span>                            gameOverMode
= True <span class=SourceCodeComment># turn on &quot;game over mode&quot;</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>298. </span>                            gameOverStartTime
= time.time()</p>

</div>

<p class=MsoNormal>If the player’s area was not equal to or larger than the area
of the enemy squirrel, and <span class=Literal>invulnerableMode</span> was not
set to <span class=Literal>True</span>, then the player will take damage from
colliding with this larger squirrel.</p>

<p class=MsoNormal>To prevent the player from being damaged several times by
the same squirrel immediately, we will briefly make the player invulnerable to
further squirrel attacks by setting <span class=Literal>invulnerableMode</span>
to <span class=Literal>True</span> on line 293. Line 294 will set <span
class=Literal>invulnerableStartTime</span> to the current time (which is
returned by <span class=Literal>time.time()</span>) so that lines 133 and 134
can know when to set <span class=Literal>invulnerableMode</span> to <span
class=Literal>False</span>.</p>

<p class=MsoNormal>Line 295 decrements the player’s health by <span
class=Literal>1</span>. Because there is a chance that the player’s health is
now at <span class=Literal>0</span>, line 296 checks for this and, if so, sets <span
class=Literal>gameOverMode</span> to <span class=Literal>True</span> and <span
class=Literal>gameOverStartTime</span> to the current time.</p>

<h2><a name="_Toc316488723">The Game Over Screen</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>299. </span>        else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>300. </span>            <span
class=SourceCodeComment># game is over, show &quot;game over&quot; text</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>301. </span>            DISPLAYSURF.blit(gameOverSurf,
gameOverRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>302. </span>            if
time.time() - gameOverStartTime &gt; GAMEOVERTIME:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>303. </span>                return
<span class=SourceCodeComment># end the current game</span></p>

</div>

<p class=MsoNormal>When the player has died, the “Game Over” text (which is on
the Surface object in the <span class=Literal>gameOverSurf</span> variable)
will be shown on the screen for the number of seconds that is in the <span
class=Literal>GAMEOVERTIME</span> constant. Once this amount of time has
elapsed, then the <span class=Literal>runGame()</span> function will return.</p>

<p class=MsoNormal>This lets the enemy squirrels continue to be animated and
moving around for a few seconds after the player dies and before the next game
starts. The “game over screen” in Squirrel Eat Squirrel does not wait until the
player presses a key before a new game starts.</p>

<h2><a name="_Toc316488724">Winning</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>305. </span>        <span
class=SourceCodeComment># check if the player has won.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>306. </span>        if
winMode:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>307. </span>            DISPLAYSURF.blit(winSurf,
winRect)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>308. </span>            DISPLAYSURF.blit(winSurf2,
winRect2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>309. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>310. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>311. </span>        FPSCLOCK.tick(FPS)</p>

</div>

<p class=MsoNormal>The <span class=Literal>winMode</span> variable is set to <span
class=Literal>True</span> on line 289 if the player has reached a certain size
(which is dictated by the <span class=Literal>WINSIZE</span> constant). All
that happens when the player has won is that the “You have achieved OMEGA
SQUIRREL!” text (which is on the Surface object stored in the <span
class=Literal>winSurf</span> variable) and the “(Press “r” to restart.)” text
(which is on the Surface object stored in the <span class=Literal>winSurf2</span>
variable) appears on the screen. The game continues until the user presses the
R key, at which point the program execution will return from <span
class=Literal>runGame()</span>. The event handling code for the R key is done
on lines 238 and 239.</p>

<h2><a name="_Toc316488725">Drawing a Graphical Health Meter</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>316. </span>def
drawHealthMeter(currentHealth):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>317. </span>    for
i in range(currentHealth): <span class=SourceCodeComment># draw red health bars</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>318. </span>        pygame.draw.rect(DISPLAYSURF,
RED,   (15, 5 + (10 * MAXHEALTH) - i * 10, 20, 10))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>319. </span>    for
i in range(MAXHEALTH): <span class=SourceCodeComment># draw the white outlines</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>320. </span>        pygame.draw.rect(DISPLAYSURF,
WHITE, (15, 5 + (10 * MAXHEALTH) - i * 10, 20, 10), 1)</p>

</div>

<p class=MsoNormal>To draw the health meter, first the <span class=Literal>for</span>
loop on line 317 draws the filled-in red rectangle for the amount of health the
player has. Then the <span class=Literal>for</span> loop on line 319 draws an unfilled
white rectangle for all of the possible health the player could have (which is
the integer value stored in the <span class=Literal>MAXHEALTH</span> constant).
Note that the <span class=Literal>pygame.display.update()</span> function is
not called in <span class=Literal>drawHealthMeter()</span>.</p>

<h2><a name="_Toc316488726">The Same Old </a><span class=Literal>terminate()</span>
Function</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>323. </span>def
terminate():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>324. </span>    pygame.quit()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>325. </span>    sys.exit()</p>

</div>

<p class=MsoNormal>The <span class=Literal>terminate()</span> function works
the same as in the previous game programs.</p>

<h2><a name="_Toc316488727">The Mathematics of the Sine Function</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>328. </span>def
getBounceAmount(currentBounce, bounceRate, bounceHeight):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>329. </span>    <span
class=SourceCodeComment># Returns the number of pixels to offset based on the
bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>330. </span>    <span
class=SourceCodeComment># Larger bounceRate means a slower bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>331. </span>    <span
class=SourceCodeComment># Larger bounceHeight means a higher bounce.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>332.</span>     <span
class=SourceCodeComment># currentBounce will always be less than bounceRate</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>333. </span>    return
int(math.sin( (math.pi / float(bounceRate)) * currentBounce ) * bounceHeight)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>334.</span></p>

</div>

<p class=MsoNormal>There is a mathematical function (which is similar to
functions in programming in that they both “return” or “evaluate” to a number
based on their parameters) called <span class=Definition>sine</span>
(pronounced like “sign” and often abbreviated as “sin”). You may have learned
about it in math class, but if you haven’t it will be explained here. Python
has this mathematic function as a Python function in the <span class=Literal>math</span>
module. You can pass an int or float value to <span class=Literal>math.sin()</span>,
and it will return a float value that is called the “sine value”</p>

<p class=MsoNormal>In the interactive shell, let’s see what <span
class=Literal>math.sin()</span> returns for some values:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import math</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
math.sin(1)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0.8414709848078965</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
math.sin(2)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0.90929742682568171</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
math.sin(3)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0.14112000805986721</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
math.sin(4)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>-0.7568024953079282</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
math.sin(5)</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>-0.95892427466313845</p>

</div>

<p class=MsoNormal>It seems really hard to predict what value <span
class=Literal>math.sin()</span> is going to return based on what value we pass
it (which might make you wonder what <span class=Literal>math.sin()</span> is
useful for). But if we graph the sine values of the integers <span
class=Literal>1</span> through <span class=Literal>10</span> on a graph, we
would get this:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=552
height=231 id="Chart 59" src="chapter8_files/image011.png"></p>

<p class=MsoNormal>You can kind of see a wavy pattern in the values returned by
<span class=Literal>math.sin()</span>. If you figure out the sine values for
more numbers besides integers (for example, <span class=Literal>1.5</span> and <span
class=Literal>2.5</span> and so on) and then connect the dots with lines, you
can see this wavy pattern more easily:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=552
height=247 id="Chart 60" src="chapter8_files/image012.png"></p>

<p class=MsoNormal>In fact, if you kept adding more and more data points to
this graph, you would see that the sine wave looks like this:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=232
height=96 id="Picture 61" src="chapter8_files/image013.jpg"></p>

<p class=MsoNormal>Notice that <span class=Literal>math.sin(0)</span> returns <span
class=Literal>0</span>, then gradually increases until <span class=Literal>math.sin(3.14
/ 2)</span> returns <span class=Literal>1</span>, then it begins to decrease
until <span class=Literal>math.sin(3.14)</span> returns <span class=Literal>0</span>.
The number <span class=Literal>3.14</span> is a special number in mathematics
called <span class=Definition>pi</span> (pronounced the same as delicious
“pie”). This value is also stored in the constant variable <span class=Literal>pi</span>
in the <span class=Literal>math</span> module (which is why line 333 uses the
variable, <span class=Literal>math.pi</span>), which is technically the float value
<span class=Literal>3.1415926535897931</span>. Since we want a wavy-looking
bounce for our squirrel, we’ll only pay attention to the return values of <span
class=Literal>math.sin()</span> for the arguments <span class=Literal>0</span>
to <span class=Literal>3.14</span>:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=541
height=289 id="Chart 66" src="chapter8_files/image014.png"></p>

<p class=MsoNormal>Let’s take a look at the return value of <span
class=Literal>getBounceAmount()</span> and figure out what it does exactly.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeatured><span class=SourceLineNumber>333. </span>    return
int(math.sin( (math.pi / float(bounceRate)) * currentBounce ) * bounceHeight)</p>

</div>

<p class=MsoNormal>Remember that on line 21 we set the <span class=Literal>BOUNCERATE</span>
constant to <span class=Literal>6</span>. This means that our code will only
increment <span class=Literal>playerObj['bounce']</span> from <span
class=Literal>0</span> to <span class=Literal>6</span> and that we want to
split up the range of floating-point values from <span class=Literal>0</span>
to <span class=Literal>3.14</span> into <span class=Literal>6</span> parts,
which we can do with simple division: <span class=Literal>3.14 / 6 = 0.5235</span>.
Each of the <span class=Literal>6</span> equal parts of the <span
class=Literal>3.14</span> length on the graph for the “sine wave bounce” is <span
class=Literal>0.5235</span>.</p>

<p class=MsoNormal>You can see that when <span class=Literal>playerObj['bounce']</span>
is at <span class=Literal>3</span> (halfway between <span class=Literal>0</span>
and <span class=Literal>6</span>), the value passed to the <span class=Literal>math.sin()</span>
call is <span class=Literal>math.pi / 6 * 3</span>, which is <span
class=Literal>1.5707</span> (halfway between <span class=Literal>0</span> and <span
class=Literal>3.1415</span>). Then <span class=Literal>math.sin(1.5707)</span>
will return <span class=Literal>1.0</span>, which is the highest part of the
sine wave (and the highest part of the sine wave happens half way through the
wave).</p>

<p class=MsoNormal>As <span class=Literal>playerObj['bounce']</span> gets its
value incremented, the <span class=Literal>getBounceAmount()</span> function
will return values that have the same bounce shape that the sine wave has from <span
class=Literal>0</span> to <span class=Literal>3.14</span>. If you want to make
the bounce higher, than increase the <span class=Literal>BOUNCEHEIGHT</span>
constant. If you want to make the bounce slower, than increase the <span
class=Literal>BOUNCERATE</span> constant.</p>

<p class=MsoNormal>The sine function is a concept from trigonometry
mathematics. If you’d like to learn more about the sine wave, the Wikipedia
page has detailed information: <span class=URL><a href="http://en.wikipedia.org/wiki/Sine">http://en.wikipedia.org/wiki/Sine</a></span></p>

<h2><a name="_Toc316488728">Backwards Compatibility with Python Version 2</a></h2>

<p class=MsoNormal>The reason we call <span class=Literal>float()</span> to
convert <span class=Literal>bounceRate</span> to a floating point number is
simply so that this program will work in Python version 2. In Python version 3,
the division operator will evaluate to a floating point value even if both of
the operands are integers, like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt; #
Python version 3</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; 10
/ 5</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2.0</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; 10
/ 4</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2.5</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>However, in Python version 2, the <span class=Literal>/</span>
division operator will only evaluate to a floating point value if one of the
operands is also a floating point value. If both operands are integers, then
Python 2’s division operator will evaluate to an integer value (rounding down
if needed), like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt; #
Python version 2</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; 10
/ 5</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; 10
/ 4</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; 10
/ 4.0</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2.5</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
10.0 / 4</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2.5</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
10.0 / 4.0</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>2.5</p>

</div>

<p class=MsoNormal>But if we always convert one of the values to a floating
point value with the <span class=Literal>float()</span> function, then the
division operator will evaluate to a float value no matter which version of
Python runs this source code. Making these changes so that our code works with
older versions of software is called <span class=Definition>backwards
compatibility</span>. It is important to maintain backwards compatibility,
because not everyone will always be running the latest version of software and
you want to ensure that the code you write works with as many computers as
possible.</p>

<p class=MsoNormal>You can’t always make your Python 3 code backwards
compatible with Python 2, but if it’s possible then you should do it.
Otherwise, when people with Python 2 try to run your games will get error
messages and think that your program is buggy.</p>

<p class=MsoNormal>A list of some differences between Python 2 and Python 3 can
be found at <span class=URL><a href="//inventwithpython.com/appendixa.html">http://inventwithpython.com/appendixa.html</a></span>.</p>

<h2><a name="_Toc316488729">The </a><span class=Literal>getRandomVelocity()</span>
Function</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>335. </span>def
getRandomVelocity():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>336. </span>    speed
= random.randint(SQUIRRELMINSPEED, SQUIRRELMAXSPEED)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>337. </span>    if
random.randint(0, 1) == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>338. </span>        return
speed</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>339. </span>    else:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>340. </span>        return
-speed</p>

</div>

<p class=MsoNormal>The <span class=Literal>getRandomVelocity()</span> function
is used to randomly determine how fast an enemy squirrel will move. The range
of this velocity is set in the <span class=Literal>SQUIRRELMINSPEED</span> and <span
class=Literal>SQUIRRELMAXSPEED</span> constants, but on top of that, the speed
is either negative (indicating the squirrel goes to the left or up) or positive
(indicating the squirrel goes to the right or down). There is a fifty-fifty
chance for the random speed to be positive or negative.</p>

<h2><a name="_Toc316488730">Finding a Place to Add New Squirrels and Grass</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>343. </span>def
getRandomOffCameraPos(camerax, cameray, objWidth, objHeight):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>344. </span>    <span
class=SourceCodeComment># create a Rect of the camera view</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>345. </span>    cameraRect
= pygame.Rect(camerax, cameray, WINWIDTH, WINHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>346. </span>    while
True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>347. </span>        x
= random.randint(camerax - WINWIDTH, camerax + (2 * WINWIDTH))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>348. </span>        y
= random.randint(cameray - WINHEIGHT, cameray + (2 * WINHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>349.        
</span><span class=SourceCodeComment># create a Rect object with the random
coordinates and use colliderect()</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>350.</span><span
class=SourceCodeComment>         # to make sure the right edge isn't in the
camera view.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>351. </span>        objRect
= pygame.Rect(x, y, objWidth, objHeight)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>352. </span>        if
not objRect.colliderect(cameraRect):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>353. </span>            return
x, y</p>

</div>

<p class=MsoNormal>When a new squirrel or grass object is created in the game
world, we want it to be within the active area (so that it is near the player’s
squirrel) but not within the view of the camera (so that it doesn’t just
suddenly pop into existence on the screen). To do this, we create a Rect object
that represents the area of the camera (using <span class=Literal>camerax</span>,
<span class=Literal>cameray</span>, <span class=Literal>WINWIDTH</span>, and <span
class=Literal>WINHEIGHT</span> constants).</p>

<p class=MsoNormal>Next, we randomly generate numbers for the XY coordinates
that would be within the active area. The active area’s left and top edge are <span
class=Literal>WINWIDTH</span> and <span class=Literal>WINHEIGHT</span> pixels
to the left and up of <span class=Literal>camerax</span> and <span
class=Literal>cameray</span>. So the active area’s left and top edge are at <span
class=Literal>camerax - WINWIDTH</span> and <span class=Literal>cameray -
WINHEIGHT</span>. The active area’s width and height are also three times the
size of the <span class=Literal>WINWIDTH</span> and <span class=Literal>WINHEIGHT</span>,
as you can see in this image (where <span class=Literal>WINWIDTH</span> is set
to 640 pixels and <span class=Literal>WINHEIGHT</span> set to 480 pixels):</p>

<p class=MsoNormal align=center style='text-align:center'><img width=269
height=196 id="Picture 51" src="chapter8_files/image015.png"></p>

<p class=MsoNormal>This means the right and bottom edges will be at <span
class=Literal>camerax + (2 * WINWIDTH)</span> and <span class=Literal>cameray +
(2 * WINHEIGHT)</span>. Line 352 will check if the random XY coordinates would
collide with the camera view’s Rect object. If not, then those coordinates are
returned. If so, then the <span class=Literal>while</span> loop on line 346
will keep generating new coordinates until it finds acceptable ones.</p>

<h2><a name="_Toc316488731">Creating Enemy Squirrel Data Structures</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>356. </span>def
makeNewSquirrel(camerax, cameray):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>357. </span>    sq
= {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>358. </span>    generalSize
= random.randint(5, 25)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>359. </span>    multiplier
= random.randint(1, 3)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>360. </span>    sq['width'] 
= (generalSize + random.randint(0, 10)) * multiplier</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>361. </span>    sq['height']
= (generalSize + random.randint(0, 10)) * multiplier</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>362. </span>    sq['x'],
sq['y'] = getRandomOffCameraPos(camerax, cameray, sq['width'], sq['height'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>363. </span>    sq['movex']
= getRandomVelocity()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>364. </span>    sq['movey']
= getRandomVelocity()</p>

</div>

<p class=MsoNormal>Creating enemy squirrel game objects is similar to making
the grass game objects. The data for each enemy squirrel is also stored in a
dictionary. The width and height are set to random sizes on line 360 and 361. The
<span class=Literal>generalSize</span> variable is used so that the width and
height of each squirrel aren’t too different from each other. Otherwise, using
completely random numbers for width and height could give us very tall and
skinny squirrels or very short and wide squirrels. The width and height of the
squirrel are this general size with a random number from <span class=Literal>0</span>
to <span class=Literal>10</span> added to it (for slight variation), and then
multiplied by the <span class=Literal>multiplier</span> variable.</p>

<p class=MsoNormal>The original XY coordinate position of the squirrel will be
a random location that the camera cannot see, to prevent the squirrels from
just “popping” into existence on the screen.</p>

<p class=MsoNormal>The speed and direction are also randomly selected by the <span
class=Literal>getRandomVelocity()</span> function.</p>

<h2><a name="_Toc316488732">Flipping the Squirrel Image</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>365. </span>    if
sq['movex'] &lt; 0: <span class=SourceCodeComment># squirrel is facing left</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>366. </span>        sq['surface']
= pygame.transform.scale(L_SQUIR_IMG, (sq['width'], sq['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>367. </span>    else:
<span class=SourceCodeComment># squirrel is facing right</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>368. </span>        sq['surface']
= pygame.transform.scale(R_SQUIR_IMG, (sq['width'], sq['height']))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>369. </span>    sq['bounce']
= 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>370. </span>    sq['bouncerate']
= random.randint(10, 18)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>371. </span>    sq['bounceheight']
= random.randint(10, 50)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>372. </span>    return
sq</p>

</div>

<p class=MsoNormal>The <span class=Literal>L_SQUIR_IMG</span> and <span
class=Literal>R_SQUIR_IMG</span> constants contain Surface objects with
left-facing and right-facing squirrel images on them. New Surface objects will
be made using the <span class=Literal>pygame.transform.scale()</span> function
to match the squirrel’s  width and height (stored in <span class=Literal>sq['width']</span>
and <span class=Literal>sq['height']</span> respectively).</p>

<p class=MsoNormal>After that, the three bounce-related values are randomly
generated (except for <span class=Literal>sq['bounce']</span> which is <span
class=Literal>0</span> because the squirrel always starts at the beginning of
the bounce) and the dictionary is returned on line 372.</p>

<h2><a name="_Toc316488733">Creating Grass Data Structures</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>375. </span>def
makeNewGrass(camerax, cameray):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>376. </span>    gr
= {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>377. </span>    gr['grassImage']
= random.randint(0, len(GRASSIMAGES) - 1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>378. </span>    gr['width'] 
= GRASSIMAGES[0].get_width()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>379. </span>    gr['height']
= GRASSIMAGES[0].get_height()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>380.</span>    
gr['x'], gr['y'] = getRandomOffCameraPos(camerax, cameray, gr['width'],
gr['height'])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>381.</span>    
gr['rect'] = pygame.Rect( (gr['x'], gr['y'], gr['width'], gr['height']) )</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>382. </span>    return
gr</p>

</div>

<p class=MsoNormal>The grass game objects are dictionaries with the usual <span
class=Literal>'x'</span>, <span class=Literal>'y'</span>, <span class=Literal>'width'</span>,
<span class=Literal>'height'</span>, and <span class=Literal>'rect'</span> keys
but also a <span class=Literal>'grassImage'</span> key which is a number from <span
class=Literal>0</span> to one less than the length of the <span class=Literal>GRASSIMAGES</span>
list. This number will determine what image the grass game object has. For
example, if the value of the grass object’s <span class=Literal>'grassImage'</span>
key is <span class=Literal>3</span>, then it will use the Surface object stored
at <span class=Literal>GRASSIMAGES[3]</span> for its image.</p>

<h2><a name="_Toc316488734">Checking if Outside the Active Area</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>385. </span>def
isOutsideActiveArea(camerax, cameray, obj):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>386. </span>    <span
class=SourceCodeComment># Return False if camerax and cameray are more than</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>387. </span>    <span
class=SourceCodeComment># a half-window length beyond the edge of the window.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>388. </span>    boundsLeftEdge
= camerax - WINWIDTH</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>389. </span>    boundsTopEdge
= cameray - WINHEIGHT</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>390. </span>    boundsRect
= pygame.Rect(boundsLeftEdge, boundsTopEdge, WINWIDTH * 3, WINHEIGHT * 3)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>391. </span>    objRect
= pygame.Rect(obj['x'], obj['y'], obj['width'], obj['height'])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>392. </span>    return
not boundsRect.colliderect(objRect)</p>

</div>

<p class=MsoNormal>The <span class=Literal>isOutsideActiveArea()</span> will
return <span class=Literal>True</span> if the object you pass it is outside of
the “active area” that is dictated by the <span class=Literal>camerax</span>
and <span class=Literal>cameray</span> parameters. Remember that the active
area is an area around the camera view the size of the camera view (which has a
width and height set by <span class=Literal>WINWIDTH</span> and <span
class=Literal>WINHEIGHT</span>), like this:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=269
height=196 id="Picture 3" src="chapter8_files/image015.png"></p>

<p class=MsoNormal>We can create a Rect object that represents the active area
by passing <span class=Literal>camerax - WINWIDTH</span> for the left edge
value and <span class=Literal>cameray - WINHEIGHT</span> for the top edge
value, and then <span class=Literal>WINWIDTH * 3</span> and <span
class=Literal>WINHEIGHT * 3</span> for the width and height. Once we have the
active area represented as a Rect object, we can use the <span class=Literal>colliderect()</span>
method to determine if the object in the <span class=Literal>obj</span>
parameter is collides with (that is, is inside of) the active area Rect object.</p>

<p class=MsoNormal>Since the player squirrel, enemy squirrel and grass objects
all have <span class=Literal>'x'</span>, <span class=Literal>'y'</span>, <span
class=Literal>'width'</span> and <span class=Literal>'height'</span> keys, the <span
class=Literal>isOutsideActiveArea()</span> code can work with any type of those
game objects. </p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>395. </span>if
__name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>396. </span>    main()</p>

</div>

<p class=MsoNormal>Finally, after all the functions have been defined, the
program will run the <span class=Literal>main()</span> function and start the
game.</p>

<h2><a name="_Toc316488735">Summary</a></h2>

<p class=MsoNormal>Squirrel Eat Squirrel was our first game to have multiple
enemies moving around the board at once. The key to having several enemies was
using a dictionary value with identical keys for each enemy squirrel, so that
the same code could be run on each of them during an iteration through the game
loop.</p>

<p class=MsoNormal>The concept of the camera was also introduced. Cameras
weren’t needed for our previous games because the entire game world fit onto
one screen. However, when you make your own games that involve a player moving
around a large game world, you will need code to handle converting between the
game world’s coordinate system and the screen’s pixel coordinate system.</p>

<p class=MsoNormal>Finally, the mathematical sine function was introduced to
give realistic squirrel hops (no matter how tall or long each hop was). You
don’t need to know a lot of math to do programming. In most cases, just knowing
addition, multiplication, and negative numbers is fine. However, if you study
mathematics, you’ll often find several uses for math to make your games cooler.</p>

<p class=MsoNormal>For additional programming practice, you can download buggy
versions of Squirrel Eat Squirrel from <span class=URL><a href="//invpy.com/buggy/squirrel">http://invpy.com/buggy/squirrel</a></span>
and try to figure out how to fix the bugs.</p>

</div>

</body>

</html>
