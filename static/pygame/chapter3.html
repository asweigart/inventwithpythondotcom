<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpFirst
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpMiddle
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h1.CxSpLast
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:black;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Tahoma","sans-serif";}
span.MsoPlaceholderText
	{color:gray;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpFirst, li.MsoTocHeadingCxSpFirst, div.MsoTocHeadingCxSpFirst
	{margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpMiddle, li.MsoTocHeadingCxSpMiddle, div.MsoTocHeadingCxSpMiddle
	{margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.MsoTocHeadingCxSpLast, li.MsoTocHeadingCxSpLast, div.MsoTocHeadingCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:black;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	color:black;
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.TableHeading
	{mso-style-name:"Table Heading";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:black;
	text-decoration:underline;}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";
	color:#1F497D;}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";
	color:#1F497D;}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";
	color:#1F497D;}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";
	color:#1F497D;}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Lucida Sans Typewriter", "Courier";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code Headline";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code HeadlineCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code HeadlineCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code HeadlineCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";
	font-family:"Times New Roman","serif";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.XXX
	{mso-style-name:XXX;
	font-family:Courier;
	color:red;}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style="background-color: #fffeee;">


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">Other programming books by Al Sweigart:<br>
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">X</a>

  <a target="_blank" href="https://www.amazon.com/gp/product/1593275994/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593275994&linkCode=as2&tag=playwithpyth-20&linkId=385b77199fa1e9f4fd21652cc57dab33" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1503212300?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1503212300" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.webp" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1482614375/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1482614375&amp;linkCode=as2&amp;tag=playwithpyth-20" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/gp/product/1593277628/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1593277628&linkCode=as2&tag=playwithpyth-20&linkId=0f1bd157c25d2e97db13d6434e5476a8"><img src="/images/cover_scratchprogrammingplayground_thumb.webp" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://www.udemy.com/automate/?couponCode=INVENT_WITH_PYTHON">Use this link to get 80%% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>



<div class=WordSection1>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 4.0pt 0in'>

<h1><a name="_Toc316488536"><span style='font-variant:normal !important;
text-transform:uppercase'>Chapter 3 – Memory Puzzle</span></a></h1>

</div>

<p class=MsoNormal align=center style='text-align:center'><img width=247
height=195 id="Picture 5" src="chapter3_files/image001.webp"></p>

<h2><a name="_Toc316488537">How to Play Memory Puzzle</a></h2>

<p class=MsoNormal>In the Memory Puzzle game, several icons are covered up by
white boxes. There are two of each icon. The player can click on two boxes to
see what icon is behind them. If the icons match, then those boxes remain
uncovered. The player wins when all the boxes on the board are uncovered. To
give the player a hint, the boxes are quickly uncovered once at the beginning
of the game.</p>

<h2><a name="_Toc316488538">Nested </a><span class=Literal>for</span> Loops</h2>

<p class=MsoNormal>One concept that you will see in Memory Puzzle (and most of
the games in this book) is the use of a <span class=Literal>for</span> loop
inside of another <span class=Literal>for</span> loop. These are called nested <span
class=Literal>for</span> loops. Nested <span class=Literal>for</span> loops are
handy for going through every possible combination of two lists. Type the
following into the interactive shell:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt; for
x in [0, 1, 2, 3, 4]:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...     for y in
['a', 'b', 'c']:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...        
print(x, y)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 c</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>There are several times in the Memory Puzzle code that we
need to iterate through every possible X and Y coordinate on the board. We’ll
use nested <span class=Literal>for</span> loops to make sure that we get every
combination. Note that the inner <span class=Literal>for</span> loop (the <span
class=Literal>for</span> loop inside the other <span class=Literal>for</span>
loop) will go through all of its iterations before going to the next iteration
of the outer <span class=Literal>for</span> loop. If we reverse the order of
the <span class=Literal>for</span> loops, the same values will be printed but
they will be printed in a different order. Type the following code into the
interactive shell, and compare the order it prints values to the order in the
previous nested <span class=Literal>for</span> loop example:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt; for
y in ['a', 'b', 'c']:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...     for x in
[0, 1, 2, 3, 4]:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...        
print(x, y)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 a</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>0 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>1 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>2 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>3 c</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>4 c</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc316488539">Source Code of Memory Puzzle</a></h2>

<p class=MsoNormal>This source code can be downloaded from <span class=URL><a href="http://invpy.com/memorypuzzle.py">http://invpy.com/memorypuzzle.py</a></span>.</p>

<p class=MsoNormal>Go ahead and first type in the entire program into IDLE’s
file editor, save it as <em>memorypuzzle.py</em>, and run it. If you get any
error messages, look at the line number that is mentioned in the error message
and check your code for any typos. You can also copy and paste your code into
the web form at <span class=URL><a href="http://invpy.com/diff/memorypuzzle">http://invpy.com/diff/memorypuzzle</a></span>
to see if the differences between your code and the code in the book.</p>

<p class=MsoNormal>You’ll probably pick up a few ideas about how the program
works just by typing it in once. And when you’re done typing it in, you can
then play the game for yourself.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  1. </span><span
class=SourceCodeComment># Memory Puzzle</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2. </span><span
class=SourceCodeComment># By Al Sweigart al@inventwithpython.com</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span><span
class=SourceCodeComment># http://inventwithpython.com/pygame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4. </span><span
class=SourceCodeComment># Released under a &quot;Simplified BSD&quot; license</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6. </span>import
random, pygame, sys</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7. </span>from
pygame.locals import *</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9. </span>FPS
= 30 <span class=SourceCodeComment># frames per second, the general speed of
the program</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10. </span>WINDOWWIDTH
= 640 <span class=SourceCodeComment># size of window's width in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 11. </span>WINDOWHEIGHT
= 480 <span class=SourceCodeComment># size of windows' height in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 12. </span>REVEALSPEED
= 8 <span class=SourceCodeComment># speed boxes' sliding reveals and covers</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13. </span>BOXSIZE
= 40 <span class=SourceCodeComment># size of box height &amp; width in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14. </span>GAPSIZE
= 10 <span class=SourceCodeComment># size of gap between boxes in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15. </span>BOARDWIDTH
= 10 <span class=SourceCodeComment># number of columns of icons</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16. </span>BOARDHEIGHT
= 7 <span class=SourceCodeComment># number of rows of icons</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17. </span>assert
(BOARDWIDTH * BOARDHEIGHT) % 2 == 0, 'Board needs to have an even number of
boxes for pairs of matches.'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18. </span>XMARGIN
= int((WINDOWWIDTH - (BOARDWIDTH * (BOXSIZE + GAPSIZE))) / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19. </span>YMARGIN
= int((WINDOWHEIGHT - (BOARDHEIGHT * (BOXSIZE + GAPSIZE))) / 2)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21. </span><span
class=SourceCodeComment>#            R    G    B</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22. </span>GRAY    
= (100, 100, 100)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23. </span>NAVYBLUE
= ( 60,  60, 100)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24. </span>WHITE   
= (255, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 25. </span>RED     
= (255,   0,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 26. </span>GREEN   
= (  0, 255,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 27. </span>BLUE    
= (  0,   0, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28. </span>YELLOW  
= (255, 255,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29. </span>ORANGE  
= (255, 128,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30. </span>PURPLE  
= (255,   0, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31. </span>CYAN    
= (  0, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33. </span>BGCOLOR
= NAVYBLUE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34. </span>LIGHTBGCOLOR
= GRAY</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35. </span>BOXCOLOR
= WHITE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 36. </span>HIGHLIGHTCOLOR
= BLUE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 38. </span>DONUT
= 'donut'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39. </span>SQUARE
= 'square'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40. </span>DIAMOND
= 'diamond'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41. </span>LINES
= 'lines'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 42. </span>OVAL
= 'oval'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 43. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 44. </span>ALLCOLORS
= (RED, GREEN, BLUE, YELLOW, ORANGE, PURPLE, CYAN)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45. </span>ALLSHAPES
= (DONUT, SQUARE, DIAMOND, LINES, OVAL)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 46. </span>assert
len(ALLCOLORS) * len(ALLSHAPES) * 2 &gt;= BOARDWIDTH * BOARDHEIGHT, &quot;Board
is too big for the number of shapes/colors defined.&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48. </span>def
main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49. </span>    global
FPSCLOCK, DISPLAYSURF</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50. </span>    pygame.init()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51. </span>    FPSCLOCK
= pygame.time.Clock()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52. </span>    DISPLAYSURF
= pygame.display.set_mode((WINDOWWIDTH, WINDOWHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54. </span>    mousex
= 0 <span class=SourceCodeComment># used to store x coordinate of mouse event</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55. </span>    mousey
= 0 <span class=SourceCodeComment># used to store y coordinate of mouse event</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 56. </span>    pygame.display.set_caption('Memory
Game')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58. </span>    mainBoard
= getRandomizedBoard()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59. </span>    revealedBoxes
= generateRevealedBoxesData(False)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 60. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61. </span>    firstSelection
= None <span class=SourceCodeComment># stores the (x, y) of the first box
clicked.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span>    DISPLAYSURF.fill(BGCOLOR)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 64. </span>    startGameAnimation(mainBoard)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 65. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 66. </span>    while
True: <span class=SourceCodeComment># main game loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67. </span>        mouseClicked
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69. </span>        DISPLAYSURF.fill(BGCOLOR)
<span class=SourceCodeComment># drawing the window</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70. </span>        drawBoard(mainBoard,
revealedBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 71. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 72. </span>        for
event in pygame.event.get(): <span class=SourceCodeComment># event handling
loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73. </span>            if
event.type == QUIT or (event.type == KEYUP and event.key == K_ESCAPE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74. </span>                pygame.quit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75. </span>                sys.exit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76. </span>            elif
event.type == MOUSEMOTION:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77. </span>                mousex,
mousey = event.pos</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78. </span>            elif
event.type == MOUSEBUTTONUP:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79. </span>                mousex,
mousey = event.pos</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80. </span>                mouseClicked
= True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 81. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 82. </span>        boxx,
boxy = getBoxAtPixel(mousex, mousey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83. </span>        if
boxx != None and boxy != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84. </span>            <span
class=SourceCodeComment># The mouse is currently over a box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85. </span>            if
not revealedBoxes[boxx][boxy]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 86.</span>               
drawHighlightBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 87. </span>            if
not revealedBoxes[boxx][boxy] and mouseClicked:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 88. </span>                revealBoxesAnimation(mainBoard,
[(boxx, boxy)])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 89. </span>                revealedBoxes[boxx][boxy]
= True <span class=SourceCodeComment># set the box as &quot;revealed&quot;</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 90. </span>                if
firstSelection == None: <span class=SourceCodeComment># the current box was the
first box clicked</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 91. </span>                    firstSelection
= (boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92. </span>                else:
<span class=SourceCodeComment># the current box was the second box clicked</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 93. </span>                    <span
class=SourceCodeComment># Check if there is a match between the two icons.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 94. </span>                    icon1shape,
icon1color = getShapeAndColor(mainBoard, firstSelection[0], firstSelection[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 95. </span>                    icon2shape,
icon2color = getShapeAndColor(mainBoard, boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 96. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 97. </span>                    if
icon1shape != icon2shape or icon1color != icon2color:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98. </span>                        <span
class=SourceCodeComment># Icons don't match. Re-cover up both selections.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 99. </span>                        pygame.time.wait(1000)
<span class=SourceCodeComment># 1000 milliseconds = 1 sec</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100. </span>                        coverBoxesAnimation(mainBoard,
[(firstSelection[0], firstSelection[1]), (boxx, boxy)])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101. </span>                        revealedBoxes[firstSelection[0]][firstSelection
[1]] = False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102. </span>                        revealedBoxes[boxx][boxy]
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>103. </span>                    elif
hasWon(revealedBoxes): <span class=SourceCodeComment># check if all pairs found</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>104. </span>                        gameWonAnimation(mainBoard)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105. </span>                        pygame.time.wait(2000)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107. </span>                        <span
class=SourceCodeComment># Reset the board</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>108. </span>                        mainBoard
= getRandomizedBoard()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>109. </span>                        revealedBoxes
= generateRevealedBoxesData(False)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111. </span>                        <span
class=SourceCodeComment># Show the fully unrevealed board for a second.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112. </span>                        drawBoard(mainBoard,
revealedBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113. </span>                        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114. </span>                        pygame.time.wait(1000)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span>                        <span
class=SourceCodeComment># Replay the start game animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117. </span>                        startGameAnimation(mainBoard)            </p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118. </span>                    firstSelection
= None <span class=SourceCodeComment># reset firstSelection variable</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120. </span>        <span
class=SourceCodeComment># Redraw the screen and wait a clock tick.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>122. </span>        FPSCLOCK.tick(FPS)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>123. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>124. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>125. </span>def
generateRevealedBoxesData(val):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126. </span>    revealedBoxes
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127. </span>    for
i in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128. </span>        revealedBoxes.append([val]
* BOARDHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>129. </span>    return
revealedBoxes</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>130. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>131. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132. </span>def
getRandomizedBoard():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133. </span>    <span
class=SourceCodeComment># Get a list of every possible shape in every possible
color.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>134. </span>    icons
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>135. </span>    for
color in ALLCOLORS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>136. </span>        for
shape in ALLSHAPES:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>137. </span>            icons.append(
(shape, color) )</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139. </span>    random.shuffle(icons)
<span class=SourceCodeComment># randomize the order of the icons list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140. </span>    numIconsUsed
= int(BOARDWIDTH * BOARDHEIGHT / 2) <span class=SourceCodeComment># calculate
how many icons are needed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141. </span>    icons
= icons[:numIconsUsed] * 2 <span class=SourceCodeComment># make two of each</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142. </span>    random.shuffle(icons)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>143.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>144. </span>    <span
class=SourceCodeComment># Create the board data structure, with randomly placed
icons.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145. </span>    board
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146. </span>    for
x in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147. </span>        column
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148. </span>        for
y in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149. </span>            column.append(icons[0])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150. </span>            del
icons[0] <span class=SourceCodeComment># remove the icons as we assign them</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151. </span>        board.append(column)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>152. </span>    return
board</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>153. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>154. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>155. </span>def
splitIntoGroupsOf(groupSize, theList):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156. </span>    <span
class=SourceCodeComment># splits a list into a list of lists, where the inner
lists have at</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157. </span>    <span
class=SourceCodeComment># most groupSize number of items.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158. </span>    result
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159. </span>    for
i in range(0, len(theList), groupSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160. </span>        result.append(theList[i:i
+ groupSize])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>161. </span>    return
result</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>162. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>163. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>164. </span>def
leftTopCoordsOfBox(boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165. </span>    <span
class=SourceCodeComment># Convert board coordinates to pixel coordinates</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166. </span>    left
= boxx * (BOXSIZE + GAPSIZE) + XMARGIN</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>167. </span>    top
= boxy * (BOXSIZE + GAPSIZE) + YMARGIN</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>168. </span>    return
(left, top)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>169. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>170. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>171. </span>def
getBoxAtPixel(x, y):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>172. </span>    for
boxx in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>173. </span>        for
boxy in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>174. </span>            left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>175. </span>            boxRect
= pygame.Rect(left, top, BOXSIZE, BOXSIZE)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>176. </span>            if
boxRect.collidepoint(x, y):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>177. </span>                return
(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>178. </span>    return
(None, None)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>179. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>180. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>181. </span>def
drawIcon(shape, color, boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>182. </span>    quarter
= int(BOXSIZE * 0.25) <span class=SourceCodeComment># syntactic sugar</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>183. </span>    half
=    int(BOXSIZE * 0.5)  <span class=SourceCodeComment># syntactic sugar</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>184. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>185. </span>    left,
top = leftTopCoordsOfBox(boxx, boxy) <span class=SourceCodeComment># get pixel
coords from board coords</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>186. </span>    <span
class=SourceCodeComment># Draw the shapes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187. </span>    if
shape == DONUT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>188. </span>        pygame.draw.circle(DISPLAYSURF,
color, (left + half, top + half), half - 5)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>189. </span>        pygame.draw.circle(DISPLAYSURF,
BGCOLOR, (left + half, top + half), quarter - 5)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>190. </span>    elif
shape == SQUARE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>191. </span>        pygame.draw.rect(DISPLAYSURF,
color, (left + quarter, top + quarter, BOXSIZE - half, BOXSIZE - half))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>192. </span>    elif
shape == DIAMOND:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>193. </span>        pygame.draw.polygon(DISPLAYSURF,
color, ((left + half, top), (left + BOXSIZE - 1, top + half), (left + half, top
+ BOXSIZE - 1), (left, top + half)))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>194. </span>    elif
shape == LINES:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>195. </span>        for
i in range(0, BOXSIZE, 4):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>196. </span>            pygame.draw.line(DISPLAYSURF,
color, (left, top + i), (left + i, top))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>197. </span>            pygame.draw.line(DISPLAYSURF,
color, (left + i, top + BOXSIZE - 1), (left + BOXSIZE - 1, top + i))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span>    elif
shape == OVAL:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>199. </span>        pygame.draw.ellipse(DISPLAYSURF,
color, (left, top + quarter, BOXSIZE, half))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>200. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>201. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>202. </span>def
getShapeAndColor(board, boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>203. </span>    <span
class=SourceCodeComment># shape value for x, y spot is stored in board[x][y][0]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>204. </span>    <span
class=SourceCodeComment># color value for x, y spot is stored in board[x][y][1]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>205. </span>    return
board[boxx][boxy][0], board[boxx][boxy][1]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>206. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>207. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>208. </span>def
drawBoxCovers(board, boxes, coverage):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>209. </span>    <span
class=SourceCodeComment># Draws boxes being covered/revealed. &quot;boxes&quot;
is a list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>210. </span>    <span
class=SourceCodeComment># of two-item lists, which have the x &amp; y spot of
the box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>211. </span>    for
box in boxes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>212. </span>        left,
top = leftTopCoordsOfBox(box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>213. </span>        pygame.draw.rect(DISPLAYSURF,
BGCOLOR, (left, top, BOXSIZE, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>214. </span>        shape,
color = getShapeAndColor(board, box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>215. </span>        drawIcon(shape,
color, box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216. </span>        if
coverage &gt; 0: <span class=SourceCodeComment># only draw the cover if there
is an coverage</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>217. </span>            pygame.draw.rect(DISPLAYSURF,
BOXCOLOR, (left, top, coverage, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>218. </span>    pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>219. </span>    FPSCLOCK.tick(FPS)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>220. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>221. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>222. </span>def
revealBoxesAnimation(board, boxesToReveal):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>223. </span>    <span
class=SourceCodeComment># Do the &quot;box reveal&quot; animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224. </span>    for
coverage in range(BOXSIZE, (-REVEALSPEED) - 1, - REVEALSPEED):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>225. </span>        drawBoxCovers(board,
boxesToReveal, coverage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>226. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>227. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228. </span>def
coverBoxesAnimation(board, boxesToCover):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229. </span>    <span
class=SourceCodeComment># Do the &quot;box cover&quot; animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230. </span>    for
coverage in range(0, BOXSIZE + REVEALSPEED, REVEALSPEED):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>231. </span>        drawBoxCovers(board,
boxesToCover, coverage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>232. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>233. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>234. </span>def
drawBoard(board, revealed):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235. </span>    <span
class=SourceCodeComment># Draws all of the boxes in their covered or revealed
state.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236. </span>    for
boxx in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>237. </span>        for
boxy in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>238. </span>            left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>239. </span>            if
not revealed[boxx][boxy]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>240. </span>                <span
class=SourceCodeComment># Draw a covered box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>241. </span>                pygame.draw.rect(DISPLAYSURF,
BOXCOLOR, (left, top, BOXSIZE, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242. </span>            else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243. </span>                <span
class=SourceCodeComment># Draw the (revealed) icon.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244. </span>                shape,
color = getShapeAndColor(board, boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>245. </span>                drawIcon(shape,
color, boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>246. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>247. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>248. </span>def
drawHighlightBox(boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249. </span>    left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>250. </span>    pygame.draw.rect(DISPLAYSURF,
HIGHLIGHTCOLOR, (left - 5, top - 5, BOXSIZE + 10, BOXSIZE + 10), 4)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>251. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>252. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>253. </span>def
startGameAnimation(board):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>254. </span>    <span
class=SourceCodeComment># Randomly reveal the boxes 8 at a time.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>255. </span>    coveredBoxes
= generateRevealedBoxesData(False)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>256. </span>    boxes
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257. </span>    for
x in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258. </span>        for
y in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>259. </span>            boxes.append(
(x, y) )</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>260. </span>    random.shuffle(boxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>261. </span>    boxGroups
= splitIntoGroupsOf(8, boxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>262. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>263.</span>    
drawBoard(board, coveredBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>264. </span>    for
boxGroup in boxGroups:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>265. </span>        revealBoxesAnimation(board,
boxGroup)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>266. </span>        coverBoxesAnimation(board,
boxGroup)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>267. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>268. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>269. </span>def
gameWonAnimation(board):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>270. </span>    <span
class=SourceCodeComment># flash the background color when the player has won</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>271. </span>    coveredBoxes
= generateRevealedBoxesData(True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>272. </span>    color1
= LIGHTBGCOLOR</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>273. </span>    color2
= BGCOLOR</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>274. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>275. </span>    for
i in range(13):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>276. </span>        color1,
color2 = color2, color1 <span class=SourceCodeComment># swap colors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>277. </span>        DISPLAYSURF.fill(color1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>278. </span>        drawBoard(board,
coveredBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>279. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>280. </span>        pygame.time.wait(300)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>281. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>282. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>283. </span>def
hasWon(revealedBoxes):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>284. </span>    <span
class=SourceCodeComment># Returns True if all the boxes have been revealed,
otherwise False</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>285. </span>    for
i in revealedBoxes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>286. </span>        if
False in i:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>287. </span>            return
False <span class=SourceCodeComment># return False if any boxes are covered.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>288. </span>    return
True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>289. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>290. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>291. </span>if
__name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>292. </span>    main()</p>

</div>

<h2><a name="_Toc316488540">Credits and Imports</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  1. </span><span
class=SourceCodeComment># Memory Puzzle</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2. </span><span
class=SourceCodeComment># By Al Sweigart al@inventwithpython.com</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span><span
class=SourceCodeComment># http://inventwithpython.com/pygame</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4. </span><span
class=SourceCodeComment># Released under a &quot;Simplified BSD&quot; license</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6. </span>import
random, pygame, sys</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>  7. </span>from
pygame.locals import *</p>

</div>

<p class=MsoNormal>At the top of the program are comments about what the game
is, who made it, and where the user could find more information. There’s also a
note that the source code is freely copyable under a “Simplified BSD” license.
The Simplified BSD license is more appropriate for software than the Creative
Common license (which this book is released under), but they basically mean the
same thing: People are free to copy and share this game. More info about
licenses can be found at <span class=URL><a href="http://invpy.com/licenses">http://invpy.com/licenses</a></span>.</p>

<p class=MsoNormal>This program makes use of many functions in other modules,
so it imports those modules on line 6. Line 7 is also an <span class=Literal>import</span>
statement in the <span class=Literal>from (module name) import *</span> format,
which means you do not have to type the module name in front of it. There are
no functions in the <span class=Literal>pygame.locals</span> module, but there
are several constant variables in it that we want to use such as <span
class=Literal>MOUSEMOTION</span>, <span class=Literal>KEYUP</span>, or <span
class=Literal>QUIT</span>. Using this style of <span class=Literal>import</span>
statement, we only have to type <span class=Literal>MOUSEMOTION</span> rather
than <span class=Literal>pygame.locals.MOUSEMOTION</span>.</p>

<h2><a name="_Toc316488541">Magic Numbers are Bad</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  9. </span>FPS
= 30 <span class=SourceCodeComment># frames per second, the general speed of
the program</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10. </span>WINDOWWIDTH
= 640 <span class=SourceCodeComment># size of window's width in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 11. </span>WINDOWHEIGHT
= 480 <span class=SourceCodeComment># size of windows' height in pixels</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 12. </span>REVEALSPEED
= 8 <span class=SourceCodeComment># speed boxes' sliding reveals and covers</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13. </span>BOXSIZE
= 40 <span class=SourceCodeComment># size of box height &amp; width in pixels</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 14. </span>GAPSIZE
= 10 <span class=SourceCodeComment># size of gap between boxes in pixels</span></p>

</div>

<p class=MsoNormal>The game programs in this book use a lot of constant
variables. You might not realize why they’re so handy. For example, instead of
using the <span class=Literal>BOXSIZE</span> variable in our code we could just
type the integer <span class=Literal>40</span> directly in the code. But there
are two reasons to use constant variables.</p>

<p class=MsoNormal>First, if we ever wanted to change the size of each box
later, we would have to go through the entire program and find and replace each
time we typed <span class=Literal>40</span>. By just using the <span
class=Literal>BOXSIZE</span> constant, we only have to change line 13 and the
rest of the program is already up to date. This is much better, especially
since we might use the integer value <span class=Literal>40</span> for
something else besides the size of the white boxes, and changing that <span
class=Literal>40</span> accidentally would cause bugs in our program.</p>

<p class=MsoNormal>Second, it makes the code more readable. Go down to the next
section and look at line 18. This sets up a calculation for the <span
class=Literal>XMARGIN</span> constant, which is how many pixels are on the side
of the entire board. It is a complicated looking expression, but you can
carefully piece out what it means. Line 18 looks like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>XMARGIN = int((WINDOWWIDTH
- (BOARDWIDTH * (BOXSIZE + GAPSIZE))) / 2)</p>

</div>

<p class=MsoNormal>But if line 18 didn’t use constant variables, it would look
like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>XMARGIN = int((640 – (10 *
(40 + 10))) / 2)</p>

</div>

<p class=MsoNormal>Now it becomes impossible to remember what exactly the
programmer intended to mean. These unexplained numbers in the source code are
often called <span class=Definition>magic numbers</span>. Whenever you find
yourself entering magic numbers, you should consider replacing them with a
constant variable instead. To the Python interpreter, both of the previous
lines are the exact same. But to a human programmer who is reading the source
code and trying to understand how it works, the second version of line 18
doesn’t make much sense at all! Constants really help the readability of source
code.</p>

<p class=MsoNormal>Of course, you can go too far replacing numbers with
constant variables. Look at the following code:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>ZERO = 0</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>ONE = 1</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>TWO = 99999999</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>TWOANDTHREEQUARTERS
= 2.75</p>

</div>

<p class=MsoNormal>Don’t write code like that. That’s just silly.</p>

<h2><a name="_Toc316488542">Sanity Checks with </a><span class=Literal>assert</span>
Statements</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 15. </span>BOARDWIDTH
= 10 <span class=SourceCodeComment># number of columns of icons</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16. </span>BOARDHEIGHT
= 7 <span class=SourceCodeComment># number of rows of icons</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17. </span>assert
(BOARDWIDTH * BOARDHEIGHT) % 2 == 0, 'Board needs to have an even number of
boxes for pairs of matches.'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18. </span>XMARGIN
= int((WINDOWWIDTH - (BOARDWIDTH * (BOXSIZE + GAPSIZE))) / 2)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 19. </span>YMARGIN
= int((WINDOWHEIGHT - (BOARDHEIGHT * (BOXSIZE + GAPSIZE))) / 2)</p>

</div>

<p class=MsoNormal>The <span class=Literal>assert</span> statement on line 17
ensures that the board width and height we’ve selected will result in an even
number of boxes (since we will have pairs of icons in this game). There are
three parts to an <span class=Literal>assert</span> statement: the <span
class=Literal>assert</span> keyword, an expression which, if <span
class=Literal>False</span>, results in crashing the program. The third part
(after the comma after the expression) is a string that appears if the program
crashes because of the assertion.</p>

<p class=MsoNormal>The <span class=Literal>assert</span> statement with an
expression basically says, “The programmer asserts that this expression must be
<span class=Literal>True</span>, otherwise crash the program.” This is a good
way of adding a sanity check to your program to make sure that if the execution
ever passes an assertion we can at least know that that code is working as
expected.</p>

<h2><a name="_Toc316488543">Telling If a Number is Even or Odd</a></h2>

<p class=MsoNormal>If the product of the board width and height is divided by
two and has a remainder of 0 (the <span class=Literal>%</span> <span
class=Definition>modulus operator</span> evaluates what the remainder is) then
the number is even. Even numbers divided by two will always have a remainder of
zero. Odd numbers divided by two will always have a remainder of one. This is a
good trick to remember if you need your code to tell if a number is even or
odd:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
isEven = someNumber % 2 == 0</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt; isOdd
= someNumber % 2 != 0</p>

</div>

<p class=MsoNormal>In the above case, if the integer in <span class=Literal>someNumber</span>
was even, then <span class=Literal>isEven</span> will be <span class=Literal>True</span>.
If it was odd, then <span class=Literal>isOdd</span> will be <span
class=Literal>True</span>.</p>

<h2><a name="_Toc316488544">Crash Early and Crash Often!</a></h2>

<p class=MsoNormal>Having your program crash is a bad thing. It happens when
your program has some mistake in the code and cannot continue. But there are
some cases where crashing a program early can avoid worse bugs later.</p>

<p class=MsoNormal>If the values we chose for <span class=Literal>BOARDWIDTH</span>
and <span class=Literal>BOARDHEIGHT</span> that we chose on line 15 and 16
result in a board with an odd number of boxes (such as if the width were 3 and
the height were 5), then there would always be one left over icon that would
not have a pair to be matched with. This would cause a bug later on in the
program, and it could take a lot of debugging work to figure out that the real
source of the bug is at the very beginning of the program. In fact, just for
fun, try commenting out the assertion so it doesn’t run, and then setting the <span
class=Literal>BOARDWIDTH</span> and <span class=Literal>BOARDHEIGHT</span>
constants both to odd numbers. When you run the program, it will immediately
show an error happening on a line 149 in <em>memorypuzzle.py</em>, which is in <span
class=Literal>getRandomizedBoard()</span> function!</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>Traceback (most
recent call last):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File
&quot;C:\book2svn\src\memorypuzzle.py&quot;, line 292, in &lt;module&gt;</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    main()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File
&quot;C:\book2svn\src\memorypuzzle.py&quot;, line 58, in main</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    mainBoard =
getRandomizedBoard()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File &quot;C:\book2svn\src\memorypuzzle.py&quot;,
line 149, in getRandomizedBoard</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
columns.append(icons[0])</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>IndexError: list
index out of range</p>

</div>

<p class=MsoNormal>We could spend a lot of time looking at <span class=Literal>getRandomizedBoard()</span>
trying to figure out what’s wrong with it before realizing that <span
class=Literal>getRandomizedBoard()</span> is perfectly fine: the real source of
the bug was on line 15 and 16 where we set the <span class=Literal>BOARDWIDTH</span>
and <span class=Literal>BOARDHEIGHT</span> constants.</p>

<p class=MsoNormal>The assertion makes sure that this never happens. If our
code is going to crash, we want it to crash as soon as it detects something is terribly
wrong, because otherwise the bug may not become apparent until much later in
the program. Crash early!</p>

<p class=MsoNormal>You want to add <span class=Literal>assert</span> statements
whenever there is some condition in your program that must always, always,
always be <span class=Literal>True</span>. Crash often! You don’t have to go
overboard and put <span class=Literal>assert</span> statements everywhere, but
crashing often with asserts goes a long way in detecting the true source of a
bug. Crash early and crash often! </p>

<p class=MsoNormal>(In your code that is. Not, say, when riding a pony.)</p>

<h2><a name="_Toc316488545">Making the Source Code Look Pretty</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 21. </span><span
class=SourceCodeComment>#            R    G    B</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22. </span>GRAY    
= (100, 100, 100)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23. </span>NAVYBLUE
= ( 60,  60, 100)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24. </span>WHITE   
= (255, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 25. </span>RED     
= (255,   0,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 26. </span>GREEN   
= (  0, 255,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 27. </span>BLUE    
= (  0,   0, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28. </span>YELLOW  
= (255, 255,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29. </span>ORANGE  
= (255, 128,   0)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30. </span>PURPLE  
= (255,   0, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31. </span>CYAN    
= (  0, 255, 255)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33. </span>BGCOLOR
= NAVYBLUE</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34. </span>LIGHTBGCOLOR
= GRAY</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35. </span>BOXCOLOR
= WHITE</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 36. </span>HIGHLIGHTCOLOR
= BLUE</p>

</div>

<p class=MsoNormal>Remember that colors in Pygame are represented by a tuple of
three integers from <span class=Literal>0</span> to <span class=Literal>255</span>.
These three integers represent the amount of red, green, and blue in the color
which is why these tuples are called RGB values. Notice the spacing of the
tuples on lines 22 to 31 are such that the R, G, and B integers line up. In
Python the indentation (that is, the space at the beginning of the line) is needs
to be exact, but the spacing in the rest of the line is not so strict. By
spacing the integers in the tuple out, we can clearly see how the RGB values
compare to each other. (More info on spacing and indentation is as <span
class=URL><a href="http://invpy.com/whitespace">http://invpy.com/whitespace</a></span>.)</p>

<p class=MsoNormal>It is a nice thing to make your code more readable this way,
but don’t bother spending too much time doing it. Code doesn’t have to be pretty
to work. At a certain point, you’ll just be spending more time typing spaces
than you would have saved by having readable tuple values.</p>

<h2><a name="_Toc316488546">Using Constant Variables Instead of Strings</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 38. </span>DONUT
= 'donut'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39. </span>SQUARE
= 'square'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40. </span>DIAMOND
= 'diamond'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41. </span>LINES
= 'lines'</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 42. </span>OVAL
= 'oval'</p>

</div>

<p class=MsoNormal>The program also sets up constant variables for some
strings. These constants will be used in the data structure for the board,
tracking which spaces on the board have which icons. Using a constant variable
instead of the string value is a good idea. Look at the following code, which
comes from line 187:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>    if shape == DONUT:</p>

</div>

<p class=MsoNormal>The shape variable will be set to one of the strings <span
class=Literal>'donut'</span>, <span class=Literal>'square'</span>, <span
class=Literal>'diamond'</span>, <span class=Literal>'lines'</span>, or <span
class=Literal>'oval'</span> and then compared to the <span class=Literal>DONUT</span>
constant. If we made a typo when writing line 187, for example, something like
this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>    if shape == DUNOT:</p>

</div>

<p class=MsoNormal>Then Python would crash, giving an error message saying that
there is no variable named <span class=Literal>DUNOT</span>. This is good.
Since the program has crashed on line 187, when we check that line it will be
easy to see that the bug was caused by a typo. However, if we were using
strings instead of constant variables and made the same typo, line 187 would
look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>    if shape == 'dunot':</p>

</div>

<p class=MsoNormal>This is perfectly acceptable Python code, so it won’t crash
at first when you run it. However, this will lead to weird bugs later on in our
program. Because the code does not immediately crash where the problem is
caused, it can be much harder to find it.</p>

<h2><a name="_Toc316488547">Making Sure We Have Enough Icons</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 44. </span>ALLCOLORS
= (RED, GREEN, BLUE, YELLOW, ORANGE, PURPLE, CYAN)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45. </span>ALLSHAPES
= (DONUT, SQUARE, DIAMOND, LINES, OVAL)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 46. </span>assert
len(ALLCOLORS) * len(ALLSHAPES) * 2 &gt;= BOARDWIDTH * BOARDHEIGHT, &quot;Board
is too big for the number of shapes/colors defined.&quot;</p>

</div>

<p class=MsoNormal>In order for our game program to be able to create icons of
every possible color and shape combination, we need to make a tuple that holds
all of these values. There is also another assertion on line 46 to make sure
that there are enough color/shape combinations for the size of the board we
have. If there isn’t, then the program will crash on line 46 and we will know
that we either have to add more colors and shapes, or make the board width and
height smaller. With 7 colors and 5 shapes, we can make 35 (that is, 7 x 5)
different icons. And because we’ll have a pair of each icon, that means we can
have a board with up to 70 (that is, 35 x 2, or 7 x 5 x 2) spaces.</p>

<h2><a name="_Toc316488548">Tuples vs. Lists, Immutable vs. Mutable</a></h2>

<p class=MsoNormal>You might have noticed that the <span class=Literal>ALLCOLORS</span>
and <span class=Literal>ALLSHAPES</span> variables are tuples instead of lists.
When do we want to use tuples and when do we want to use lists? And what’s the
difference between them anyway?</p>

<p class=MsoNormal>Tuples and lists are the same in every way except two:
tuples use parentheses instead of square brackets, and the items in tuples
cannot be modified (but the items in lists can be modified). We often call
lists <span class=Definition>mutable</span> (meaning they can be changed) and
tuples <span class=Definition>immutable</span> (meaning they cannot be
changed).</p>

<p class=MsoNormal>For an example of trying to change values in lists and
tuples, look at the following code:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
listVal = [1, 1, 2, 3, 5, 8]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal = (1, 1, 2, 3, 5, 8)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
listVal[4] = 'hello!'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
listVal</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>[1, 1, 2, 3, 'hello!',
8]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal[4] = 'hello!'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>Traceback (most
recent call last):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>TypeError:
'tuple' object does not support item assignment</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>(1, 1, 2, 3, 5,
8)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal[4]</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>5</p>

</div>

<p class=MsoNormal>Notice that when we try to change the item at index <span
class=Literal>2</span> in the tuple, Python gives us an error message saying
that tuple objects do not support “item assignment”.</p>

<p class=MsoNormal>There is a silly benefit and an important benefit to tuple’s
immutability. The silly benefit is that code that uses tuples is slightly
faster than code that uses lists. (Python is able to make some optimizations
knowing that the values in a tuple will never change.) But having your code run
a few nanoseconds faster is not important.</p>

<p class=MsoNormal>The important benefit to using tuples is similar to the
benefit of using constant variables: it’s a sign that the value in the tuple
will never change, so anyone reading the code later will be able to say, “I can
expect that this tuple will always be the same. Otherwise the programmer would
have used a list.” This also lets a future programmer reading your code say,
“If I see a list value, I know that it could be modified at some point in this
program. Otherwise, the programmer who wrote this code would have used a
tuple.”</p>

<p class=MsoNormal>You can still assign a new tuple value to a variable:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal = (1, 2, 3)</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;
tupleVal = (1, 2, 3, 4)</p>

</div>

<p class=MsoNormal>The reason this code works is because the code isn’t
changing the <span class=Literal>(1, 2, 3)</span> tuple on the second line. It
is assigning an entirely new tuple <span class=Literal>(1, 2, 3, 4)</span> to
the <span class=Literal>tupleVal</span>, and overwriting the old tuple value.
You cannot however, use the square brackets to modify an item in the tuple.</p>

<p class=MsoNormal>Strings are also an immutable data type. You can use the
square brackets to read a single character in a string, but you cannot change a
single character in a string:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
strVal = 'Hello'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
strVal[1]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>'e'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
strVal[1] = 'X'</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>Traceback (most
recent call last):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>TypeError: 'str'
object does not support item assignment</p>

</div>

<h2><a name="_Toc316488549">One Item Tuples Need a Trailing Comma</a></h2>

<p class=MsoNormal>Also, one minor details about tuples: if you ever need to
write code about a tuple that has one value in it, then it needs to have a
trailing comma in it, such as this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>oneValueTuple = (42, )</p>

</div>

<p class=MsoNormal>If you forget this comma (and it is very easy to forget),
then Python won’t be able to tell the difference between this and a set of
parentheses that just change the order of operations. For example, look at the
following two lines of code:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>variableA = (5 *
6)</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>variableB = (5 *
6, )</p>

</div>

<p class=MsoNormal>The value that is stored in <span class=Literal>variableA</span>
is just the integer <span class=Literal>30</span>. However, the expression for <span
class=Literal>variableB</span>’s assignment statement is the single-item tuple
value <span class=Literal>(30, )</span>. Blank tuple values do not need a comma
in them, they can just be a set of parentheses by themselves: <span
class=Literal>()</span>.</p>

<h2><a name="_Toc316488550">Converting Between Lists and Tuples</a></h2>

<p class=MsoNormal>You can convert between list and tuple values just like you
can convert between string and integer values. Just pass a tuple value to the <span
class=Literal>list()</span> function and it will return a list form of that tuple
value. Or, pass a list value to the <span class=Literal>tuple()</span> function
and it will return a tuple form of that list value. Try typing the following
into the interactive shell:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt; spam
= (1, 2, 3, 4)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam = list(spam)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>[1, 2, 3, 4]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam = tuple(spam)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>(1, 2, 3, 4)</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc316488551">The </a><span class=Literal>global</span>
statement, and Why Global Variables are Evil</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 48. </span>def
main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49. </span>    global
FPSCLOCK, DISPLAYSURF</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50. </span>    pygame.init()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51. </span>    FPSCLOCK
= pygame.time.Clock()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52. </span>    DISPLAYSURF
= pygame.display.set_mode((WINDOWWIDTH, WINDOWHEIGHT))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54. </span>    mousex
= 0 <span class=SourceCodeComment># used to store x coordinate of mouse event</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55. </span>    mousey
= 0 <span class=SourceCodeComment># used to store y coordinate of mouse event</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 56. </span>    pygame.display.set_caption('Memory
Game')</p>

</div>

<p class=MsoNormal>This is the start of the <span class=Literal>main()</span>
function, which is where (oddly enough) the main part of the game code is. The
functions called in the <span class=Literal>main()</span> function will be
explained later in this chapter.</p>

<p class=MsoNormal>Line 49 is a <span class=Literal>global</span> statement.
The <span class=Literal>global</span> statement is the <span class=Literal>global</span>
keyword followed by a comma-delimited list of variable names. These variable
names are then marked as global variables. Inside the <span class=Literal>main()</span>
function, those names are not for local variables that might just happen to
have the same name as global variables. They <em>are</em> the global variables.
Any values assigned to them in the <span class=Literal>main()</span> function
will persist outside the <span class=Literal>main()</span> function. We are
marking the <span class=Literal>FPSCLOCK</span> and <span class=Literal>DISPLAYSURF</span>
variables as global because they are used in several other functions in the
program. (More info is at <span class=URL><a href="http://invpy.com/scope">http://invpy.com/scope</a></span>.)</p>

<p class=MsoNormal>There are four simple rules to determine if a variable is
local or global:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
there is a global statement for a variable at the beginning of the function,
then the variable is global.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the name of a variable in a function has the same name as a global variable and
the function never assigns the variable a value, then that variable is the
global variable.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the name of a variable in a function has the same name as a global variable and
the function does assign the variable a value, then that variable is a local
variable.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
there isn't a global variable with the same name as the variable in the
function, then that variable is obviously a local variable.</p>

<p class=MsoNormal>You generally want to avoid using global variables inside
functions. A function is supposed to be like a mini-program inside your program
with specific inputs (the parameters) and an output (the return value). But a
function that reads and writes to global variables has additional inputs and
output. Since the global variable could have been modified in many places
before the function was called, it can be tricky to track down a bug involving
a bad value set in the global variable.</p>

<p class=MsoNormal>Having a function as a separate mini-program that doesn’t
use global variables makes it easier to find bugs in your code, since the parameters
of the function are clearly known. It also makes changing the code in a
function easier, since if the new function works with the same parameters and
gives the same return value, it will automatically work with the rest of the
program just like the old function.</p>

<p class=MsoNormal>Basically, using global variables might make it easier to
write your program but they generally make it harder to debug.</p>

<p class=MsoNormal>In the games in this book, global variables are mostly used
for variables that would be global constants that never change, but need the <span
class=Literal>pygame.init()</span> function called first. Since this happens in
the <span class=Literal>main()</span> function, they are set in the <span
class=Literal>main()</span> function and must be global for other functions to
see them. But the global variables are used as constants and don’t change, so
they are less likely to cause confusing bugs.</p>

<p class=MsoNormal>If you don’t understand this, don’t worry. Just write your
code so that you pass in values to functions rather than have the functions
read global variables as a general rule.</p>

<h2><a name="_Toc316488552">Data Structures and 2D Lists</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 58. </span>    mainBoard
= getRandomizedBoard()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 59. </span>    revealedBoxes
= generateRevealedBoxesData(False)</p>

</div>

<p class=MsoNormal>The <span class=Literal>getRandomizedBoard()</span> function
returns a data structure that represents the state of the board. The <span
class=Literal>generateRevealedBoxesData()</span> function returns a data
structure that represents which boxes are covered, respectively. The return
values of these functions are two dimensional (2D) lists, or lists of lists. A
list of lists of lists of values would be a 3D list. Another word for two or
more dimensional lists is a <span class=Definition>multidimensional</span>
list.</p>

<p class=MsoNormal>If we have a list value stored in a variable named <span
class=Literal>spam</span>, we could access a value in that list with the square
brackets, such as <span class=Literal>spam[2]</span> to retrieve the third
value in the list. If the value at <span class=Literal>spam[2]</span> is itself
a list, then we could use another set of square brackets to retrieve a value <em>in
that list</em>. This would look like, for example, <span class=Literal>spam[2][4]</span>,
which would retrieve the fifth value in the list that is the third value in <span
class=Literal>spam</span>. Using this notation of lists of lists makes it
easy to map a 2D board to a 2D list value. Since the <span class=Literal>mainBoard</span>
variable will store icons in it, if we wanted to get the icon on the board at
the position (4, 5) then we could just use the expression <span class=Literal>mainBoard[4][5]</span>.
Since the icons themselves are stored as two-item tuples with the shape and
color, the complete data structure is a list of list of two-item tuples. Whew!</p>

<p class=MsoNormal>Here’s an small example. Say the board looked like this:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=206
height=148 id="Picture 10" src="chapter3_files/image002.webp"></p>

<p class=MsoNormal>The corresponding data structure would be:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExample style='border:none;padding:0in'>mainBoard = [[(DONUT,
BLUE), (LINES, BLUE), (SQUARE, ORANGE)], [(SQUARE, GREEN), (DONUT, BLUE),
(DIAMOND, YELLOW)], [(SQUARE, GREEN), (OVAL, YELLOW), (SQUARE, ORANGE)],
[(DIAMOND, YELLOW), (LINES, BLUE), (OVAL, YELLOW)]]</p>

</div>

<p class=MsoNormal>(If your book is in black and white, you can see a color
version of the above picture at <span class=URL><a href="http://invpy.com/memoryboard">http://invpy.com/memoryboard</a></span>.)
You’ll notice that <span class=Literal>mainBoard[x][y]</span> will correspond
to the icon at the (x, y) coordinate on the board.</p>

<p class=MsoNormal>Meanwhile, the “revealed boxes” data structure is also a 2D
list, except instead of two-item tuples like the board data structure, it has
Boolean values: <span class=Literal>True</span> if the box at that x, y
coordinate is revealed, and <span class=Literal>False</span> if it is covered
up. Passing <span class=Literal>False</span> to the <span class=Literal>generateRevealedBoxesData()</span>
function sets all of the Boolean values to <span class=Literal>False</span>.
(This function is explained in detail later.)</p>

<p class=MsoNormal>These two data structures are used to keep track of the
state of the game board.</p>

<h2><a name="_Toc316488553">The “Start Game” Animation</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 61. </span>    firstSelection
= None <span class=SourceCodeComment># stores the (x, y) of the first box clicked.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span>    DISPLAYSURF.fill(BGCOLOR)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 64. </span>    startGameAnimation(mainBoard)</p>

</div>

<p class=MsoNormal>Line 61 sets up a variable called <span class=Literal>firstSelection</span>
with the value <span class=Literal>None</span>. (<span class=Literal>None</span>
is the value that represents a lack of a value. It is the only value of the
data type, <span class=Literal>NoneType</span>. More info at <span class=URL><a href="http://invpy.com/None">http://invpy.com/None</a></span>)
When the player clicks on an icon on the board, the program needs to track if
this was the first icon of the pair that was clicked on or the second icon. If <span
class=Literal>firstSelection</span> is <span class=Literal>None</span>, the
click was on the first icon and we store the XY coordinates in the <span
class=Literal>firstSelection</span> variable as a tuple of two integers (one
for the X value, the other for Y). On the second click the value will be this
tuple and not <span class=Literal>None</span>, which is how the program tracks
that it is the second icon click. Line 63 fills the entire surface with the
background color. This will also paint over anything that used to be on the
surface, which gives us a clean slate to start drawing graphics on.</p>

<p class=MsoNormal>If you’ve played the Memory Puzzle game, you’ll notice that
at the beginning of the game, all of the boxes are quickly covered and
uncovered randomly to give the player a sneak peek at which icons are under
which boxes. This all happens in the <span class=Literal>startGameAnimation()</span>
function, which is explained later in this chapter.</p>

<p class=MsoNormal>It’s important to give the player this sneak peek (but not
long enough of a peek to let the player easily memorize the icon locations),
because otherwise they would have no clue where any icons are. Blindly clicking
on the icons isn’t as much fun as having a little hint to go on.</p>

<h2><a name="_Toc316488554">The Game Loop</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 66. </span>    while
True: <span class=SourceCodeComment># main game loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67. </span>        mouseClicked
= False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69. </span>        DISPLAYSURF.fill(BGCOLOR)
<span class=SourceCodeComment># drawing the window</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 70. </span>        drawBoard(mainBoard,
revealedBoxes)</p>

</div>

<p class=MsoNormal>The game loop is an infinite loop that starts on line 66
that keeps iterating for as long as the game is in progress. Remember that the
game loop handles events, updates the game state, and draws the game state to
the screen.</p>

<p class=MsoNormal>The game state for the Memory Puzzle program is stored in
the following variables:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>mainBoard</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>revealedBoxes</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>firstSelection</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>mouseClicked</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>mousex</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
class=Literal><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class=Literal>mousey</span></p>

<p class=MsoNormal>On each iteration of the game loop in the Memory Puzzle
program, the <span class=Literal>mouseClicked</span> variable stores a Boolean
value that is <span class=Literal>True</span> if the player has clicked the
mouse during this iteration through the game loop. (This is part of keeping
track of the game state.)</p>

<p class=MsoNormal>On line 69, the surface is painted over with the background
color to erase anything that was previously drawn on it. The program then calls
<span class=Literal>drawBoard()</span> to draw the current state of the board
based on the board and “revealed boxes” data structures that we pass it. (These
lines of code are part of drawing and updating the screen.)</p>

<p class=MsoNormal>Remember that our drawing functions only draw on the
in-memory display Surface object. This Surface object will not actually appear
on the screen until we call <span class=Literal>pygame.display.update()</span>,
which is done at the end of the game loop on line 121.</p>

<h2><a name="_Toc316488555">The Event Handling Loop</a>                                                                                            
                                                  </h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 72. </span>        for
event in pygame.event.get(): <span class=SourceCodeComment># event handling
loop</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73. </span>            if
event.type == QUIT or (event.type == KEYUP and event.key == K_ESCAPE):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74. </span>                pygame.quit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75. </span>                sys.exit()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76. </span>            elif
event.type == MOUSEMOTION:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77. </span>                mousex,
mousey = event.pos</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78. </span>            elif
event.type == MOUSEBUTTONUP:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79. </span>                mousex,
mousey = event.pos</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 80. </span>                mouseClicked
= True</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 72 executes
code for every event that has happened since the last iteration of the game
loop. This loop is called the <span class=Definition>event handling loop</span>
(which is different from the game loop, although the event handling loop is
inside of the game loop) and iterates over the list of <span class=Literal>pygame.Event</span>
objects returned by the <span class=Literal>pygame.event.get()</span> call.</p>

<p class=MsoNormal>If the event object was a either a <span class=Literal>QUIT</span>
event or a <span class=Literal>KEYUP</span> event for the Esc key, then the
program should terminate. Otherwise, in the event of a <span class=Literal>MOUSEMOTION</span>
event (that is, the mouse cursor has moved) or <span class=Literal>MOUSEBUTTONUP</span>
event (that is, a mouse button was pressed earlier and now the button was let
up), the position of the mouse cursor should be stored in the <span
class=Literal>mousex</span> and <span class=Literal>mousey</span> variables. If
this was a <span class=Literal>MOUSEBUTTONUP</span> event, <span class=Literal>mouseClicked</span>
should also be set to <span class=Literal>True</span>.</p>

<p class=MsoNormal>Once we have handled all of the events, the values stored in
<span class=Literal>mousex</span>, <span class=Literal>mousey</span>, and <span
class=Literal>mouseClicked</span> will tell us any input that player has given
us. Now we should update the game state and draw the results to the screen.</p>

<h2><a name="_Toc316488556">Checking Which Box The Mouse Cursor is Over</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 82. </span>        boxx,
boxy = getBoxAtPixel(mousex, mousey)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83. </span>        if
boxx != None and boxy != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84. </span>            <span
class=SourceCodeComment># The mouse is currently over a box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85. </span>            if
not revealedBoxes[boxx][boxy]:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 86.</span>               
drawHighlightBox(boxx, boxy)</p>

</div>

<p class=MsoNormal>The <span class=Literal>getBoxAtPixel()</span> function will
return a tuple of two integers. The integers represent the XY board coordinates
of the box that the mouse coordinates are over. How <span class=Literal>getBoxAtPixel()</span>
does this is explained later. All we have to know for now is that if the <span
class=Literal>mousex</span> and <span class=Literal>mousey</span> coordinates
were over a box, a tuple of the XY board coordinates are returned by the
function and stored in <span class=Literal>boxx</span> and <span class=Literal>boxy</span>.
If the mouse cursor was not over any box (for example, if it was off to the
side of the board or in a gap in between boxes) then the tuple <span
class=Literal>(None, None)</span> is returned by the function and <span
class=Literal>boxx</span> and <span class=Literal>boxy</span> will both have <span
class=Literal>None</span> stored in them.</p>

<p class=MsoNormal>We are only interested in the case where <span
class=Literal>boxx</span> and <span class=Literal>boxy</span> do not have <span
class=Literal>None</span> in them, so the next several lines of code are in the
block following the <span class=Literal>if</span> statement on line 83 that
checks for this case. If execution has come inside this block, we know the user
has the mouse cursor over a box (and maybe has also clicked the mouse,
depending on the value stored in <span class=Literal>mouseClicked</span>).</p>

<p class=MsoNormal>The <span class=Literal>if</span> statement on line 85
checks if the box is covered up or not by reading the value stored in <span
class=Literal>revealedBoxes[boxx][boxy]</span>. If it is <span class=Literal>False</span>,
then we know the box is covered. Whenever the mouse is over a covered up box,
we want to draw a blue highlight around the box to inform the player that they
can click on it. This highlighting is not done for boxes that are already
uncovered. The highlight drawing is handled by our <span class=Literal>drawHighlightBox()</span>
function, which is explained later.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 87. </span>            if
not revealedBoxes[boxx][boxy] and mouseClicked:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 88. </span>                revealBoxesAnimation(mainBoard,
[(boxx, boxy)])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 89. </span>                revealedBoxes[boxx][boxy]
= True <span class=SourceCodeComment># set the box as &quot;revealed&quot;</span></p>

</div>

<p class=MsoNormal>On line 87, we check if the mouse cursor is not only over a
covered up box but if the mouse has also been clicked. In that case, we want to
play the “reveal” animation for that box by calling our <span class=Literal>revealBoxesAnimation()</span>
function (which is, as with all the other functions <span class=Literal>main()</span>
calls, explained later in this chapter). You should note that calling this
function only draws the animation of the box being uncovered. It isn’t until
line 89 when we set <span class=Literal>revealedBoxes[boxx][boxy] = True</span>
that the data structure that tracks the game state is updated.</p>

<p class=MsoNormal>If you comment out line 89 and then run the program, you’ll
notice that after clicking on a box the reveal animation is played, but then
the box immediately appears covered up again. This is because <span
class=Literal>revealedBoxes[boxx][boxy]</span> is still set to <span
class=Literal>False</span>, so on the next iteration of the game loop, the
board is drawn with this box covered up. Not having line 89 would cause quite
an odd bug in our program.</p>

<h2><a name="_Toc316488557">Handling the First Clicked Box</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 90. </span>                if
firstSelection == None: <span class=SourceCodeComment># the current box was the
first box clicked</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 91. </span>                    firstSelection
= (boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92. </span>                else:
<span class=SourceCodeComment># the current box was the second box clicked</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 93. </span>                    <span
class=SourceCodeComment># Check if there is a match between the two icons.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 94. </span>                    icon1shape,
icon1color = getShapeAndColor(mainBoard, firstSelection[0], firstSelection[1])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 95. </span>                    icon2shape,
icon2color = getShapeAndColor(mainBoard, boxx, boxy)</p>

</div>

<p class=MsoNormal>Before the execution entered the game loop, the <span
class=Literal>firstSelection</span> variable was set to <span class=Literal>None</span>.
Our program will interpret this to mean that no boxes have been clicked, so if
line 90’s condition is <span class=Literal>True</span>, that means this is the
first of the two possibly matching boxes that was clicked. We want to play the
reveal animation for the box and then keep that box uncovered. We also set the <span
class=Literal>firstSelection</span> variable to a tuple of the box coordinates
for the box that was clicked.</p>

<p class=MsoNormal>If this is the second box the player has clicked on, we want
to play the reveal animation for that box but then check if the two icons under
the boxes are matching. The <span class=Literal>getShapeAndColor()</span>
function (explained later) will retrieve the shape and color values of the
icons. (These values will be one of the values in the <span class=Literal>ALLCOLORS</span>
and <span class=Literal>ALLSHAPES</span> tuples.)</p>

<h2><a name="_Toc316488558">Handling a Mismatched Pair of Icons</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 97. </span>                    if
icon1shape != icon2shape or icon1color != icon2color:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98. </span>                        <span
class=SourceCodeComment># Icons don't match. Re-cover up both selections.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 99. </span>                        pygame.time.wait(1000)
<span class=SourceCodeComment># 1000 milliseconds = 1 sec</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100. </span>                        coverBoxesAnimation(mainBoard,
[(firstSelection[0], firstSelection[1]), (boxx, boxy)])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101. </span>                        revealedBoxes[firstSelection[0]][firstSelection
[1]] = False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>102. </span>                        revealedBoxes[boxx][boxy]
= False</p>

</div>

<p class=MsoNormal>The <span class=Literal>if</span> statement on line 97
checks if either the shapes or colors of the two icons don’t match. If this is
the case, then we want to pause the game for 1000 milliseconds (which is the
same as 1 second) by calling <span class=Literal>pygame.time.wait(1000)</span> so
that the player has a chance to see that the two icons don’t match. Then the
“cover up” animation plays for both boxes. We also want to update the game
state to mark these boxes as not revealed (that is, covered up).</p>

<h2><a name="_Toc316488559">Handling If the Player Won</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>103. </span>                    elif
hasWon(revealedBoxes): <span class=SourceCodeComment># check if all pairs found</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>104. </span>                        gameWonAnimation(mainBoard)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105. </span>                        pygame.time.wait(2000)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107. </span>                        <span
class=SourceCodeComment># Reset the board</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>108. </span>                        mainBoard
= getRandomizedBoard()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>109. </span>                        revealedBoxes
= generateRevealedBoxesData(False)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111. </span>                        <span
class=SourceCodeComment># Show the fully unrevealed board for a second.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112. </span>                        drawBoard(mainBoard,
revealedBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113. </span>                        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114. </span>                        pygame.time.wait(1000)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span>                        <span
class=SourceCodeComment># Replay the start game animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117. </span>                        startGameAnimation(mainBoard)            </p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>118. </span>                    firstSelection
= None <span class=SourceCodeComment># reset firstSelection variable</span></p>

</div>

<p class=MsoNormal>Otherwise, if line 97’s condition was <span class=Literal>False</span>,
then the two icons must be a match. The program doesn’t really have to do
anything else to the boxes at that point: it can just leave both boxes in the
revealed state. However, the program should check if this was the last pair of
icons on the board to be matched. This is done inside our <span class=Literal>hasWon()</span>
function, which returns <span class=Literal>True</span> if the board is in a
winning state (that is, all of the boxes are revealed). </p>

<p class=MsoNormal>If that is the case, we want to play the “game won”
animation by calling <span class=Literal>gameWonAnimation()</span>, then pause
slightly to let the player revel in their victory, and then reset the data
structures in <span class=Literal>mainBoard</span> and <span class=Literal>revealedBoxes</span>
to start a new game.</p>

<p class=MsoNormal>Line 117 plays the “start game” animation again. After that,
the program execution will just loop through the game loop as usual, and the
player can continue playing until they quit the program.</p>

<p class=MsoNormal>No matter if the two boxes were matching or not, after the
second box was clicked line 118 will set the <span class=Literal>firstSelection</span>
variable back to <span class=Literal>None</span> so that the next box the
player clicks on will be interpreted as the first clicked box of a pair of
possibly matching icons.</p>

<h2><a name="_Toc316488560">Drawing the Game State to the Screen</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>120. </span>        <span
class=SourceCodeComment># Redraw the screen and wait a clock tick.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>122. </span>        FPSCLOCK.tick(FPS)</p>

</div>

<p class=MsoNormal>At this point, the game state has been updated depending on
the player’s input, and the latest game state has been drawn to the <span
class=Literal>DISPLAYSURF</span> display Surface object. We’ve reached the end
of the game loop, so we call <span class=Literal>pygame.display.update()</span>
to draw the <span class=Literal>DISPLAYSURF</span> Surface object to the computer
screen.</p>

<p class=MsoNormal>Line 9 set the FPS constant to the integer value <span
class=Literal>30</span>, meaning we want the game to run (at most) at 30 frames
per second. If we want the program to run faster, we can increase this number.
If we want the program to run slower, we can decrease this number. It can even
be set to a float value like <span class=Literal>0.5</span>, which will run the
program at half a frame per second, that is, one frame per two seconds.</p>

<p class=MsoNormal>In order to run at 30 frames per second, each frame must be
drawn in 1/30<sup>th</sup> of a second. This means that <span class=Literal>pygame.display.update()</span>
and all the code in the game loop must execute in under 33.3 milliseconds. Any
modern computer can do this easily with plenty of time left over. To prevent
the program from running too fast, we call the <span class=Literal>tick()</span>
method of the <span class=Literal>pygame.Clock</span> object in <span
class=Literal>FPSCLOCK</span> to have to it pause the program for the rest of
the 33.3 milliseconds.</p>

<p class=MsoNormal>Since this is done at the very end of the game loop, it
ensures that each iteration of the game loop takes (at least) 33.3
milliseconds. If for some reason the <span class=Literal>pygame.display.update()</span>
call and the code in the game loop takes longer than 33.3 milliseconds, then
the <span class=Literal>tick()</span> method will not wait at all and
immediately return.</p>

<p class=MsoNormal>I’ve kept saying that the other functions would be explained
later in the chapter. Now that we’ve gone over the <span class=Literal>main()</span>
function and you have an idea for how the general program works, let’s go into
the details of all the other functions that are called from <span
class=Literal>main()</span>.</p>

<h2><a name="_Toc316488561">Creating the “Revealed Boxes” Data Structure</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>125. </span>def
generateRevealedBoxesData(val):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126. </span>    revealedBoxes
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127. </span>    for
i in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128. </span>        revealedBoxes.append([val]
* BOARDHEIGHT)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>129. </span>    return
revealedBoxes</p>

</div>

<p class=MsoNormal>The <span class=Literal>generateRevealedBoxesData()</span> function
needs to create a list of lists of Boolean values. The Boolean value will just
be the one that is passed to the function as the <span class=Literal>val</span>
parameter. We start the data structure as an empty list in the <span
class=Literal>revealedBoxes</span> variable.</p>

<p class=MsoNormal>In order to make the data structure have the <span
class=Literal>revealedBoxes[x][y]</span> structure, we need to make sure that
the inner lists represent the vertical columns of the board and not the
horizontal rows. Otherwise, the data structure will have a <span class=Literal>revealedBoxes[y][x]</span>
structure.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop will create the
columns and then append them to <span class=Literal>revealedBoxes</span>. The
columns are created using list replication, so that the column list has as many
<span class=Literal>val</span> values as the <span class=Literal>BOARDHEIGHT</span>
dictates.</p>

<h2><a name="_Toc316488562">Creating the Board Data Structure: Step 1 – Get All
Possible Icons</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>132. </span>def
getRandomizedBoard():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133. </span>    <span
class=SourceCodeComment># Get a list of every possible shape in every possible
color.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>134. </span>    icons
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>135. </span>    for
color in ALLCOLORS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>136. </span>        for
shape in ALLSHAPES:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>137. </span>            icons.append(
(shape, color) )</p>

</div>

<p class=MsoNormal>The board data structure is just a list of lists of tuples,
where each tuple has a two values: one for the icon’s shape and one for the icon’s
color. But creating this data structure is a little complicated. We need to be
sure to have exactly as many icons for the number of boxes on the board and
also be sure there are two and only two icons of each type.</p>

<p class=MsoNormal>The first step to do this is to create a list with every
possible combination of shape and color. Recall that we have a list of each
color and shape in <span class=Literal>ALLCOLORS</span> and <span
class=Literal>ALLSHAPES</span>, so nested <span class=Literal>for</span> loops on
lines 135 and 136 will go through every possible shape for every possible
color. These are each added to the list in the <span class=Literal>icons</span>
variable on line 137.</p>

<h2><a name="_Toc316488563">Step 2 – Shuffling and Truncating the List of All
Icons</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>139. </span>    random.shuffle(icons)
<span class=SourceCodeComment># randomize the order of the icons list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140. </span>    numIconsUsed
= int(BOARDWIDTH * BOARDHEIGHT / 2) <span class=SourceCodeComment># calculate
how many icons are needed</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141. </span>    icons
= icons[:numIconsUsed] * 2 <span class=SourceCodeComment># make two of each</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>142. </span>    random.shuffle(icons)</p>

</div>

<p class=MsoNormal>But remember, there may be more possible combinations than
spaces on the board. We need to calculate the number of spaces on the board by
multiplying <span class=Literal>BOARDWIDTH</span> by <span class=Literal>BOARDHEIGHT</span>.
Then we divide that number by 2 because we will have pairs of icons. On a board
with 70 spaces, we’d only need 35 different icons, since there will be two of
each icon. This number will be stored in <span class=Literal>numIconsUsed</span>.</p>

<p class=MsoNormal>Line 141 uses list slicing to grab the first <span
class=Literal>numIconsUsed</span> number of icons in the list. (If you’ve
forgotten how list slicing works, check out <span class=URL><a href="http://invpy.com/slicing">http://invpy.com/slicing</a></span>.)
This list has been shuffled on line 139, so it won’t always be the same icons
each game. Then this list is replicated by using the <span class=Literal>*</span>
operator so that there are two of each of the icons. This new doubled up list
will overwrite the old list in the <span class=Literal>icons</span> variable.
Since the first half of this new list is identical to the last half, we call
the <span class=Literal>shuffle()</span> method again to randomly mix up the
order of the icons.</p>

<h2><a name="_Toc316488564">Step 3 – Placing the Icons on the Board</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>144. </span>    <span
class=SourceCodeComment># Create the board data structure, with randomly placed
icons.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145. </span>    board
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146. </span>    for
x in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147. </span>        column
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148. </span>        for
y in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149. </span>            column.append(icons[0])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150. </span>            del
icons[0] <span class=SourceCodeComment># remove the icons as we assign them</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151. </span>        board.append(column)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>152. </span>    return
board</p>

</div>

<p class=MsoNormal>Now we need to create a list of lists data structure for the
board. We can do this with nested <span class=Literal>for</span> loops just
like the <span class=Literal>generateRevealedBoxesData()</span> function did. For
each column on the board, we will create a list of randomly selected icons. As
we add icons to the column, on line 149 we will then delete them from the front
of the <span class=Literal>icons</span> list on line 150. This way, as the <span
class=Literal>icons</span> list gets shorter and shorter, <span class=Literal>icons[0]</span>
will have a different icon to add to the columns.</p>

<p class=MsoNormal>To picture this better, type the following code into the
interactive shell. Notice how the <span class=Literal>del</span> statement
changes the <span class=Literal>myList</span> list.</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
myList = ['cat', 'dog', 'mouse', 'lizard']</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; del
myList[0]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
myList</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>['dog', 'mouse',
'lizard']</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; del
myList[0]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
myList</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>['mouse',
'lizard']</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; del
myList[0]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
myList</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>['lizard']</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt; del
myList[0]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
myList</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>[]</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Because we are deleting the item at the front of the list,
the other items shift forward so that the next item in the list becomes the new
“first” item. This is the same way line 150 works.</p>

<h2><a name="_Toc316488565">Splitting a List into a List of Lists</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>155. </span>def
splitIntoGroupsOf(groupSize, theList):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156. </span>    <span
class=SourceCodeComment># splits a list into a list of lists, where the inner
lists have at</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157. </span>    <span
class=SourceCodeComment># most groupSize number of items.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158. </span>    result
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159. </span>    for
i in range(0, len(theList), groupSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160. </span>        result.append(theList[i:i
+ groupSize])</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>161. </span>    return
result</p>

</div>

<p class=MsoNormal>The <span class=Literal>splitIntoGroupsOf()</span> function (which
will be called by the <span class=Literal>startGameAnimation()</span> function)
splits a list into a list of lists, where the inner lists have <span
class=Literal>groupSize</span> number of items in them. (The last list could
have less if there are less than <span class=Literal>groupSize</span> items
left over.)</p>

<p class=MsoNormal>The call to <span class=Literal>range()</span> on line 159
uses the three-parameter form of <span class=Literal>range()</span>. (If you
are unfamiliar with this form, take a look at <span class=URL><a href="http://invpy.com/range">http://invpy.com/range</a></span>.)
Let’s use an example. If the length of the list is <span class=Literal>20</span>
and the <span class=Literal>groupSize</span> parameter is <span class=Literal>8</span>,
then <span class=Literal>range(0, len(theList), groupSize)</span> evaluates to <span
class=Literal>range(0, 20, 8)</span>. This will give the <span class=Literal>i</span>
variable the values <span class=Literal>0</span>, <span class=Literal>8</span>,
and <span class=Literal>16</span> for the three iterations of the <span
class=Literal>for</span> loop.</p>

<p class=MsoNormal>The list slicing on line 160 with <span class=Literal>theList[i:i
+ groupSize]</span> creates the lists that are added to the <span
class=Literal>result</span> list. On each iteration where <span class=Literal>i</span>
is <span class=Literal>0</span>, <span class=Literal>8</span>, and <span
class=Literal>16</span> (and <span class=Literal>groupSize</span> is <span
class=Literal>8</span>), this list slicing expression would be <span
class=Literal>theList[0:8]</span>, then <span class=Literal>theList[8:16]</span>
on the second iteration, and then <span class=Literal>theList[16:24]</span> on
the third iteration.</p>

<p class=MsoNormal>Note that even though the largest index of <span
class=Literal>theList</span> would be <span class=Literal>19</span> in our
example, <span class=Literal>theList[16:24]</span> won’t raise an <span
class=Literal>IndexError</span> error even though <span class=Literal>24</span>
is larger than <span class=Literal>19</span>. It will just create a list slice
with the remaining items in the list. List slicing doesn’t destroy or change the
original list stored in <span class=Literal>theList</span>. It just copies a portion
of it to evaluate to a new list value. This new list value is the list that is
appended to the list in the <span class=Literal>result</span> variable on line
160. So when we return <span class=Literal>result</span> at the end of this
function, we are returning a list of lists.</p>

<h2><a name="_Toc316488566">Different Coordinate Systems</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>164. </span>def
leftTopCoordsOfBox(boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165. </span>    <span
class=SourceCodeComment># Convert board coordinates to pixel coordinates</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166. </span>    left
= boxx * (BOXSIZE + GAPSIZE) + XMARGIN</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>167. </span>    top
= boxy * (BOXSIZE + GAPSIZE) + YMARGIN</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>168. </span>    return
(left, top)</p>

</div>

<p class=MsoNormal>You should be familiar with Cartesian Coordinate systems. (If
you’d like a refresher on this topic, read <span class=URL><a href="http://invpy.com/coordinates">http://invpy.com/coordinates</a></span>.)
In most of our games we will be using multiple Cartesian Coordinate systems.
One system of coordinates that is used in the Memory Puzzle game is for the pixel
or screen coordinates. But we will also be using another coordinate system for
the boxes. This is because it will be easier to use (3, 2) to refer to the 4<sup>th</sup>
box from the left and 3<sup>rd</sup> from the top (remember that the numbers
start with 0, not 1) instead of using the pixel coordinate of the box’s top
left corner, (220, 165). However, we need a way to translate between these two
coordinate systems.</p>

<p class=MsoNormal>Here’s a picture of the game and the two different coordinate
systems. Remember that the window is 640 pixels wide and 480 pixels tall, so
(639, 479) is the bottom right corner (because the top left corner’s pixel is
(0, 0), and not (1, 1)).</p>

<p class=MsoNormal align=center style='text-align:center'><img width=366
height=316 id="Picture 16" src="chapter3_files/image003.webp"></p>

<p class=MsoNormal>The <span class=Literal>leftTopCoordsOfBox()</span> function
will take box coordinates and return pixel coordinates. Because a box takes up
multiple pixels on the screen, we will always return the single pixel at the
top left corner of the box. This value will be returned as a two-integer tuple.
The <span class=Literal>leftTopCoordsOfBox()</span> function will often be used
when we need pixel coordinates for drawing these boxes.</p>

<h2><a name="_Toc316488567">Converting from Pixel Coordinates to Box
Coordinates</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>171. </span>def
getBoxAtPixel(x, y):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>172. </span>    for
boxx in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>173. </span>        for
boxy in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>174. </span>            left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>175. </span>            boxRect
= pygame.Rect(left, top, BOXSIZE, BOXSIZE)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>176. </span>            if
boxRect.collidepoint(x, y):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>177. </span>                return
(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>178. </span>    return
(None, None)</p>

</div>

<p class=MsoNormal>We will also need a function to convert from pixel
coordinates (which the mouse clicks and mouse movement events use) to box
coordinates (so we can find out over which box the mouse event happened). Rect
objects have a <span class=Literal>collidepoint()</span> method that you can
pass X and Y coordinates too and it will return <span class=Literal>True</span>
if the coordinates are inside (that is, collide with) the Rect object’s area.</p>

<p class=MsoNormal>In order to find which box the mouse coordinates are over,
we will go through each box’s coordinates and call the <span class=Literal>collidepoint()</span>
method on a Rect object with those coordinates. When <span class=Literal>collidepoint()</span>
returns <span class=Literal>True</span>, we know we have found the box that was
clicked on or moved over and will return the box coordinates. If none of them
return <span class=Literal>True</span>, then the <span class=Literal>getBoxAtPixel()</span>
function will return the value <span class=Literal>(None, None)</span>. This
tuple is returned instead of simply returning <span class=Literal>None</span>
because the caller of <span class=Literal>getBoxAtPixel()</span> is expecting a
tuple of two values to be returned.</p>

<h2><a name="_Toc316488568">Drawing the Icon, and Syntactic Sugar</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>181. </span>def
drawIcon(shape, color, boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>182. </span>    quarter
= int(BOXSIZE * 0.25) <span class=SourceCodeComment># syntactic sugar</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>183. </span>    half
=    int(BOXSIZE * 0.5)  <span class=SourceCodeComment># syntactic sugar</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>184. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>185. </span>    left,
top = leftTopCoordsOfBox(boxx, boxy) <span class=SourceCodeComment># get pixel
coords from board coords</span></p>

</div>

<p class=MsoNormal>The <span class=Literal>drawIcon()</span> function will draw
an icon (with the specified <span class=Literal>shape</span> and <span
class=Literal>color</span>) at the space whose coordinates are given in the <span
class=Literal>boxx</span> and <span class=Literal>boxy</span> parameters. Each
possible shape has a different set of Pygame drawing function calls for it, so
we must have a large set of <span class=Literal>if</span> and <span
class=Literal>elif</span> statements to differentiate between them. (These
statements are on lines 187 to 198.)</p>

<p class=MsoNormal>The X and Y coordinates of the left and top edge of the box
can be obtained by calling the <span class=Literal>leftTopCoordsOfBox()</span>
function. The width and height of the box are both set in the <span
class=Literal>BOXSIZE</span> constant. However, many of the shape drawing
function calls use the midpoint and quarter-point of the box as well. We can
calculate this and store it in the variables <span class=Literal>quarter</span>
and <span class=Literal>half</span>. We could just as easily have the code <span
class=Literal>int(BOXSIZE * 0.25)</span> instead of the variable <span
class=Literal>quarter</span>, but this way the code becomes easier to read
since it is more obvious what <span class=Literal>quarter</span> means rather
than <span class=Literal>int(BOXSIZE * 0.25)</span>.</p>

<p class=MsoNormal>Such variables are an example of syntactic sugar. <span
class=Definition>Syntactic sugar</span> is when we add code that could have
been written in another way (probably with less actual code and variables), but
does make the source code easier to read. Constant variables are one form of
syntactic sugar. Pre-calculating a value and storing it in a variable is
another type of syntactic sugar. (For example, in the <span class=Literal>getRandomizedBoard()</span>
function, we could have easily made the code on lines 140 and line 141 into a
single line of code. But it’s easier to read as two separate lines.) We don’t
need to have the extra <span class=Literal>quarter</span> and <span
class=Literal>half</span> variables, but having them makes the code easier to
read. Code that is easy to read is easy to debug and upgrade in the future.</p>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>186. </span>    <span
class=SourceCodeComment># Draw the shapes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187. </span>    if
shape == DONUT:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>188. </span>        pygame.draw.circle(DISPLAYSURF,
color, (left + half, top + half), half - 5)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>189. </span>        pygame.draw.circle(DISPLAYSURF,
BGCOLOR, (left + half, top + half), quarter - 5)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>190. </span>    elif
shape == SQUARE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>191. </span>        pygame.draw.rect(DISPLAYSURF,
color, (left + quarter, top + quarter, BOXSIZE - half, BOXSIZE - half))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>192. </span>    elif
shape == DIAMOND:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>193. </span>        pygame.draw.polygon(DISPLAYSURF,
color, ((left + half, top), (left + BOXSIZE - 1, top + half), (left + half, top
+ BOXSIZE - 1), (left, top + half)))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>194. </span>    elif
shape == LINES:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>195. </span>        for
i in range(0, BOXSIZE, 4):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>196. </span>            pygame.draw.line(DISPLAYSURF,
color, (left, top + i), (left + i, top))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>197. </span>            pygame.draw.line(DISPLAYSURF,
color, (left + i, top + BOXSIZE - 1), (left + BOXSIZE - 1, top + i))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span>    elif
shape == OVAL:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>199. </span>        pygame.draw.ellipse(DISPLAYSURF,
color, (left, top + quarter, BOXSIZE, half))</p>

</div>

<p class=MsoNormal>Each of the donut, square, diamond, lines, and oval
functions require different drawing primitive function calls to make. </p>

<h2><a name="_Toc316488569">Syntactic Sugar with Getting a Board Space’s Icon’s
Shape and Color</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>202. </span>def
getShapeAndColor(board, boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>203. </span>    <span
class=SourceCodeComment># shape value for x, y spot is stored in board[x][y][0]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>204. </span>    <span
class=SourceCodeComment># color value for x, y spot is stored in board[x][y][1]</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>205. </span>    return
board[boxx][boxy][0], board[boxx][boxy][1]</p>

</div>

<p class=MsoNormal>The <span class=Literal>getShapeAndColor()</span> function
only has one line. You might wonder why we would want a function instead of
just typing in that one line of code whenever we need it. This is done for the
same reason we use constant variables: it improves the readability of the code.</p>

<p class=MsoNormal>It’s easy to figure out what a code like <span
class=Literal>shape, color = getShapeAndColor()</span> does. But if you looked
a code like <span class=Literal>shape, color = board[boxx][boxy][0],
board[boxx][boxy][1]</span>, it would be a bit more difficult to figure out.</p>

<h2><a name="_Toc316488570">Drawing the Box Cover</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>208. </span>def
drawBoxCovers(board, boxes, coverage):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>209. </span>    <span
class=SourceCodeComment># Draws boxes being covered/revealed. &quot;boxes&quot;
is a list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>210. </span>    <span
class=SourceCodeComment># of two-item lists, which have the x &amp; y spot of
the box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>211. </span>    for
box in boxes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>212. </span>        left,
top = leftTopCoordsOfBox(box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>213. </span>        pygame.draw.rect(DISPLAYSURF,
BGCOLOR, (left, top, BOXSIZE, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>214. </span>        shape,
color = getShapeAndColor(board, box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>215. </span>        drawIcon(shape,
color, box[0], box[1])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216. </span>        if
coverage &gt; 0: <span class=SourceCodeComment># only draw the cover if there
is an coverage</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>217. </span>            pygame.draw.rect(DISPLAYSURF,
BOXCOLOR, (left, top, coverage, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>218. </span>    pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>219. </span>    FPSCLOCK.tick(FPS)</p>

</div>

<p class=MsoNormal>The <span class=Literal>drawBoxCovers()</span> function has
three parameters: the board data structure, a list of (X, Y) tuples for each
box that should have the cover drawn, and then the amount of coverage to draw
for the boxes.</p>

<p class=MsoNormal>Since we want to use the same drawing code for each box in
the <span class=Literal>boxes</span> parameter, we will use a <span
class=Literal>for</span> loop on line 211 so we execute the same code on each
box in the <span class=Literal>boxes</span> list. Inside this <span
class=Literal>for</span> loop, the code should do three things: draw the
background color (to paint over anything that was there before), draw the icon,
then draw however much of the white box over the icon that is needed. The <span
class=Literal>leftTopCoordsOfBox()</span> function will return the pixel
coordinates of the top left corner of the box. The <span class=Literal>if</span>
statement on line 216 makes sure that if the number in <span class=Literal>coverage</span>
happens to be less than <span class=Literal>0</span>, we won’t call the <span
class=Literal>pygame.draw.rect()</span> function.</p>

<p class=MsoNormal>When the <span class=Literal>coverage</span> parameter is <span
class=Literal>0</span>, there is no coverage at all. When the <span
class=Literal>coverage</span> is set to <span class=Literal>20</span>, there is
a 20 pixel wide white box covering the icon. The largest size we’ll want the <span
class=Literal>coverage</span> set to is the number in <span class=Literal>BOXSIZE</span>,
where the entire icon is completely covered.</p>

<p class=MsoNormal><span class=Literal>drawBoxCovers()</span> is going to be
called from a separate loop than the game loop. Because of this, it needs to
have its own calls to <span class=Literal>pygame.display.update()</span> and <span
class=Literal>FPSCLOCK.tick(FPS)</span> to display the animation. (This does
mean that while inside this loop, there is no code being run to handle any
events being generated. That’s fine, since the cover and reveal animations only
take a second or so to play.)</p>

<h2><a name="_Toc316488571">Handling the Revealing and Covering Animation</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>222. </span>def
revealBoxesAnimation(board, boxesToReveal):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>223. </span>    <span
class=SourceCodeComment># Do the &quot;box reveal&quot; animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224. </span>    for
coverage in range(BOXSIZE, (-REVEALSPEED) - 1, - REVEALSPEED):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>225. </span>        drawBoxCovers(board,
boxesToReveal, coverage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>226. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>227. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228. </span>def
coverBoxesAnimation(board, boxesToCover):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229. </span>    <span
class=SourceCodeComment># Do the &quot;box cover&quot; animation.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230. </span>    for
coverage in range(0, BOXSIZE + REVEALSPEED, REVEALSPEED):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>231. </span>        drawBoxCovers(board,
boxesToCover, coverage)</p>

</div>

<p class=MsoNormal>Remember that an animation is simply just displaying
different images for brief moments of time, and together they make it seem like
things are moving on the screen. The <span class=Literal>revealBoxesAnimation()</span>
and <span class=Literal>coverBoxesAnimation()</span> only need to draw an icon
with a varying amount of coverage by the white box. We can write a single
function called <span class=Literal>drawBoxCovers()</span> which can do this,
and then have our animation function call <span class=Literal>drawBoxCovers()</span>
for each frame of animation. As we saw in the last section, <span
class=Literal>drawBoxCovers()</span> makes a call to <span class=Literal>pygame.display.update()</span>
and <span class=Literal>FPSCLOCK.tick(FPS)</span> itself.</p>

<p class=MsoNormal>To do this, we’ll set up a <span class=Literal>for</span>
loop to make decreasing (in the case of <span class=Literal>revealBoxesAnimation()</span>)
or increasing (in the case of <span class=Literal>coverBoxesAnimation()</span>)
numbers for the <span class=Literal>converage</span> parameter. The amount that
the <span class=Literal>coverage</span> variable will decrease/increase by is
the number in the <span class=Literal>REVEALSPEED</span> constant. On line 12
we set this constant to <span class=Literal>8</span>, meaning that on each call
to <span class=Literal>drawBoxCovers()</span>, the white box will
decrease/increase by 8 pixels on each iteration. If we increase this number,
then more pixels will be drawn on each call, meaning that the white box will
decrease/increase in size faster. If we set it to <span class=Literal>1</span>,
then the white box will only appear to decrease or increase by 1 pixel on each
iteration, making the entire reveal or cover animation take longer.</p>

<p class=MsoNormal>Think of it like climbing stairs. If on each step you take,
you climbed one stair, then it would take a normal amount of time to climb the
entire staircase. But if you climbed two stairs at a time on each step (and the
steps took just as long as before), you could climb the entire staircase twice
as fast. If you could climb the staircase 8 stairs at a time, then you would
climb the entire staircase 8 times as fast.</p>

<h2><a name="_Toc316488572">Drawing the Entire Board</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>234. </span>def
drawBoard(board, revealed):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235. </span>    <span
class=SourceCodeComment># Draws all of the boxes in their covered or revealed
state.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236. </span>    for
boxx in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>237. </span>        for
boxy in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>238. </span>            left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>239. </span>            if
not revealed[boxx][boxy]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>240. </span>                <span
class=SourceCodeComment># Draw a covered box.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>241. </span>                pygame.draw.rect(DISPLAYSURF,
BOXCOLOR, (left, top, BOXSIZE, BOXSIZE))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242. </span>            else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243. </span>                <span
class=SourceCodeComment># Draw the (revealed) icon.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244. </span>                shape,
color = getShapeAndColor(board, boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>245. </span>                drawIcon(shape,
color, boxx, boxy)</p>

</div>

<p class=MsoNormal>The <span class=Literal>drawBoard()</span> function makes a
call to <span class=Literal>drawIcon()</span> for each of the boxes on the
board. The nested <span class=Literal>for</span> loops on lines 236 and 237
will loop through every possible X and Y coordinate for the boxes, and will
either draw the icon at that location or draw a white square instead (to
represent a covered up box).</p>

<h2><a name="_Toc316488573">Drawing the Highlight</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>248. </span>def
drawHighlightBox(boxx, boxy):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249. </span>    left,
top = leftTopCoordsOfBox(boxx, boxy)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>250. </span>    pygame.draw.rect(DISPLAYSURF,
HIGHLIGHTCOLOR, (left - 5, top - 5, BOXSIZE + 10, BOXSIZE + 10), 4)</p>

</div>

<p class=MsoNormal>To help the player recognize that they can click on a
covered box to reveal it, we will make a blue outline appear around a box to
highlight it. This outline is drawn with a call to <span class=Literal>pygame.draw.rect()</span>
to make a rectangle with a width of 4 pixels.</p>

<h2><a name="_Toc316488574">The “Start Game” Animation</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>253. </span>def
startGameAnimation(board):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>254. </span>    <span
class=SourceCodeComment># Randomly reveal the boxes 8 at a time.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>255. </span>    coveredBoxes
= generateRevealedBoxesData(False)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>256. </span>    boxes
= []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257. </span>    for
x in range(BOARDWIDTH):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258. </span>        for
y in range(BOARDHEIGHT):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>259. </span>            boxes.append(
(x, y) )</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>260. </span>    random.shuffle(boxes)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>261. </span>    boxGroups
= splitIntoGroupsOf(8, boxes)</p>

</div>

<p class=MsoNormal>The animation that plays at the beginning of the game gives
the player a quick hint as to where all the icons are located. In order to make
this animation, we have to reveal and cover up groups of boxes one group after
another. To do this, first we’ll create a list of every possible space on the
board. The nested <span class=Literal>for</span> loops on lines 257 and 258 will
add (X, Y) tuples to a list in the <span class=Literal>boxes</span> variable.</p>

<p class=MsoNormal>We will reveal and cover up the first 8 boxes in this list,
then the next 8, then the next 8 after that, and so on. However, since the order
of the (X, Y) tuples in boxes would be the same each time, then the same order
of boxes would be displayed. (Try commenting out line 260 and then running to
program a few times to see this effect.)</p>

<p class=MsoNormal>To change up the boxes each time a game starts, we will call
the <span class=Literal>random.shuffle()</span> function to randomly shuffle
the order of the tuples in the boxes list. Then when we reveal and cover up the
first 8 boxes in this list (and each group of 8 boxes afterwards), it will be
random group of 8 boxes.</p>

<p class=MsoNormal>To get the lists of 8 boxes, we call our <span
class=Literal>splitIntoGroupsOf()</span> function, passing <span class=Literal>8</span>
and the list in <span class=Literal>boxes</span>. The list of lists that the
function returns will be stored in a variable named <span class=Literal>boxGroups</span>.</p>

<h2><a name="_Toc316488575">Revealing and Covering the Groups of Boxes</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>263.</span>    
drawBoard(board, coveredBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>264. </span>    for
boxGroup in boxGroups:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>265. </span>        revealBoxesAnimation(board,
boxGroup)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>266. </span>        coverBoxesAnimation(board,
boxGroup)</p>

</div>

<p class=MsoNormal>First, we draw the board. Since every value in <span
class=Literal>coveredBoxes</span> is set to <span class=Literal>False</span>,
this call to <span class=Literal>drawBoard()</span> will end up drawing only
covered up white boxes. The <span class=Literal>revealBoxesAnimation()</span>
and <span class=Literal>coverBoxesAnimation()</span> functions will draw over the
spaces of these white boxes.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop will go through each
of the inner lists in the <span class=Literal>boxGroups</span> lists. We pass
these to <span class=Literal>revealBoxesAnimation()</span>, which will perform
the animation of the white boxes being pulled away to reveal the icon
underneath. Then the call to <span class=Literal>coverBoxesAnimation()</span>
will animate the white boxes expanding to cover up the icons. Then the <span
class=Literal>for</span> loop goes to the next iteration to animate the next
set of 8 boxes.</p>

<h2><a name="_Toc316488576">The “Game Won” Animation</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>269. </span>def
gameWonAnimation(board):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>270. </span>    <span
class=SourceCodeComment># flash the background color when the player has won</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>271. </span>    coveredBoxes
= generateRevealedBoxesData(True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>272. </span>    color1
= LIGHTBGCOLOR</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>273. </span>    color2
= BGCOLOR</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>274. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>275. </span>    for
i in range(13):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>276. </span>        color1,
color2 = color2, color1 <span class=SourceCodeComment># swap colors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>277. </span>        DISPLAYSURF.fill(color1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>278. </span>        drawBoard(board,
coveredBoxes)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>279. </span>        pygame.display.update()</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>280. </span>        pygame.time.wait(300)</p>

</div>

<p class=MsoNormal>When the player has uncovered all of the boxes by matching
every pair on the board, we want to congratulate them by flashing the
background color. The <span class=Literal>for</span> loop will draw the color
in the <span class=Literal>color1</span> variable for the background color and
then draw the board over it. However, on each iteration of the <span
class=Literal>for</span> loop, the values in <span class=Literal>color1</span>
and <span class=Literal>color2</span> will be swapped with each other on line
276. This way the program will alternate between drawing two different
background colors.</p>

<p class=MsoNormal>Remember that this function needs to call <span
class=Literal>pygame.display.update()</span> to actually make the <span
class=Literal>DISPLAYSURF</span> surface appear on the screen.</p>

<h2><a name="_Toc316488577">Telling if the Player Has Won</a></h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>283. </span>def
hasWon(revealedBoxes):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>284. </span>    <span
class=SourceCodeComment># Returns True if all the boxes have been revealed,
otherwise False</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>285. </span>    for
i in revealedBoxes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>286. </span>        if
False in i:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>287. </span>            return
False <span class=SourceCodeComment># return False if any boxes are covered.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>288. </span>    return
True</p>

</div>

<p class=MsoNormal>The player has won the game when all of the icon pairs have
been matched. Since the “revealed” data structure gets values in it set to <span
class=Literal>True</span> as icons have been matched, we can simply loop
through every space in <span class=Literal>revealedBoxes</span> looking for a <span
class=Literal>False</span> value. If even one <span class=Literal>False</span>
value is in <span class=Literal>revealedBoxes</span>, then we know there are
still unmatched icons on the board.</p>

<p class=MsoNormal>Note that because <span class=Literal>revealedBoxes</span>
is a list of lists, the <span class=Literal>for</span> loop on line 285 will
set the inner list as the values of <span class=Literal>i</span>. But we can
use the in operator to search for a <span class=Literal>False</span> value in
the entire inner list. This way we don’t need to write an additional line of
code and have two nested <span class=Literal>for</span> loops like this:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>for x in
revealedBoxes:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for y in
revealedBoxes[x]:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        if False
== revealedBoxes[x][y]:</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>            return
False</p>

</div>

<h2><a name="_Toc316488578">Why Bother Having a </a><span class=Literal>main()</span>
Function?</h2>

<div style='border:double windowtext 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>291. </span>if
__name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>292. </span>    main()</p>

</div>

<p class=MsoNormal>It may seem pointless to have a <span class=Literal>main()</span>
function, since you could just put that code in the global scope at the bottom
of the program instead, and the code would run the exact same. However, there
are two good reasons to put them inside of a <span class=Literal>main()</span>
function.</p>

<p class=MsoNormal>First, this lets you have local variables whereas otherwise
the local variables in the <span class=Literal>main()</span> function would
have to become global variables. Limiting the number of global variables is a
good way to keep the code simple and easier to debug. (See the “Why Global
Variables are Evil” section in this chapter.)</p>

<p class=MsoNormal>Second, this also lets you import the program so that you
can call and test individual functions. If the <em>memorypuzzle.py</em> file is
in the C:\Python32 folder, then you can import it from the interactive shell.
Type the following to test out the <span class=Literal>splitIntoGroupsOf()</span>
and <span class=Literal>getBoxAtPixel()</span> functions to make sure they
return the correct return values:</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import memorypuzzle</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
memorypuzzle.splitIntoGroupsOf(3, [0,1,2,3,4,5,6,7,8,9])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>[[0, 1, 2], [3,
4, 5], [6, 7, 8], [9]]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
memorypuzzle.getBoxAtPixel(0, 0)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>(None, None)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
memorypuzzle.getBoxAtPixel(150, 150)</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>(1, 1)</p>

</div>

<p class=MsoNormal>When a module is imported, all of the code in it is run. If
we didn’t have the <span class=Literal>main()</span> function, and had its code
in the global scope, then the game would have automatically started as soon as
we imported it, which really wouldn’t let us call individual functions in it.</p>

<p class=MsoNormal>That’s why the code is in a separate function that we have
named <span class=Literal>main()</span>. Then we check the built-in Python
variable <span class=Literal>__name__</span> to see if we should call the <span
class=Literal>main()</span> function or not. This variable is automatically set
by the Python interpreter to the string <span class=Literal>'__main__'</span>
if the program itself is being run and <span class=Literal>'memorypuzzle'</span>
if it is being imported. This is why the <span class=Literal>main()</span>
function is not run when we executed the <span class=Literal>import memorypuzzle</span>
statement in the interactive shell.</p>

<p class=MsoNormal>This is a handy technique for being able to import the
program you are working on from the interactive shell and make sure individual
functions are returning the correct values by testing them one call at a time.</p>

<h2><a name="_Toc316488579">Why Bother With Readability?</a></h2>

<p class=MsoNormal>A lot of the suggestions in this chapter haven’t been about
how to write programs that computers can run so much as how to write programs
that programmers can read. You might not understand why this is important.
After all, as long as the code works, who cares if it is hard or easy for human
programmers to read?</p>

<p class=MsoNormal>However, the important thing to realize about software is
that it is rarely ever left alone. When you are creating your own games, you
will rarely be “done” with the program. You will always get new ideas for game
features you want add, or find new bugs with the program. Because of this, it
is important that your program is readable so that you can look at the code and
understand it. And understanding the code is the first step to changing it to
add more code or fix bugs.</p>

<p class=MsoNormal>As an example, here is an obfuscated version of the Memory
Puzzle program that was made entirely unreadable. If you type it in (or
download it from <span class=URL><a href="http://invpy.com/memorypuzzle_obfuscated.py">http://invpy.com/memorypuzzle_obfuscated.py</a></span>)
and run it you will find it runs exactly the same as the code at the beginning
of this chapter. But if there was a bug with this code, it would be impossible
to read the code and understand what’s going on, much less fix the bug.</p>

<p class=MsoNormal>The computer doesn’t mind code as unreadable as this. It’s
all the same to it.</p>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt'>

<p class=CodeExampleCxSpFirst style='border:none;padding:0in'>import random,
pygame, sys</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>from
pygame.locals import *</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def hhh():</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    global a, b</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
pygame.init()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    a =
pygame.time.Clock()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    b =
pygame.display.set_mode((640, 480))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    j = 0</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    k = 0</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
pygame.display.set_caption('Memory Game')</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    i = c()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    hh =
d(False)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    h = None</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    b.fill((60,
60, 100))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    g(i)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    while True:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        e =
False</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
b.fill((60, 60, 100))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        f(i, hh)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for eee
in pygame.event.get():</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            if
eee.type == QUIT or (eee.type == KEYUP and eee.key == K_ESCAPE):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
pygame.quit()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
sys.exit()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            elif
eee.type == MOUSEMOTION:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
j, k = eee.pos</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            elif
eee.type == MOUSEBUTTONUP:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
j, k = eee.pos</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                e
= True</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        bb, ee =
m(j, k)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        if bb !=
None and ee != None:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            if
not hh[bb][ee]:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
n(bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            if
not hh[bb][ee] and e:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
o(i, [(bb, ee)])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
hh[bb][ee] = True</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                if
h == None:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
h = (bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
else:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
q, fff = s(i, h[0], h[1])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
r, ggg = s(i, bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
if q != r or fff != ggg:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
pygame.time.wait(1000)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                        p(i,
[(h[0], h[1]), (bb, ee)])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
hh[h[0]][h[1]] = False</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
hh[bb][ee] = False</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
elif ii(hh):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
jj(i)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
pygame.time.wait(2000)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                        i
= c()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
hh = d(False)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
f(i, hh)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
pygame.display.update()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
pygame.time.wait(1000)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                       
g(i)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>                   
h = None</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        pygame.display.update()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
a.tick(30)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def d(ccc):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    hh = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for i in
range(10):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
hh.append([ccc] * 7)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return hh</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def c():</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    rr = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for tt in
((255, 0, 0), (0, 255, 0), (0, 0, 255), (255, 255, 0), (255, 128, 0), (255, 0,
255), (0, 255, 255)):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for ss
in ('a', 'b', 'c', 'd', 'e'):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
rr.append( (ss, tt) )</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
random.shuffle(rr)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    rr = rr[:35]
* 2</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
random.shuffle(rr)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    bbb = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for x in
range(10):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        v = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for y in
range(7):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            v.append(rr[0])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            del
rr[0]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
bbb.append(v)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return bbb</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def t(vv, uu):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    ww = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for i in
range(0, len(uu), vv):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
ww.append(uu[i:i + vv])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return ww</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def aa(bb, ee):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return (bb *
50 + 70, ee * 50 + 65)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def m(x, y):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for bb in
range(10):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for ee
in range(7):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            oo,
ddd = aa(bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            aaa
= pygame.Rect(oo, ddd, 40, 40)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            if
aaa.collidepoint(x, y):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
return (bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return
(None, None)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def w(ss, tt,
bb, ee):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    oo, ddd =
aa(bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    if ss ==
'a':</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.circle(b, tt, (oo + 20, ddd + 20), 15)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.circle(b, (60, 60, 100), (oo + 20, ddd + 20), 5)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    elif ss ==
'b':</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.rect(b, tt, (oo + 10, ddd + 10, 20, 20))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    elif ss ==
'c':</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.polygon(b, tt, ((oo + 20, ddd), (oo + 40 - 1, ddd + 20), (oo + 20,
ddd + 40 - 1), (oo, ddd + 20)))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    elif ss ==
'd':</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for i in
range(0, 40, 4):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
pygame.draw.line(b, tt, (oo, ddd + i), (oo + i, ddd))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            pygame.draw.line(b,
tt, (oo + i, ddd + 39), (oo + 39, ddd + i))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    elif ss ==
'e':</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.ellipse(b, tt, (oo, ddd + 10, 40, 20))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def s(bbb, bb,
ee):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return
bbb[bb][ee][0], bbb[bb][ee][1]</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def dd(bbb,
boxes, gg):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for box in
boxes:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        oo, ddd
= aa(box[0], box[1])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.draw.rect(b, (60, 60, 100), (oo, ddd, 40, 40))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        ss, tt =
s(bbb, box[0], box[1])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        w(ss,
tt, box[0], box[1])</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        if gg
&gt; 0:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
pygame.draw.rect(b, (255, 255, 255), (oo, ddd, gg, 40))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
pygame.display.update()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    a.tick(30)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def o(bbb, cc):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for gg in
range(40, (-8) - 1, -8):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        dd(bbb,
cc, gg)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def p(bbb, ff):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for gg in
range(0, 48, 8):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        dd(bbb,
ff, gg)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def f(bbb, pp):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for bb in
range(10):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for ee
in range(7):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            oo,
ddd = aa(bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>            if
not pp[bb][ee]:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
pygame.draw.rect(b, (255, 255, 255), (oo, ddd, 40, 40))</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
else:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
ss, tt = s(bbb, bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>               
w(ss, tt, bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def n(bb, ee):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    oo, ddd =
aa(bb, ee)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
pygame.draw.rect(b, (0, 0, 255), (oo - 5, ddd - 5, 50, 50), 4)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def g(bbb):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    mm =
d(False)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    boxes = []</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for x in
range(10):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        for y in
range(7):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
boxes.append( (x, y) )</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>   
random.shuffle(boxes)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    kk = t(8, boxes)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    f(bbb, mm)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for nn in
kk:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        o(bbb,
nn)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        p(bbb,
nn)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def jj(bbb):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    mm = d(True)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    tt1 = (100,
100, 100)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    tt2 = (60,
60, 100)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for i in
range(13):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        tt1, tt2
= tt2, tt1</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
b.fill(tt1)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        f(bbb,
mm)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        pygame.display.update()</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>       
pygame.time.wait(300)</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>def ii(hh):</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    for i in hh:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>        if False
in i:</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>           
return False</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>    return True</p>

<p class=CodeExampleCxSpMiddle style='border:none;padding:0in'>if __name__ ==
'__main__':</p>

<p class=CodeExampleCxSpLast style='border:none;padding:0in'>    hhh()</p>

</div>

<p class=MsoNormal>Never write code like this. If you program like this while
facing the mirror in a bathroom with the lights turned off, the ghost of Ada
Lovelace will come out of the mirror and throw you into the jaws of a Jacquard
loom.</p>

<h2><a name="_Toc316488580">Summary, and a Hacking Suggestion</a></h2>

<p class=MsoNormal>This chapter covers the entire explanation of how the Memory
Puzzle program works. Read over the chapter and the source code again to
understand it better. Many of the other game programs in this book make use of
the same programming concepts (like nested <span class=Literal>for</span> loops,
syntactic sugar, and different coordinate systems in the same program) so they
won’t be explained again to keep this book short.</p>

<p class=MsoNormal>One idea to try out to understand how the code works is to
intentionally break it by commenting out random lines. Doing this to some of
the lines will probably cause a syntactic error that will prevent the script
from running at all. But commenting out other lines will result in weird bugs
and other cool effects. Try doing this and then figure out why a program has
the bugs it does.</p>

<p class=MsoNormal>This is also the first step in being able to add your own secret
cheats or hacks to the program. By breaking the program from what it normally
does, you can learn how to change it to do something neat effect (like secretly
giving you hints on how to solve the puzzle). Feel free to experiment. You can
always save a copy of the unchanged source code in a different file if you want
to play the regular game again.</p>

<p class=MsoNormal>In fact, if you’d like some practice fixing bugs, there are
several versions of this game’s source code that have small bugs in them. You
can download these buggy versions from <span class=URL><a href="http://invpy.com/buggy/memorypuzzle">http://invpy.com/buggy/memorypuzzle</a></span>.
Try running the program to figure out what the bug is, and why the program is
acting that way.</p>

</div>

</body>

</html>
