<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Chapter 13 - Sonar Treasure Hunt</title></head><body style="background-color: #fffeee;">

<script type="text/javascript">
//<![CDATA[

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-5459430-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

//]]>
</script>


<div style="background-color: #eeeddd; float: right; height: 310px; font-family: sans-serif;" id="otherbooks">
  <a href="#" onclick="document.getElementById('otherbooks').outerHTML='';" style="vertical-align: top;">(close)</a><br />

  <a target="_blank" href="https://nostarch.com/automatestuff2" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src="/images/cover_automate2_thumb.jpg" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/big-book-small-python-projects" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_bigbookpython.link');"><img src="/images/cover_bigbookpython_thumb.jpg" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/beyond-basic-stuff-python" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_beyond.link');"><img src="/images/cover_beyond_thumb.jpg" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/inventwithpython" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src="/images/cover_invent4th_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&amp;tag=playwithpyth-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1469901730" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src="/images/cover_makinggames_thumb.png" style="height: 200px; border: solid black 1px; /"></a>
  <a target="_blank" href="https://nostarch.com/crackingcodes" onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src="/images/cover_crackingcodes_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/scratchplayground"><img src="/images/cover_scratchprogrammingplayground_thumb.png" style="height: 200px; border: solid black 1px;" /></a>
  <a target="_blank" href="https://nostarch.com/codingwithminecraft"><img src="/images/cover_codingwithminecraft_thumb.jpg" style="height: 200px; border: solid black 1px;" /></a>
  <br />
  <a href="https://inventwithpython.com/automateudemy">Use this link to get 70% off the Automate the Boring Stuff online video course.</a><br />
  <a href="https://www.patreon.com/AlSweigart">Support me on Patreon</a>
</div>

<a href="chapter12.html">Prev: Chapter 12 - The Cartesian Coordinate System</a> | <a href="chapter14.html">Next: Chapter 14 - Caesar Cipher</a>



<div id="calibre_link-71" class="calibre">
<h2 class="h1" id="calibre_link-19"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-364" class="calibre1"></span><span class="big"><strong class="calibre2">13</strong></span><br class="calibre9" /><strong class="calibre2">SONAR TREASURE HUNT</strong></h2>
<div class="imagec"><img src="images/00016.jpeg" alt="image" class="calibre3" /></div>
<p class="noindent">The Sonar Treasure Hunt game in this chapter is the first to make use of the Cartesian coordinate system that you learned about in <a href="#calibre_link-72" class="calibre4">Chapter 12</a>. This game also uses data structures, which is just a fancy way of saying it has list values that contain other lists and similar complex variables. As the games you program become more complicated, you’ll need to organize your data into data structures.</p>
<p class="indent">In this chapter’s game, the player drops sonar devices at various places in the ocean to locate sunken treasure chests. <em class="calibre6">Sonar</em> is a technology that ships use to locate objects under the sea. The sonar devices in this game tell the player how far away the closest treasure chest is, but not in what direction. But by placing multiple sonar devices, the player can figure out the location of the treasure chest.</p>
<div class="sidebar">
<p class="sidebart"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-890" class="calibre1"></span><strong class="calibre2">TOPICS COVERED IN THIS CHAPTER</strong></p>
<p class="bull">• Data structures</p>
<p class="bull">• The Pythagorean theorem</p>
<p class="bull">• The <span class="literal1">remove()</span> list method</p>
<p class="bull">• The <span class="literal1">isdigit()</span> string method</p>
<p class="bull">• The <span class="literal1">sys.exit()</span> function</p>
</div>
<p class="indent">There are 3 chests to collect, and the player has only 20 sonar devices to use to find them. Imagine that you couldn’t see the treasure chest in <a href="#calibre_link-73" class="calibre4">Figure 13-1</a>. Because each sonar device can find only the distance from the chest, not the chest’s direction, the treasure could be anywhere on the ring around the sonar device.</p>
<div class="image"><img src="images/00047.jpeg" alt="image" class="calibre3" /></div>
<p class="figcap"><a id="calibre_link-73" class="calibre4"></a><em class="calibre6">Figure 13-1: The sonar device’s ring touches the (hidden) treasure chest.</em></p>
<p class="indent">But multiple sonar devices working together can narrow down the chest’s location to the exact coordinates where the rings intersect (see <a href="#calibre_link-74" class="calibre4">Figure 13-2</a>).</p>
<div class="image"><img src="images/00056.jpeg" alt="image" class="calibre3" /></div>
<p class="figcap"><a id="calibre_link-74" class="calibre4"></a><em class="calibre6">Figure 13-2: Combining multiple rings shows where treasure chests could be hidden.</em></p>
<h3 class="h2" id="calibre_link-607"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-373" class="calibre1"></span><strong class="calibre2">Sample Run of Sonar Treasure Hunt</strong></h3>
<p class="noindent">Here’s what the user sees when they run the Sonar Treasure Hunt program. The text the player enters is shown in bold.</p>
<p class="programs">S O N A R !<br class="calibre7" /><br class="calibre7" />Would you like to view the instructions? (yes/no)<br class="calibre7" /><span class="codestrong">no</span><br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" /><br class="calibre7" />&nbsp;0 ~`~``~``~``~`~`~```~`~``````~```~`~~~`~~```~~`~~~~~`~~`~~~~` 0<br class="calibre7" />&nbsp;1 ~~~~~`~~~~~````~``~~```~``~`~`~`~``~~```~~~`~`~```~~~~`~`~~` 1<br class="calibre7" />&nbsp;2 ```~````~``~`~`~~~``~~`````~~``~``~``~~```~~``~~`~~~````~~`~ 2<br class="calibre7" />&nbsp;3 `````~~``````~`~~~~~```~~``~~~`~`~~~~~~`````~`~```~~~``~``~` 3<br class="calibre7" />&nbsp;4 ~~~`~~~`~`~~~``~~~`~`~``~~~~``~~~~``~~~~`~`~``~~```~``~~`~`~ 4<br class="calibre7" />&nbsp;5 `~``~````~`~`~~``~~~~``````~```~~~~````````~``~~~`~~``~~```` 5<br class="calibre7" />&nbsp;6 ~`~```~~`~~```~````````~~```~```~~~~``~~~`~`~~`~``~~~`~~`~`` 6<br class="calibre7" />&nbsp;7 ~`~~~```~``~```~`~```~~~~~~~`~~`~`~~~~``~```~~~`~```~``~``~` 7<br class="calibre7" />&nbsp;8 `~``~~`~`~~`~~`~~``~```~````~`~```~``~````~~~````~~``~~``~~` 8<br class="calibre7" />&nbsp;9 ~`~``~~````~~```~`~~```~~`~``~`~~``~`~`~~~~`~`~~`~`~```~~``` 9<br class="calibre7" />10 `~~~~~~`~``~``~~~``~``~~~~`~``~```~`~~``~~~~~~``````~~`~``~~ 10<br class="calibre7" />11 ~``~~~````~`~~`~~~`~~~``~``````~`~``~~~~`````~~~``````~`~`~~ 11<br class="calibre7" />12 ~~~~~``~`~````~```~`~`~`~~`~~`~``~~~~~~~`~~```~~``~~`~~~~``` 12<br class="calibre7" />13 `~~```~~````````~~~`~~~```~~~~~~~~`~~``~~`~```~`~~````~~~``~ 13<br class="calibre7" />14 ```~``~`~`~``~```~`~``~`~``~~```~`~~~``~~``~```~`~~`~``````~ 14<br class="calibre7" /><br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />You have 20 sonar device(s) left. 3 treasure chest(s) remaining.<br class="calibre7" />Where do you want to drop the next sonar device? (0-59 0-14) (or type quit)<br class="calibre7" /><span class="codestrong">25 5</span><br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" /><br class="calibre7" />&nbsp;0 ~`~``~``~``~`~`~```~`~``````~```~`~~~`~~```~~`~~~~~`~~`~~~~` 0<br class="calibre7" />&nbsp;1 ~~~~~`~~~~~````~``~~```~``~`~`~`~``~~```~~~`~`~```~~~~`~`~~` 1<br class="calibre7" />&nbsp;2 ```~````~``~`~`~~~``~~`````~~``~``~``~~```~~``~~`~~~````~~`~ 2<br class="calibre7" />&nbsp;3 `````~~``````~`~~~~~```~~``~~~`~`~~~~~~`````~`~```~~~``~``~` 3<br class="calibre7" />&nbsp;4 ~~~`~~~`~`~~~``~~~`~`~``~~~~``~~~~``~~~~`~`~``~~```~``~~`~`~ 4<br class="calibre7" />&nbsp;5 `~``~````~`~`~~``~~~~````5`~```~~~~````````~``~~~`~~``~~```` 5<br class="calibre7" />&nbsp;6 ~`~```~~`~~```~````````~~```~```~~~~``~~~`~`~~`~``~~~`~~`~`` 6<br class="calibre7" />&nbsp;7 ~`~~~```~``~```~`~```~~~~~~~`~~`~`~~~~``~```~~~`~```~``~``~` 7<br class="calibre7" />&nbsp;8 `~``~~`~`~~`~~`~~``~```~````~`~```~``~````~~~````~~``~~``~~` 8<br class="calibre7" />&nbsp;9 ~`~``~~````~~```~`~~```~~`~``~`~~``~`~`~~~~`~`~~`~`~```~~``` 9<br class="calibre7" />10 `~~~~~~`~``~``~~~``~``~~~~`~``~```~`~~``~~~~~~``````~~`~``~~ 10<br class="calibre7" />11 ~``~~~````~`~~`~~~`~~~``~``````~`~``~~~~`````~~~``````~`~`~~ 11<br class="calibre7" />12 ~~~~~``~`~````~```~`~`~`~~`~~`~``~~~~~~~`~~```~~``~~`~~~~``` 12<br class="calibre7" />13 `~~```~~````````~~~`~~~```~~~~~~~~`~~``~~`~```~`~~````~~~``~ 13<br class="calibre7" />14 ```~``~`~`~``~```~`~``~`~``~~```~`~~~``~~``~```~`~~`~``````~ 14<br class="calibre7" /><br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-891"></span>Treasure detected at a distance of 5 from the sonar device.<br class="calibre7" />You have 19 sonar device(s) left. 3 treasure chest(s) remaining.<br class="calibre7" />Where do you want to drop the next sonar device? (0-59 0-14) (or type quit)<br class="calibre7" /><span class="codestrong">30 5</span><br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" /><br class="calibre7" />&nbsp;0 ~`~``~``~``~`~`~```~`~``````~```~`~~~`~~```~~`~~~~~`~~`~~~~` 0<br class="calibre7" />&nbsp;1 ~~~~~`~~~~~````~``~~```~``~`~`~`~``~~```~~~`~`~```~~~~`~`~~` 1<br class="calibre7" />&nbsp;2 ```~````~``~`~`~~~``~~`````~~``~``~``~~```~~``~~`~~~````~~`~ 2<br class="calibre7" />&nbsp;3 `````~~``````~`~~~~~```~~``~~~`~`~~~~~~`````~`~```~~~``~``~` 3<br class="calibre7" />&nbsp;4 ~~~`~~~`~`~~~``~~~`~`~``~~~~``~~~~``~~~~`~`~``~~```~``~~`~`~ 4<br class="calibre7" />&nbsp;5 `~``~````~`~`~~``~~~~````5`~``3~~~~````````~``~~~`~~``~~```` 5<br class="calibre7" />&nbsp;6 ~`~```~~`~~```~````````~~```~```~~~~``~~~`~`~~`~``~~~`~~`~`` 6<br class="calibre7" />&nbsp;7 ~`~~~```~``~```~`~```~~~~~~~`~~`~`~~~~``~```~~~`~```~``~``~` 7<br class="calibre7" />&nbsp;8 `~``~~`~`~~`~~`~~``~```~````~`~```~``~````~~~````~~``~~``~~` 8<br class="calibre7" />&nbsp;9 ~`~``~~````~~```~`~~```~~`~``~`~~``~`~`~~~~`~`~~`~`~```~~``` 9<br class="calibre7" />10 `~~~~~~`~``~``~~~``~``~~~~`~``~```~`~~``~~~~~~``````~~`~``~~ 10<br class="calibre7" />11 ~``~~~````~`~~`~~~`~~~``~``````~`~``~~~~`````~~~``````~`~`~~ 11<br class="calibre7" />12 ~~~~~``~`~````~```~`~`~`~~`~~`~``~~~~~~~`~~```~~``~~`~~~~``` 12<br class="calibre7" />13 `~~```~~````````~~~`~~~```~~~~~~~~`~~``~~`~```~`~~````~~~``~ 13<br class="calibre7" />14 ```~``~`~`~``~```~`~``~`~``~~```~`~~~``~~``~```~`~~`~``````~ 14<br class="calibre7" /><br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />Treasure detected at a distance of 3 from the sonar device.<br class="calibre7" />You have 18 sonar device(s) left. 3 treasure chest(s) remaining.<br class="calibre7" />Where do you want to drop the next sonar device? (0-59 0-14) (or type quit)<br class="calibre7" /><span class="codestrong">25 10</span><br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" /><br class="calibre7" />&nbsp;0 ~`~``~``~``~`~`~```~`~``````~```~`~~~`~~```~~`~~~~~`~~`~~~~` 0<br class="calibre7" />&nbsp;1 ~~~~~`~~~~~````~``~~```~``~`~`~`~``~~```~~~`~`~```~~~~`~`~~` 1<br class="calibre7" />&nbsp;2 ```~````~``~`~`~~~``~~`````~~``~``~``~~```~~``~~`~~~````~~`~ 2<br class="calibre7" />&nbsp;3 `````~~``````~`~~~~~```~~``~~~`~`~~~~~~`````~`~```~~~``~``~` 3<br class="calibre7" />&nbsp;4 ~~~`~~~`~`~~~``~~~`~`~``~~~~``~~~~``~~~~`~`~``~~```~``~~`~`~ 4<br class="calibre7" />&nbsp;5 `~``~````~`~`~~``~~~~````5`~``3~~~~````````~``~~~`~~``~~```` 5<br class="calibre7" />&nbsp;6 ~`~```~~`~~```~````````~~```~```~~~~``~~~`~`~~`~``~~~`~~`~`` 6<br class="calibre7" />&nbsp;7 ~`~~~```~``~```~`~```~~~~~~~`~~`~`~~~~``~```~~~`~```~``~``~` 7<br class="calibre7" />&nbsp;8 `~``~~`~`~~`~~`~~``~```~````~`~```~``~````~~~````~~``~~``~~` 8<br class="calibre7" />&nbsp;9 ~`~``~~````~~```~`~~```~~`~``~`~~``~`~`~~~~`~`~~`~`~```~~``` 9<br class="calibre7" />10 `~~~~~~`~``~``~~~``~``~~~4`~``~```~`~~``~~~~~~``````~~`~``~~ 10<br class="calibre7" />11 ~``~~~````~`~~`~~~`~~~``~``````~`~``~~~~`````~~~``````~`~`~~ 11<br class="calibre7" />12 ~~~~~``~`~````~```~`~`~`~~`~~`~``~~~~~~~`~~```~~``~~`~~~~``` 12<br class="calibre7" />13 `~~```~~````````~~~`~~~```~~~~~~~~`~~``~~`~```~`~~````~~~``~ 13<br class="calibre7" />14 ```~``~`~`~``~```~`~``~`~``~~```~`~~~``~~``~```~`~~`~``````~ 14<br class="calibre7" /><br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />Treasure detected at a distance of 4 from the sonar device.<br class="calibre7" />You have 17 sonar device(s) left. 3 treasure chest(s) remaining.<br class="calibre7" />Where do you want to drop the next sonar device? (0-59 0-14) (or type quit)<br class="calibre7" /><span class="codestrong">29 8</span><br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;0 ~`~``~``~``~`~`~```~`~``````~```~`~~~`~~```~~`~~~~~`~~`~~~~` 0<br class="calibre7" />&nbsp;1 ~~~~~`~~~~~````~``~~```~``~`~`~`~``~~```~~~`~`~```~~~~`~`~~` 1<br class="calibre7" />&nbsp;2 ```~````~``~`~`~~~``~~`````~~``~``~``~~```~~``~~`~~~````~~`~ 2<br class="calibre7" />&nbsp;3 `````~~``````~`~~~~~```~~``~~~`~`~~~~~~`````~`~```~~~``~``~` 3<br class="calibre7" />&nbsp;4 ~~~`~~~`~`~~~``~~~`~`~``~~~~``~~~~``~~~~`~`~``~~```~``~~`~`~ 4<br class="calibre7" />&nbsp;5 `~``~````~`~`~~``~~~~````X`~``X~~~~````````~``~~~`~~``~~```` 5<br class="calibre7" />&nbsp;6 ~`~```~~`~~```~````````~~```~```~~~~``~~~`~`~~`~``~~~`~~`~`` 6<br class="calibre7" />&nbsp;7 ~`~~~```~``~```~`~```~~~~~~~`~~`~`~~~~``~```~~~`~```~``~``~` 7<br class="calibre7" />&nbsp;8 `~``~~`~`~~`~~`~~``~```~````~X~```~``~````~~~````~~``~~``~~` 8<br class="calibre7" />&nbsp;9 ~`~``~~````~~```~`~~```~~`~``~`~~``~`~`~~~~`~`~~`~`~```~~``` 9<br class="calibre7" />10 `~~~~~~`~``~``~~~``~``~~~X`~``~```~`~~``~~~~~~``````~~`~``~~ 10<br class="calibre7" />11 ~``~~~````~`~~`~~~`~~~``~``````~`~``~~~~`````~~~``````~`~`~~ 11<br class="calibre7" />12 ~~~~~``~`~````~```~`~`~`~~`~~`~``~~~~~~~`~~```~~``~~`~~~~``` 12<br class="calibre7" />13 `~~```~~````````~~~`~~~```~~~~~~~~`~~``~~`~```~`~~````~~~``~ 13<br class="calibre7" />14 ```~``~`~`~``~```~`~``~`~``~~```~`~~~``~~``~```~`~~`~``````~ 14<br class="calibre7" /><br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />You have found a sunken treasure chest!<br class="calibre7" />You have 16 sonar device(s) left. 2 treasure chest(s) remaining.<br class="calibre7" />Where do you want to drop the next sonar device? (0-59 0-14) (or type quit)<br class="calibre7" />--<span class="codeitalic">snip</span>--</p>
<h3 class="h2" id="calibre_link-608"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-374" class="calibre1"></span><strong class="calibre2">Source Code for Sonar Treasure Hunt</strong></h3>
<p class="noindent">Enter the following source code in a new file and save the file as <em class="calibre6">sonar.py</em>. Then run it by pressing F5 (or <small class="calibre11">FN</small>-F5 on OS X). If you get errors after entering this code, compare the code you typed to the book’s code with the online diff tool at <em class="calibre6"><a href="https://www.nostarch.com/inventwithpython#diff" class="calibre4">https://www.nostarch.com/inventwithpython#diff</a></em>.</p>
<div class="image"><img src="images/00020.jpeg" alt="image" class="calibre3" /></div>
<p class="sidenote"><em class="calibre6">sonar.py</em></p>
<p class="programs">&nbsp;&nbsp;1. # Sonar Treasure Hunt<br class="calibre7" />&nbsp;&nbsp;2.<br class="calibre7" />&nbsp;&nbsp;3. import random<br class="calibre7" />&nbsp;&nbsp;4. import sys<br class="calibre7" />&nbsp;&nbsp;5. import math<br class="calibre7" />&nbsp;&nbsp;6.<br class="calibre7" />&nbsp;&nbsp;7. def getNewBoard():<br class="calibre7" />&nbsp;&nbsp;8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a new 60x15 board data structure.<br class="calibre7" />&nbsp;&nbsp;9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board = []<br class="calibre7" />&nbsp;10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x in range(60): # The main list is a list of 60 lists.<br class="calibre7" />&nbsp;11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board.append([])<br class="calibre7" />&nbsp;12.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for y in range(15): # Each list in the main list has<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15 single-character strings.<br class="calibre7" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-892"></span> 13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use different characters for the ocean to make it more<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readable.<br class="calibre7" />&nbsp;14.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if random.randint(0, 1) == 0:<br class="calibre7" />&nbsp;15.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x].append('~')<br class="calibre7" />&nbsp;16.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />&nbsp;17.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x].append('`')<br class="calibre7" />&nbsp;18.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return board<br class="calibre7" />&nbsp;19.<br class="calibre7" />&nbsp;20. def drawBoard(board):<br class="calibre7" />&nbsp;21.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Draw the board data structure.<br class="calibre7" />&nbsp;22.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tensDigitsLine = '&nbsp;&nbsp;&nbsp;&nbsp;' # Initial space for the numbers down the left<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;side of the board<br class="calibre7" />&nbsp;23.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i in range(1, 6):<br class="calibre7" />&nbsp;24.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tensDigitsLine += (' ' * 9) + str(i)<br class="calibre7" />&nbsp;25.<br class="calibre7" />&nbsp;26.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print the numbers across the top of the board.<br class="calibre7" />&nbsp;27.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tensDigitsLine)<br class="calibre7" />&nbsp;28.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;' + ('0123456789' * 6))<br class="calibre7" />&nbsp;29.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre7" />&nbsp;30.<br class="calibre7" />&nbsp;31.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print each of the 15 rows.<br class="calibre7" />&nbsp;32.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row in range(15):<br class="calibre7" />&nbsp;33.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single-digit numbers need to be padded with an extra space.<br class="calibre7" />&nbsp;34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if row &lt; 10:<br class="calibre7" />&nbsp;35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extraSpace = ' '<br class="calibre7" />&nbsp;36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />&nbsp;37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extraSpace = ''<br class="calibre7" />&nbsp;38.<br class="calibre7" />&nbsp;39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create the string for this row on the board.<br class="calibre7" />&nbsp;40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boardRow = ''<br class="calibre7" />&nbsp;41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for column in range(60):<br class="calibre7" />&nbsp;42.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boardRow += board[column][row]<br class="calibre7" />&nbsp;43.<br class="calibre7" />&nbsp;44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('%s%s %s %s' % (extraSpace, row, boardRow, row))<br class="calibre7" />&nbsp;45.<br class="calibre7" />&nbsp;46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print the numbers across the bottom of the board.<br class="calibre7" />&nbsp;47.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre7" />&nbsp;48.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(' ' + ('0123456789' * 6))<br class="calibre7" />&nbsp;49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tensDigitsLine)<br class="calibre7" />&nbsp;50.<br class="calibre7" />&nbsp;51. def getRandomChests(numChests):<br class="calibre7" />&nbsp;52.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a list of chest data structures (two-item lists of x, y int<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coordinates).<br class="calibre7" />&nbsp;53.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests = []<br class="calibre7" />&nbsp;54.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while len(chests) &lt; numChests:<br class="calibre7" />&nbsp;55.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newChest = [random.randint(0, 59), random.randint(0, 14)]<br class="calibre7" />&nbsp;56.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if newChest not in chests: # Make sure a chest is not already<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;here.<br class="calibre7" />&nbsp;57.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests.append(newChest)<br class="calibre7" />&nbsp;58.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return chests<br class="calibre7" />&nbsp;59.<br class="calibre7" />&nbsp;60. def isOnBoard(x, y):<br class="calibre7" />&nbsp;61.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return True if the coordinates are on the board; otherwise, return<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;False.<br class="calibre7" />&nbsp;62.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return x &gt;= 0 and x &lt;= 59 and y &gt;= 0 and y &lt;= 14<br class="calibre7" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-893"></span> 63.<br class="calibre7" />&nbsp;64. def makeMove(board, chests, x, y):<br class="calibre7" />&nbsp;65.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change the board data structure with a sonar device character.<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove treasure chests from the chests list as they are found.<br class="calibre7" />&nbsp;66.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return False if this is an invalid move.<br class="calibre7" />&nbsp;67.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise, return the string of the result of this move.<br class="calibre7" />&nbsp;68.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = 100 # Any chest will be closer than 100.<br class="calibre7" />&nbsp;69.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for cx, cy in chests:<br class="calibre7" />&nbsp;70.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance = math.sqrt((cx - x) * (cx - x) + (cy - y) * (cy - y))<br class="calibre7" />&nbsp;71.<br class="calibre7" />&nbsp;72.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if distance &lt; smallestDistance: # We want the closest treasure<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chest.<br class="calibre7" />&nbsp;73.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = distance<br class="calibre7" />&nbsp;74.<br class="calibre7" />&nbsp;75.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = round(smallestDistance)<br class="calibre7" />&nbsp;76.<br class="calibre7" />&nbsp;77.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if smallestDistance == 0:<br class="calibre7" />&nbsp;78.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# xy is directly on a treasure chest!<br class="calibre7" />&nbsp;79.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests.remove([x, y])<br class="calibre7" />&nbsp;80.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'You have found a sunken treasure chest!'<br class="calibre7" />&nbsp;81.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />&nbsp;82.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if smallestDistance &lt; 10:<br class="calibre7" />&nbsp;83.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x][y] = str(smallestDistance)<br class="calibre7" />&nbsp;84.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Treasure detected at a distance of %s from the sonar<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;device.' % (smallestDistance)<br class="calibre7" />&nbsp;85.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />&nbsp;86.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x][y] = 'X'<br class="calibre7" />&nbsp;87.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Sonar did not detect anything. All treasure chests<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out of range.'<br class="calibre7" />&nbsp;88.<br class="calibre7" />&nbsp;89. def enterPlayerMove(previousMoves):<br class="calibre7" />&nbsp;90.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Let the player enter their move. Return a two-item list of int<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xy coordinates.<br class="calibre7" />&nbsp;91.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Where do you want to drop the next sonar device? (0-59 0-14)<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(or type quit)')<br class="calibre7" />&nbsp;92.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:<br class="calibre7" />&nbsp;93.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move = input()<br class="calibre7" />&nbsp;94.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if move.lower() == 'quit':<br class="calibre7" />&nbsp;95.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Thanks for playing!')<br class="calibre7" />&nbsp;96.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br class="calibre7" />&nbsp;97.<br class="calibre7" />&nbsp;98.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move = move.split()<br class="calibre7" />&nbsp;99.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(move) == 2 and move[0].isdigit() and move[1].isdigit() and<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isOnBoard(int(move[0]), int(move[1])):<br class="calibre7" />100.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if [int(move[0]), int(move[1])] in previousMoves:<br class="calibre7" />101.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You already moved there.')<br class="calibre7" />102.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br class="calibre7" />103.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [int(move[0]), int(move[1])]<br class="calibre7" />104.<br class="calibre7" />105.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Enter a number from 0 to 59, a space, then a number from<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 to 14.')<br class="calibre7" />106.<br class="calibre7" />107. def showInstructions():<br class="calibre7" />108.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('''Instructions:<br class="calibre7" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-894"></span>109. You are the captain of the Simon, a treasure-hunting ship. Your current<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mission<br class="calibre7" />110. is to use sonar devices to find three sunken treasure chests at the<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bottom of<br class="calibre7" />111. the ocean. But you only have cheap sonar that finds distance, not<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direction.<br class="calibre7" />112.<br class="calibre7" />113. Enter the coordinates to drop a sonar device. The ocean map will be<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marked with<br class="calibre7" />114. how far away the nearest chest is, or an X if it is beyond the sonar<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;device's<br class="calibre7" />115. range. For example, the C marks are where chests are. The sonar device<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shows a<br class="calibre7" />116. 3 because the closest chest is 3 spaces away.<br class="calibre7" />117.<br class="calibre7" />118.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br class="calibre7" />119.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;012345678901234567890123456789012<br class="calibre7" />120.<br class="calibre7" />121.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ~~~~`~```~`~``~~~``~`~~``~~~``~`~ 0<br class="calibre7" />122.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 ~`~`~``~~`~```~~~```~~`~`~~~`~~~~ 1<br class="calibre7" />123.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 `~`C``3`~~~~`C`~~~~`````~~``~~~`` 2<br class="calibre7" />124.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 ````````~~~`````~~~`~`````~`~``~` 3<br class="calibre7" />125.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 ~`~~~~`~~`~~`C`~``~~`~~~`~```~``~ 4<br class="calibre7" />126.<br class="calibre7" />127.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;012345678901234567890123456789012<br class="calibre7" />128.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br class="calibre7" />129. (In the real game, the chests are not visible in the ocean.)<br class="calibre7" />130.<br class="calibre7" />131. Press enter to continue...''')<br class="calibre7" />132.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input()<br class="calibre7" />133.<br class="calibre7" />134.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('''When you drop a sonar device directly on a chest, you<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retrieve it and the other<br class="calibre7" />135. sonar devices update to show how far away the next nearest chest is. The<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests<br class="calibre7" />136. are beyond the range of the sonar device on the left, so it shows an X.<br class="calibre7" />137.<br class="calibre7" />138.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br class="calibre7" />139.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;012345678901234567890123456789012<br class="calibre7" />140.<br class="calibre7" />141.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ~~~~`~```~`~``~~~``~`~~``~~~``~`~ 0<br class="calibre7" />142.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 ~`~`~``~~`~```~~~```~~`~`~~~`~~~~ 1<br class="calibre7" />143.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 `~`X``7`~~~~`C`~~~~`````~~``~~~`` 2<br class="calibre7" />144.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 ````````~~~`````~~~`~`````~`~``~` 3<br class="calibre7" />145.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 ~`~~~~`~~`~~`C`~``~~`~~~`~```~``~ 4<br class="calibre7" />146.<br class="calibre7" />147.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;012345678901234567890123456789012<br class="calibre7" />148.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br class="calibre7" />149.<br class="calibre7" />150. The treasure chests don't move around. Sonar devices can detect treasure<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests<br class="calibre7" />151. up to a distance of 9 spaces. Try to collect all 3 chests before running<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out of<br class="calibre7" />152. sonar devices. Good luck!<br class="calibre7" />153.<br class="calibre7" /><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-895"></span>154. Press enter to continue...''')<br class="calibre7" />155.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input()<br class="calibre7" />156.<br class="calibre7" />157.<br class="calibre7" />158.<br class="calibre7" />159. print('S O N A R !')<br class="calibre7" />160. print()<br class="calibre7" />161. print('Would you like to view the instructions? (yes/no)')<br class="calibre7" />162. if input().lower().startswith('y'):<br class="calibre7" />163.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showInstructions()<br class="calibre7" />164.<br class="calibre7" />165. while True:<br class="calibre7" />166.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Game setup<br class="calibre7" />167.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonarDevices = 20<br class="calibre7" />168.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theBoard = getNewBoard()<br class="calibre7" />169.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theChests = getRandomChests(3)<br class="calibre7" />170.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drawBoard(theBoard)<br class="calibre7" />171.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousMoves = []<br class="calibre7" />172.<br class="calibre7" />173.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while sonarDevices &gt; 0:<br class="calibre7" />174.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Show sonar device and chest statuses.<br class="calibre7" />175.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You have %s sonar device(s) left. %s treasure chest(s)<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remaining.' % (sonarDevices, len(theChests)))<br class="calibre7" />176.<br class="calibre7" />177.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x, y = enterPlayerMove(previousMoves)<br class="calibre7" />178.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousMoves.append([x, y]) # We must track all moves so that<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonar devices can be updated.<br class="calibre7" />179.<br class="calibre7" />180.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moveResult = makeMove(theBoard, theChests, x, y)<br class="calibre7" />181.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if moveResult == False:<br class="calibre7" />182.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br class="calibre7" />183.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />184.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if moveResult == 'You have found a sunken treasure chest!':<br class="calibre7" />185.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update all the sonar devices currently on the map.<br class="calibre7" />186.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x, y in previousMoves:<br class="calibre7" />187.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makeMove(theBoard, theChests, x, y)<br class="calibre7" />188.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drawBoard(theBoard)<br class="calibre7" />189.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(moveResult)<br class="calibre7" />190.<br class="calibre7" />191.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(theChests) == 0:<br class="calibre7" />192.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You have found all the sunken treasure chests!<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Congratulations and good game!')<br class="calibre7" />193.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br class="calibre7" />194.<br class="calibre7" />195.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonarDevices -= 1<br class="calibre7" />196.<br class="calibre7" />197.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if sonarDevices == 0:<br class="calibre7" />198.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('We\'ve run out of sonar devices! Now we have to turn the<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship around and head')<br class="calibre7" />199.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('for home with treasure chests still out there! Game<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;over.')<br class="calibre7" />200.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;&nbsp;The remaining chests were here:')<br class="calibre7" />201.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x, y in theChests:<br class="calibre7" />202.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;&nbsp;%s, %s' % (x, y))<br class="calibre7" />203.<br class="calibre7" />204.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Do you want to play again? (yes or no)')<br class="calibre7" />205.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not input().lower().startswith('y'):<br class="calibre7" />206.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</p>
<h3 class="h2" id="calibre_link-609"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-261" class="calibre1"></span><strong class="calibre2">Designing the Program</strong></h3>
<p class="noindent">Before trying to understand the source code, play the game a few times to learn what is going on. The Sonar Treasure Hunt game uses lists of lists and other complicated variables, called <em class="calibre6">data structures</em>. Data structures store arrangements of values to represent something. For example, in <a href="#calibre_link-12" class="calibre4">Chapter 10</a>, a Tic-Tac-Toe board data structure was a list of strings. The string represented an <em class="calibre6">X</em>, an <em class="calibre6">O</em>, or an empty space, and the index of the string in the list represented the space on the board. The Sonar Treasure Hunt game will have similar data structures for the locations of treasure chests and sonar devices.</p>
<h3 class="h2" id="calibre_link-610"><strong class="calibre2">Importing the random, sys, and math Modules</strong></h3>
<p class="noindent">At the start of the program, we import the <span class="literal1">random</span>, <span class="literal1">sys</span>, and <span class="literal1">math</span> modules:</p>
<p class="programs">1. # Sonar Treasure Hunt<br class="calibre7" />2.<br class="calibre7" />3. import random<br class="calibre7" />4. import sys<br class="calibre7" />5. import math</p>
<p class="indent">The <span class="literal1">sys</span> module contains the <span class="literal1">exit()</span> function, which terminates the program immediately. None of the lines of code after the <span class="literal1">sys.exit()</span> call will run; the program just stops as though it has reached the end. This function is used later in the program.</p>
<p class="indent">The <span class="literal1">math</span> module contains the <span class="literal1">sqrt()</span> function, which is used to find the square root of a number. The math behind square roots is explained the “<a href="#calibre_link-75" class="calibre4">Finding the Closest Treasure Chest</a>” on <a href="#calibre_link-76" class="calibre4">page 186</a>.</p>
<h3 class="h2" id="calibre_link-611"><strong class="calibre2">Creating a New Game Board</strong></h3>
<p class="noindent">The start of each new game requires a new <span class="literal1">board</span> data structure, which is created by <span class="literal1">getNewBoard()</span>. The Sonar Treasure Hunt game board is an ASCII art ocean with x- and y-coordinates around it.</p>
<p class="indent">When we use the <span class="literal1">board</span> data structure, we want to be able to access its coordinate system in the same way we access Cartesian coordinates. To do that, we’ll use a list of lists to call each coordinate on the board like this: <span class="literal1">board[x][y]</span>. The x-coordinate comes before the y-coordinate&mdash;to get the string at coordinate (26, 12), you access <span class="literal1">board[26][12]</span>, not <span class="literal1">board[12][26]</span>.</p>
<p class="programs"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-369"></span> 7. def getNewBoard():<br class="calibre7" />&nbsp;8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a new 60x15 board data structure.<br class="calibre7" />&nbsp;9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board = []<br class="calibre7" />10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x in range(60): # The main list is a list of 60 lists.<br class="calibre7" />11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board.append([])<br class="calibre7" />12.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for y in range(15): # Each list in the main list has<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15 single-character strings.<br class="calibre7" />13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Use different characters for the ocean to make it more<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readable.<br class="calibre7" />14.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if random.randint(0, 1) == 0:<br class="calibre7" />15.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x].append('~')<br class="calibre7" />16.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />17.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x].append('`')</p>
<p class="indent">The <span class="literal1">board</span> data structure is a list of lists of strings. The first list represents the x-coordinate. Since the game’s board is 60 characters across, this first list needs to contain 60 lists. At line 10, we create a <span class="literal1">for</span> loop that will append 60 blank lists to it.</p>
<p class="indent">But <span class="literal1">board</span> is more than just a list of 60 blank lists. Each of the 60 lists represents an x-coordinate of the game board. There are 15 rows in the board, so each of these 60 lists must contain 15 strings. Line 12 is another <span class="literal1">for</span> loop that adds 15 single-character strings that represent the ocean.</p>
<p class="indent">The ocean will be a bunch of randomly chosen <span class="literal1">'~'</span> and <span class="literal1">'`'</span> strings. The tilde (<span class="literal1">~</span>) and backtick (<span class="literal1">`</span>) characters&mdash;located next to the 1 key on your keyboard&mdash;will be used for the ocean waves. To determine which character to use, lines 14 to 17 apply this logic: if the return value of <span class="literal1">random.randint()</span> is <span class="literal1">0</span>, add the <span class="literal1">'~'</span> string; otherwise, add the <span class="literal1">'`'</span> string. This will give the ocean a random, choppy look.</p>
<p class="indent">For a smaller example, if <span class="literal1">board</span> were set to <span class="literal1">[['~', '~', '`'], [['~', '~', '`'], [['~', '~', '`'], ['~', '`', '`'], ['`', '~', '`']]</span> then the board it drew would look like this:</p>
<p class="programs">~~~~`<br class="calibre7" />~~~`~<br class="calibre7" />`````</p>
<p class="indent">Finally, the function returns the value in the <span class="literal1">board</span> variable on line 18:</p>
<p class="programs">18.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return board</p>
<h3 class="h2" id="calibre_link-612"><strong class="calibre2">Drawing the Game Board</strong></h3>
<p class="noindent">Next we’ll define the <span class="literal1">drawBoard()</span> method that we call whenever we actually draw a new board:</p>
<p class="programs">20. def drawBoard(board):</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-896"></span>The full game board with coordinates along the edges looks like this:</p>
<p class="programs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;0 ~~~`~``~~~``~~~~``~`~`~`~`~~`~~~`~~`~``````~~`~``~`~~```~`~` 0<br class="calibre7" />&nbsp;1 `~`~````~~``~`~```~```~```~`~~~``~~`~~~``````~`~``~~``~~`~~` 1<br class="calibre7" />&nbsp;2 ```~~~~`~`~~```~~~``~````~~`~`~~`~`~`~```~~`~``~~`~`~~~~~~`~ 2<br class="calibre7" />&nbsp;3 ~~~~`~~~``~```~``~~`~`~~`~`~~``~````~`~````~```~`~`~`~`````~ 3<br class="calibre7" />&nbsp;4 ~```~~~~~`~~````~~~~```~~~`~`~`~````~`~~`~`~~``~~`~``~`~``~~ 4<br class="calibre7" />&nbsp;5 `~```~`~`~~`~~~```~~``~``````~~``~`~`~~~~`~~``~~~~~~`~```~~` 5<br class="calibre7" />&nbsp;6 ``~~`~~`~``~`````~````~~``~`~~~~`~~```~~~``~`~`~~``~~~```~~~ 6<br class="calibre7" />&nbsp;7 ``~``~~~~~~```~`~```~~~``~`~``~`~~~~~~```````~~~`~~`~~`~~`~~ 7<br class="calibre7" />&nbsp;8 ~~`~`~~```~``~~``~~~``~~`~`~~`~`~```~```~~~```~~~~~~`~`~~~~` 8<br class="calibre7" />&nbsp;9 ```~``~`~~~`~~```~``~``~~~```~````~```~`~~`~~~~~`~``~~~~~``` 9<br class="calibre7" />10 `~~~~```~`~````~`~`~~``~`~~~~`~``~``~```~~```````~`~``~````` 10<br class="calibre7" />11 ~~`~`~~`~``~`~~~````````````````~~`````~`~~``~`~~~~`~~~`~~`~ 11<br class="calibre7" />12 ~~`~~~~```~~~`````~~``~`~`~~``````~`~~``~```````~~``~~~`~~`~ 12<br class="calibre7" />13 `~``````~~``~`~~~```~~~~```~~`~`~~~`~```````~~`~```~``~`~~~~ 13<br class="calibre7" />14 ~~~``~```~`````~~`~`~``~~`~``~`~~`~`~``~`~``~~``~`~``~```~~~ 14<br class="calibre7" />&nbsp;&nbsp;&nbsp;012345678901234567890123456789012345678901234567890123456789<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5</p>
<p class="indent">The drawing in the <span class="literal1">drawBoard()</span> function has four steps:</p>
<ol class="calibre12">
<li value="1" class="calibre13"><p class="noindenta">Create a string variable of the line with 1, 2, 3, 4, and 5 spaced out with wide gaps. These numbers mark the coordinates for 10, 20, 30, 40, and 50 on the x-axis.</p></li>
<li value="2" class="calibre13"><p class="noindenta">Use that string to display the x-axis coordinates along the top of the screen.</p></li>
<li value="3" class="calibre13"><p class="noindenta">Print each row of the ocean along with the y-axis coordinates on both sides of the screen.</p></li>
<li value="4" class="calibre13"><p class="noindenta">Print the x-axis again at the bottom. Having coordinates on all sides makes it easier to see where to place a sonar device.</p></li>
</ol>
<h4 class="h3" id="calibre_link-613"><em class="calibre10"><strong class="calibre2">Drawing the X-Coordinates Along the Top of the Board</strong></em></h4>
<p class="noindenta">The first part of <span class="literal1">drawBoard()</span> prints the x-axis at the top of the board. Because we want each part of the board to be even, each coordinate label can take up only one character space. When the coordinate numbering reaches 10, there are two digits for each number, so we put the digits in the tens place on a separate line, as shown in <a href="#calibre_link-77" class="calibre4">Figure 13-3</a>. The x-axis is organized so that the first line shows the tens-place digits and the second line shows the onesplace digits.</p>
<div class="image"><img src="images/00065.jpeg" alt="image" class="calibre3" /></div>
<p class="figcap"><a id="calibre_link-77" class="calibre4"></a><em class="calibre6">Figure 13-3: The spacing used for printing the top of the game board</em></p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-370"></span>Lines 22 to 24 create the string for the first line of the board, which is the tens-place part of the x-axis:</p>
<p class="programs">21.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Draw the board data structure.<br class="calibre7" />22.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tensDigitsLine = '&nbsp;&nbsp;&nbsp;&nbsp;' # Initial space for the numbers down the left<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;side of the board<br class="calibre7" />23.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i in range(1, 6):<br class="calibre7" />24.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tensDigitsLine += (' ' * 9) + str(i)</p>
<p class="indent">The numbers marking the tens position on the first line all have 9 spaces between them, and there are 13 spaces in front of the <span class="literal1">1</span>. Lines 22 to 24 create a string with this line and store it in a variable named <span class="literal1">tensDigitsLine</span>:</p>
<p class="programs">26.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print the numbers across the top of the board.<br class="calibre7" />27.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tensDigitsLine)<br class="calibre7" />28.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;' + ('0123456789' * 6))<br class="calibre7" />29.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()</p>
<p class="indent">To print the numbers across the top of the game board, first print the contents of the <span class="literal1">tensDigitsLine</span> variable. Then, on the next line, print three spaces (so that this row lines up correctly), and then print the string <span class="literal1">'0123456789'</span> six times: <span class="literal1">('0123456789' * 6)</span>.</p>
<h4 class="h3" id="calibre_link-614"><em class="calibre10"><strong class="calibre2">Drawing the Ocean</strong></em></h4>
<p class="noindenta">Lines 32 to 44 print each row of the ocean waves, including the numbers down the sides to label the y-axis:</p>
<p class="programs">31.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print each of the 15 rows.<br class="calibre7" />32.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for row in range(15):<br class="calibre7" />33.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Single-digit numbers need to be padded with an extra space.<br class="calibre7" />34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if row &lt; 10:<br class="calibre7" />35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extraSpace = ' '<br class="calibre7" />36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extraSpace = ''</p>
<p class="indent">The <span class="literal1">for</span> loop prints rows 0 to 14, along with the row numbers on either side of the board.</p>
<p class="indent">But we have the same problem that we had with the x-axis. Numbers with only one digit (such as 0, 1, 2, and so on) take up only one space when printed, but numbers with two digits (such as 10, 11, and 12) take up two spaces. The rows won’t line up if the coordinates have different sizes. The board would look like this:</p>
<p class="programs">8 ~~`~`~~```~``~~``~~~``~~`~`~~`~`~```~```~~~```~~~~~~`~`~~~~` 8<br class="calibre7" />9 ```~``~`~~~`~~```~``~``~~~```~````~```~`~~`~~~~~`~``~~~~~``` 9<br class="calibre7" />10 `~~~~```~`~````~`~`~~``~`~~~~`~``~``~```~~```````~`~``~````` 10<br class="calibre7" />11 ~~`~`~~`~``~`~~~````````````````~~`````~`~~``~`~~~~`~~~`~~`~ 11</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-263"></span>The solution is easy: add a space in front of all the single-digit numbers. Lines 34 to 37 set the variable <span class="literal1">extraSpace</span> to either a space or an empty string. The <span class="literal1">extraSpace</span> variable is always printed, but it has a space character only for single-digit row numbers. Otherwise, it is an empty string. This way, all of the rows will line up when you print them.</p>
<h4 class="h3" id="calibre_link-615"><em class="calibre10"><strong class="calibre2">Printing a Row in the Ocean</strong></em></h4>
<p class="noindenta">The <span class="literal1">board</span> parameter is a data structure for the entire ocean’s waves. Lines 39 to 44 read the <span class="literal1">board</span> variable and print a single row:</p>
<p class="programs">39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create the string for this row on the board.<br class="calibre7" />40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boardRow = ''<br class="calibre7" />41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for column in range(60):<br class="calibre7" />42.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boardRow += board[column][row]<br class="calibre7" />43.<br class="calibre7" />44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('%s%s %s %s' % (extraSpace, row, boardRow, row))</p>
<p class="indent">At line 40, <span class="literal1">boardRow</span> starts as a blank string. The <span class="literal1">for</span> loop on line 32 sets the <span class="literal1">row</span> variable for the current row of ocean waves to print. Inside this loop on line 41 is another <span class="literal1">for</span> loop that iterates over each column of the current row. We make <span class="literal1">boardRow</span> by concatenating <span class="literal1">board[column][row]</span> in this loop, which means concatenating <span class="literal1">board[0][row]</span>, <span class="literal1">board[1][row]</span>, <span class="literal1">board[2][row]</span>, and so on up to <span class="literal1">board[59][row]</span>. This is because the row contains 60 characters, from index <span class="literal1">0</span> to index <span class="literal1">59</span>.</p>
<p class="indent">The <span class="literal1">for</span> loop on line 41 iterates over integers <span class="literal1">0</span> to <span class="literal1">59</span>. On each iteration, the next character in the board data structure is copied to the end of <span class="literal1">boardRow</span>. By the time the loop is done, <span class="literal1">boardRow</span> has the row’s complete ASCII art waves. The string in <span class="literal1">boardRow</span> is then printed along with the row numbers on line 44.</p>
<h4 class="h3" id="calibre_link-616"><em class="calibre10"><strong class="calibre2">Drawing the X-Coordinates Along the Bottom of the Board</strong></em></h4>
<p class="noindenta">Lines 46 to 49 are similar to lines 26 to 29:</p>
<p class="programs">46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Print the numbers across the bottom of the board.<br class="calibre7" />47.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print()<br class="calibre7" />48.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;' + ('0123456789' * 6))<br class="calibre7" />49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(tensDigitsLine)</p>
<p class="indent">These lines print the x-coordinates at the bottom of the board.</p>
<h3 class="h2" id="calibre_link-617"><strong class="calibre2">Creating the Random Treasure Chests</strong></h3>
<p class="noindent">The game randomly decides where the hidden treasure chests are. The treasure chests are represented as a list of lists of two integers. These two integers are the x- and y-coordinates of a single chest. For example, if the chest data structure were <span class="literal1">[[2, 2], [2, 4], [10, 0]]</span>, then this would mean there were three treasure chests, one at (2, 2), another at (2, 4), and a third at (10, 0).</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-367"></span>The <span class="literal1">getRandomChests()</span> function creates a certain number of chest data structures at randomly assigned coordinates:</p>
<p class="programs">51. def getRandomChests(numChests):<br class="calibre7" />52.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a list of chest data structures (two-item lists of x, y int<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coordinates).<br class="calibre7" />53.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests = []<br class="calibre7" />54.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while len(chests) &lt; numChests:<br class="calibre7" />55.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newChest = [random.randint(0, 59), random.randint(0, 14)]<br class="calibre7" />56.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if newChest not in chests: # Make sure a chest is not already<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;here.<br class="calibre7" />57.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests.append(newChest)<br class="calibre7" />58.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return chests</p>
<p class="indent">The <span class="literal1">numChests</span> parameter tells the function how many treasure chests to generate. Line 54’s <span class="literal1">while</span> loop will iterate until all of the chests have been assigned coordinates. Two random integers are selected for the coordinates on line 55. The x-coordinate can be anywhere from 0 to 59, and the y-coordinate can be anywhere from 0 to 14. The <span class="literal1">[random.randint(0, 59), random.randint(0, 14)]</span> expression will evaluate to a list value like <span class="literal1">[2, 2]</span> or <span class="literal1">[2, 4]</span> or <span class="literal1">[10, 0]</span>. If these coordinates do not already exist in the <span class="literal1">chests</span> list, they are appended to <span class="literal1">chests</span> on line 57.</p>
<h3 class="h2" id="calibre_link-618"><strong class="calibre2">Determining Whether a Move Is Valid</strong></h3>
<p class="noindent">When the player enters the x- and y-coordinates for where they want to drop a sonar device, we need to make sure that the numbers are valid. As mentioned before, there are two conditions for a move to be valid: the x-coordinate must be between 0 and 59, and the y-coordinate must be between 0 and 14.</p>
<p class="indent">The <span class="literal1">isOnBoard()</span> function uses a simple expression with <span class="literal1">and</span> operators to combine these conditions into one expression and to ensure that each part of the expression is <span class="literal1">True</span>:</p>
<p class="programs">60. def isOnBoard(x, y):<br class="calibre7" />61.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return True if the coordinates are on the board; otherwise, return<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;False.<br class="calibre7" />62.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return x &gt;= 0 and x &lt;= 59 and y &gt;= 0 and y &lt;= 14</p>
<p class="indent">Because we are using the <span class="literal1">and</span> Boolean operator, if even one of the coordinates is invalid, then the entire expression evaluates to <span class="literal1">False</span>.</p>
<h3 class="h2" id="calibre_link-619"><strong class="calibre2">Placing a Move on the Board</strong></h3>
<p class="noindent">In the Sonar Treasure Hunt game, the game board is updated to display a number that represents each sonar device’s distance to the closest treasure chest. So when the player makes a move by giving the program an x- and y-coordinate, the board changes based on the positions of the treasure chests.</p>
<p class="programs"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-76"></span>64. def makeMove(board, chests, x, y):<br class="calibre7" />65.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Change the board data structure with a sonar device character.<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove treasure chests from the chests list as they are found.<br class="calibre7" />66.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Return False if this is an invalid move.<br class="calibre7" />67.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Otherwise, return the string of the result of this move.</p>
<p class="indentb">The <span class="literal1">makeMove()</span> function takes four parameters: the game board’s data structure, the treasure chest’s data structure, the x-coordinate, and the y-coordinate. The <span class="literal1">makeMove()</span> function will return a string value describing what happened in response to the move:</p>
<p class="bull">• If the coordinates land directly on a treasure chest, <span class="literal1">makeMove()</span> returns <span class="literal1">'You have found a sunken treasure chest!'</span>.</p>
<p class="bull">• If the coordinates are within a distance of 9 or less of a chest, <span class="literal1">makeMove()</span> returns <span class="literal1">'Treasure detected at a distance of %s from the sonar device.'</span> (where <span class="literal1">%s</span> is replaced with the integer distance).</p>
<p class="bull">• Otherwise, <span class="literal1">makeMove()</span> will return <span class="literal1">'Sonar did not detect anything. All treasure chests out of range.'</span>.</p>
<p class="indentt">Given the coordinates of where the player wants to drop the sonar device and a list of x- and y-coordinates for the treasure chests, you’ll need an algorithm to find out which treasure chest is closest.</p>
<h4 class="h3" id="calibre_link-75"><em class="calibre10"><strong class="calibre2">Finding the Closest Treasure Chest</strong></em></h4>
<p class="noindenta">Lines 68 to 75 are an algorithm to determine which treasure chest is closest to the sonar device.</p>
<p class="programs">68.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = 100 # Any chest will be closer than 100.<br class="calibre7" />69.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for cx, cy in chests:<br class="calibre7" />70.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance = math.sqrt((cx - x) * (cx - x) + (cy - y) * (cy - y))<br class="calibre7" />71.<br class="calibre7" />72.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if distance &lt; smallestDistance: # We want the closest treasure<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chest.<br class="calibre7" />73.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = distance</p>
<p class="indent">The <span class="literal1">x</span> and <span class="literal1">y</span> parameters are integers (say, <span class="literal1">3</span> and <span class="literal1">5</span>), and together they represent the location on the game board where the player guessed. The <span class="literal1">chests</span> variable will have a value such as <span class="literal1">[[5, 0], [0, 2], [4, 2]]</span>, which represents the locations of three treasure chests. <a href="#calibre_link-78" class="calibre4">Figure 13-4</a> illustrates this value.</p>
<p class="indent">To find the distance between the sonar device and a treasure chest, we’ll need to do some math to find the distance between two x- and y-coordinates. Let’s say we place a sonar device at (3, 5) and want to find the distance to the treasure chest at (4, 2).</p>
<div class="image"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-328"></span><img src="images/00077.jpeg" alt="image" class="calibre3" /></div>
<p class="figcap"><a id="calibre_link-78" class="calibre4"></a><em class="calibre6">Figure 13-4: The treasure chests represented by</em> <span class="literal"><span class="codeitalic">[[5, 0], [0, 2], [4, 2]]</span></span></p>
<p class="indent">To find the distance between two sets of x- and y-coordinates, we’ll use the <em class="calibre6">Pythagorean theorem</em>. This theorem applies to <em class="calibre6">right triangles</em>&mdash;triangles where one corner is 90 degrees, the same kind of corner you find in a rectangle. The Pythagorean theorem says that the diagonal side of the triangle can be calculated from the lengths of the horizontal and vertical sides. <a href="#calibre_link-79" class="calibre4">Figure 13-5</a> shows a right triangle drawn between the sonar device at (3, 5) and the treasure chest at (4, 2).</p>
<div class="image"><img src="images/00088.jpeg" alt="image" class="calibre3" /></div>
<p class="figcap"><a id="calibre_link-79" class="calibre4"></a><em class="calibre6">Figure 13-5: The board with a right triangle drawn over the sonar device and a treasure chest</em></p>
<p class="indent">The Pythagorean theorem is <em class="calibre6">a</em><sup class="calibre17">2</sup> <em class="calibre6">+ b</em><sup class="calibre17">2</sup> <em class="calibre6">= c</em><sup class="calibre17">2</sup>, in which <em class="calibre6">a</em> is the length of the horizontal side, <em class="calibre6">b</em> is the length of the vertical side, and <em class="calibre6">c</em> is the length of the diagonal side, or <em class="calibre6">hypotenuse</em>. These lengths are <em class="calibre6">squared</em>, which means that number is multiplied by itself. “Unsquaring” a number is called finding the number’s <em class="calibre6">square root</em>, as we’ll have to do to get <em class="calibre6">c</em> from <em class="calibre6">c</em><sup class="calibre17">2</sup>.</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-378"></span>Let’s use the Pythagorean theorem to find the distance between the sonar device at (3, 5) and chest at (4, 2):</p>
<ol class="calibre12">
<li value="1" class="calibre13"><p class="noindenta">To find <em class="calibre6">a</em>, subtract the second x-coordinate, 4, from the first x-coordinate, 3: 3 &ndash; 4 = &ndash;1.</p></li>
<li value="2" class="calibre13"><p class="noindenta">To find <em class="calibre6">a</em><sup class="calibre17">2</sup>, multiply <em class="calibre6">a</em> by <em class="calibre6">a</em>: &ndash;1 × &ndash;1 = 1. (A negative number times a negative number is always a positive number.)</p></li>
<li value="3" class="calibre13"><p class="noindenta">To find <em class="calibre6">b</em>, subtract the second y-coordinate, 2, from the first y-coordinate, 5: 5 &ndash; 2 = 3.</p></li>
<li value="4" class="calibre13"><p class="noindenta">To find <em class="calibre6">b</em><sup class="calibre17">2</sup>, multiply <em class="calibre6">b</em> by <em class="calibre6">b</em>: 3 × 3 = 9.</p></li>
<li value="5" class="calibre13"><p class="noindenta">To find <em class="calibre6">c</em><sup class="calibre17">2</sup>, add <em class="calibre6">a</em><sup class="calibre17">2</sup> and <em class="calibre6">b</em><sup class="calibre17">2</sup>: 1 + 9 = 10.</p></li>
<li value="6" class="calibre13"><p class="noindenta">To get <em class="calibre6">c</em> from <em class="calibre6">c</em><sup class="calibre17">2</sup>, you need to find the square root of <em class="calibre6">c</em><sup class="calibre17">2</sup>.</p></li>
</ol>
<p class="indent">The <span class="literal1">math</span> module that we imported on line 5 has a square root function named <span class="literal1">sqrt()</span>. Enter the following into the interactive shell:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">import math</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">math.sqrt(10)</span><br class="calibre7" />3.1622776601683795<br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">3.1622776601683795 * 3.1622776601683795</span><br class="calibre7" />10.000000000000002</p>
<p class="indent">Notice that multiplying a square root by itself produces the square number. (The extra <span class="literal1">2</span> at the end of the <span class="literal1">10</span> is from an unavoidable slight imprecision in the <span class="literal1">sqrt()</span> function.)</p>
<p class="indent">By passing <em class="calibre6">c</em><sup class="calibre17">2</sup> to <span class="literal1">sqrt()</span>, we can tell that the sonar device is 3.16 units away from the treasure chest. The game will round this down to 3.</p>
<p class="indent">Let’s look at lines 68 to 70 again:</p>
<p class="programs">68.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = 100 # Any chest will be closer than 100.<br class="calibre7" />69.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for cx, cy in chests:<br class="calibre7" />70.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance = math.sqrt((cx - x) * (cx - x) + (cy - y) * (cy - y))</p>
<p class="indent">The code inside line 69’s <span class="literal1">for</span> loop calculates the distance of each chest. Line 68 gives <span class="literal1">smallestDistance</span> the impossibly long distance of <span class="literal1">100</span> at the beginning of the loop so that at least one of the treasure chests you find will be put into <span class="literal1">smallestDistance</span> in line 73. Since <span class="literal1">cx &ndash; x</span> represents the horizontal distance <em class="calibre6">a</em> between the chest and sonar device, <span class="literal1">(cx - x) * (cx - x)</span> is the <em class="calibre6">a</em><sup class="calibre17">2</sup> of our Pythagorean theorem calculation. It is added to <span class="literal1">(cy - y) * (cy - y)</span>, the <em class="calibre6">b</em><sup class="calibre17">2</sup>. This sum is <em class="calibre6">c</em><sup class="calibre17">2</sup> and is passed to <span class="literal1">sqrt()</span> to get the distance between the chest and sonar device.</p>
<p class="indent">We want to find the distance between the sonar device and the closest chest, so if this distance is less than the smallest distance, it is saved as the new smallest distance on line 73:</p>
<p class="programs">72.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if distance &lt; smallestDistance: # We want the closest treasure<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chest.<br class="calibre7" />73.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smallestDistance = distance</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-347"></span>By the time the <span class="literal1">for</span> loop has finished, you know that <span class="literal1">smallestDistance</span> holds the shortest distance between the sonar device and all of the treasure chests in the game.</p>
<h4 class="h3" id="calibre_link-620"><em class="calibre10"><strong class="calibre2">Removing Values with the remove() List Method</strong></em></h4>
<p class="noindenta">The <span class="literal1">remove()</span> list method removes the first occurrence of a value matching the passed-in argument. For example, enter the following into the interactive shell:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">x = [42, 5, 10, 42, 15, 42]</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x.remove(10)</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x</span><br class="calibre7" />[42, 5, 42, 15, 42]</p>
<p class="indent">The <span class="literal1">10</span> value has been removed from the <span class="literal1">x</span> list.</p>
<p class="indent">Now enter the following into the interactive shell:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">x = [42, 5, 10, 42, 15, 42]</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x.remove(42)</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x</span><br class="calibre7" />[5, 10, 42, 15, 42]</p>
<p class="indent">Notice that only the first <span class="literal1">42</span> value was removed and the second and third ones are still there. The <span class="literal1">remove()</span> method removes the first, and only the first, occurrence of the value you pass it.</p>
<p class="indent">If you try to remove a value that isn’t in the list, you’ll get an error:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">x = [5, 42]</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x.remove(10)</span><br class="calibre7" />Traceback (most recent call last):<br class="calibre7" />&nbsp;&nbsp;File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br class="calibre7" />ValueError: list.remove(x): x not in list</p>
<p class="indent">Like the <span class="literal1">append()</span> method, the <span class="literal1">remove()</span> method is called on a list and does not return a list. You want to use code like <span class="literal1">x.remove(42)</span>, not <span class="literal1">x = x.remove(42)</span>.</p>
<p class="indent">Let’s go back to finding the distances between sonar devices and treasure chests in the game. The only time that <span class="literal1">smallestDistance</span> is equal to <span class="literal1">0</span> is when the sonar device’s x- and y-coordinates are the same as a treasure chest’s x- and y-coordinates. This means the player has correctly guessed the location of a treasure chest.</p>
<p class="programs">77.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if smallestDistance == 0:<br class="calibre7" />78.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# xy is directly on a treasure chest!<br class="calibre7" />79.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chests.remove([x, y])<br class="calibre7" />80.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'You have found a sunken treasure chest!'</p>
<p class="indent">When this happens, the program removes this chest’s two-integer list from the <span class="literal1">chests</span> data structure with the <span class="literal1">remove()</span> list method. Then the function returns <span class="literal1">'You have found a sunken treasure chest!'</span>.</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-371"></span>But if <span class="literal1">smallestDistance</span> is not <span class="literal1">0</span>, the player didn’t guess an exact location of a treasure chest, and the <span class="literal1">else</span> block starting on line 81 executes:</p>
<p class="programs">81.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />82.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if smallestDistance &lt; 10:<br class="calibre7" />83.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x][y] = str(smallestDistance)<br class="calibre7" />84.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Treasure detected at a distance of %s from the sonar<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;device.' % (smallestDistance)<br class="calibre7" />85.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />86.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[x][y] = 'X'<br class="calibre7" />87.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 'Sonar did not detect anything. All treasure chests<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out of range.'</p>
<p class="indent">If the sonar device’s distance to a treasure chest is less than 10, line 83 marks the board with the string version of <span class="literal1">smallestDistance</span>. If not, the board is marked with an <span class="literal1">'X'</span>. This way, the player knows how close each sonar device is to a treasure chest. If the player sees a 0, they know they’re way off.</p>
<h4 class="h3" id="calibre_link-621"><em class="calibre10"><strong class="calibre2">Getting the Player’s Move</strong></em></h4>
<p class="noindenta">The <span class="literal1">enterPlayerMove()</span> function collects the x- and y-coordinates of the player’s next move:</p>
<p class="programs">89. def enterPlayerMove(previousMoves):<br class="calibre7" />90.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Let the player enter their move. Return a two-item list of int<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xy coordinates.<br class="calibre7" />91.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Where do you want to drop the next sonar device? (0-59 0-14)<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(or type quit)')<br class="calibre7" />92.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:<br class="calibre7" />93.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move = input()<br class="calibre7" />94.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if move.lower() == 'quit':<br class="calibre7" />95.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Thanks for playing!')<br class="calibre7" />96.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</p>
<p class="indent">The <span class="literal1">previousMoves</span> parameter is a list of two-integer lists of the previous places the player put a sonar device. This information will be used so that the player cannot place a sonar device somewhere they have already put one.</p>
<p class="indent">The <span class="literal1">while</span> loop will keep asking the player for their next move until they enter coordinates for a place that doesn’t already have a sonar device. The player can also enter <span class="literal1">'quit'</span> to quit the game. In that case, line 96 calls the <span class="literal1">sys.exit()</span> function to terminate the program immediately.</p>
<p class="indent">Assuming the player has not entered <span class="literal1">'quit'</span>, the code checks that the input is two integers separated by a space. Line 98 calls the <span class="literal1">split()</span> method on <span class="literal1">move</span> as the new value of <span class="literal1">move</span>:</p>
<p class="programs">&nbsp;98.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move = move.split()<br class="calibre7" />&nbsp;99.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(move) == 2 and move[0].isdigit() and move[1].isdigit() and<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isOnBoard(int(move[0]), int(move[1])):<br class="calibre7" />100.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if [int(move[0]), int(move[1])] in previousMoves:<br class="calibre7" />101.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You already moved there.')<br class="calibre7" />102.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br class="calibre7" />103.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [int(move[0]), int(move[1])]<br class="calibre7" />104.<br class="calibre7" />105.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Enter a number from 0 to 59, a space, then a number from<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 to 14.')</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-372"></span>If the player typed in a value like <span class="literal1">'1 2 3'</span>, then the list returned by <span class="literal1">split()</span> would be <span class="literal1">['1', '2', '3']</span>. In that case, the expression <span class="literal1">len(move) == 2</span> would be <span class="literal1">False</span> (the list in move should be only two numbers because it represents a coordinate), and the entire expression would evaluate immediately to <span class="literal1">False</span>. Python doesn’t check the rest of the expression because of short-circuiting (which was described in “<a href="#calibre_link-80" class="calibre4">Short-Circuit Evaluation</a>” on <a href="#calibre_link-81" class="calibre4">page 139</a>).</p>
<p class="indent">If the list’s length is <span class="literal1">2</span>, then the two values will be at indexes <span class="literal1">move[0]</span> and <span class="literal1">move[1]</span>. To check whether those values are numeric digits (like <span class="literal1">'2'</span> or <span class="literal1">'17'</span>), you could use a function like <span class="literal1">isOnlyDigits()</span> from “<a href="#calibre_link-82" class="calibre4">Checking Whether a String Has Only Numbers</a>” on <a href="#calibre_link-83" class="calibre4">page 158</a>. But Python already has a method that does this.</p>
<p class="indent">The string method <span class="literal1">isdigit()</span> returns <span class="literal1">True</span> if the string consists solely of numbers. Otherwise, it returns <span class="literal1">False</span>. Enter the following into the interactive shell:</p>
<p class="programs">&gt;&gt;&gt; <span class="codestrong">'42'.isdigit()</span><br class="calibre7" />True<br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">'forty'.isdigit()</span><br class="calibre7" />False<br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">''.isdigit()</span><br class="calibre7" />False<br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">'hello'.isdigit()</span><br class="calibre7" />False<br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x = '10'</span><br class="calibre7" />&gt;&gt;&gt; <span class="codestrong">x.isdigit()</span><br class="calibre7" />True</p>
<p class="indent">Both <span class="literal1">move[0].isdigit()</span> and <span class="literal1">move[1].isdigit()</span> must be <span class="literal1">True</span> for the whole condition to be <span class="literal1">True</span>. The final part of line 99’s condition calls the <span class="literal1">isOnBoard()</span> function to check whether the x- and y-coordinates exist on the board.</p>
<p class="indent">If the entire condition is <span class="literal1">True</span>, line 100 checks whether the move exists in the <span class="literal1">previousMoves</span> list. If it does, then line 102’s <span class="literal1">continue</span> statement causes the execution to go back to the start of the <span class="literal1">while</span> loop at line 92 and then ask for the player’s move again. If it doesn’t, line 103 returns a two-integer list of the x- and y-coordinates.</p>
<h3 class="h2" id="calibre_link-622"><strong class="calibre2">Printing the Game Instructions for the Player</strong></h3>
<p class="noindent">The <span class="literal1">showInstructions()</span> function is a couple of <span class="literal1">print()</span> calls that print multiline strings:</p>
<p class="programs">107. def showInstructions():<br class="calibre7" />108.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('''Instructions:<br class="calibre7" />109. You are the captain of the Simon, a treasure-hunting ship. Your current<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mission<br class="calibre7" />--<span class="codeitalic">snip</span>--<br class="calibre7" />154. Press enter to continue...''')<br class="calibre7" />155.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input()</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-375"></span>The <span class="literal1">input()</span> function gives the player a chance to press <small class="calibre11">ENTER</small> before printing the next string. This is because the IDLE window can show only so much text at a time, and we don’t want the player to have to scroll up to read the beginning of the text. After the player presses <small class="calibre11">ENTER</small>, the function returns to the line that called the function.</p>
<h3 class="h2" id="calibre_link-623"><strong class="calibre2">The Game Loop</strong></h3>
<p class="noindent">Now that we’ve entered all the functions that our game will call, let’s enter the main part of the game. The first thing the player sees after running the program is the game title printed by line 159. This is the main part of the program, which begins by offering the player instructions and then setting up the variables the game will use.</p>
<p class="programs">159. print('S O N A R !')<br class="calibre7" />160. print()<br class="calibre7" />161. print('Would you like to view the instructions? (yes/no)')<br class="calibre7" />162. if input().lower().startswith('y'):<br class="calibre7" />163. showInstructions()<br class="calibre7" />164.<br class="calibre7" />165. while True:<br class="calibre7" />166.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Game setup<br class="calibre7" />167.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonarDevices = 20<br class="calibre7" />168.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theBoard = getNewBoard()<br class="calibre7" />169.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theChests = getRandomChests(3)<br class="calibre7" />170.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drawBoard(theBoard)<br class="calibre7" />171.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousMoves = []</p>
<p class="indent">The expression <span class="literal1">input().lower().startswith('y')</span> lets the player request the instructions, and it evaluates to <span class="literal1">True</span> if the player enters a string that begins with <span class="literal1">'y'</span> or <span class="literal1">'Y'</span>. For example:</p>
<div class="image"><img src="images/00099.jpeg" alt="image" class="calibre3" /></div>
<p class="indent">If this condition is <span class="literal1">True</span>, <span class="literal1">showInstructions()</span> is called on line 163. Otherwise, the game begins.</p>
<p class="indent">Several variables are set up on lines 167 to 171; these are described in <a href="#calibre_link-84" class="calibre4">Table 13-1</a>.</p>
<p class="tablecap"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-368"></span><a id="calibre_link-84" class="calibre4"></a><strong class="calibre5">Table 13-1:</strong> Variables Used in the Main Game Loop</p>
<table class="topbot">
<thead class="calibre14">
<tr class="calibre15">
<td class="table_th"><p class="table"><strong class="calibre5">Variable</strong></p></td>
<td class="table_th"><p class="table"><strong class="calibre5">Description</strong></p></td>
</tr>
</thead>
<tbody class="calibre16">
<tr class="calibre15">
<td class="table_3a"><p class="table"><span class="literal1">sonarDevices</span></p></td>
<td class="table_3a"><p class="table">The number of sonar devices (and turns) the player has left.</p></td>
</tr>
<tr class="calibre15">
<td class="table_3a"><p class="table"><span class="literal1">theBoard</span></p></td>
<td class="table_3a"><p class="table">The board data structure used for this game.</p></td>
</tr>
<tr class="calibre15">
<td class="table_3a"><p class="table"><span class="literal1">theChests</span></p></td>
<td class="table_3a"><p class="table">The list of chest data structures. <span class="literal1">getRandomChests()</span> returns a list of three treasure chests at random places on the board.</p></td>
</tr>
<tr class="calibre15">
<td class="table_3a"><p class="table"><span class="literal1">previousMoves</span></p></td>
<td class="table_3a"><p class="table">A list of all the x and y moves the player has made in the game.</p></td>
</tr>
</tbody>
</table>
<p class="indent">We’re going to use these variables soon, so make sure to review their descriptions before moving on!</p>
<h4 class="h3" id="calibre_link-624"><em class="calibre10"><strong class="calibre2">Displaying the Game Status for the Player</strong></em></h4>
<p class="noindenta">Line 173’s <span class="literal1">while</span> loop executes as long as the player has sonar devices remaining and prints a message telling them how many sonar devices and treasure chests are left:</p>
<p class="programs">173.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while sonarDevices &gt; 0:<br class="calibre7" />174.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Show sonar device and chest statuses.<br class="calibre7" />175.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You have %s sonar device(s) left. %s treasure chest(s)<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remaining.' % (sonarDevices, len(theChests)))</p>
<p class="indent">After printing how many devices are left, the <span class="literal1">while</span> loop continues to execute.</p>
<h4 class="h3" id="calibre_link-625"><em class="calibre10"><strong class="calibre2">Handling the Player’s Move</strong></em></h4>
<p class="noindenta">Line 177 is still part of the <span class="literal1">while</span> loop and uses multiple assignment to assign the <span class="literal1">x</span> and <span class="literal1">y</span> variables to the two-item list representing the player’s move coordinates returned by <span class="literal1">enterPlayerMove()</span>. We’ll pass in <span class="literal1">previousMoves</span> so that <span class="literal1">enterPlayerMove()</span>’s code can ensure the player doesn’t repeat a previous move.</p>
<p class="programs">177.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x, y = enterPlayerMove(previousMoves)<br class="calibre7" />178.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previousMoves.append([x, y]) # We must track all moves so that<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonar devices can be updated.<br class="calibre7" />179.<br class="calibre7" />180.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;moveResult = makeMove(theBoard, theChests, x, y)<br class="calibre7" />181.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if moveResult == False:<br class="calibre7" />182.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</p>
<p class="indent">The <span class="literal1">x</span> and <span class="literal1">y</span> variables are then appended to the end of the <span class="literal1">previousMoves</span> list. The <span class="literal1">previousMoves</span> variable is a list of x- and y-coordinates of each move the player makes in this game. This list is used later in the program on lines 177 and 186.</p>
<p class="indent">The <span class="literal1">x</span>, <span class="literal1">y</span>, <span class="literal1">theBoard</span>, and <span class="literal1">theChests</span> variables are all passed to the <span class="literal1">makeMove()</span> function at line 180. This function makes the necessary modifications to place a sonar device on the board.</p>
<p class="indent"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-366"></span>If <span class="literal1">makeMove()</span> returns <span class="literal1">False</span>, then there was a problem with the <span class="literal1">x</span> and <span class="literal1">y</span> values passed to it. The <span class="literal1">continue</span> statement sends the execution back to the start of the <span class="literal1">while</span> loop on line 173 to ask the player for x- and y-coordinates again.</p>
<h4 class="h3" id="calibre_link-626"><em class="calibre10"><strong class="calibre2">Finding a Sunken Treasure Chest</strong></em></h4>
<p class="noindenta">If <span class="literal1">makeMove()</span> doesn’t return <span class="literal1">False</span>, it returns a string of the results of that move. If this string is <span class="literal1">'You have found a sunken treasure chest!'</span>, then all the sonar devices on the board should update to detect the <em class="calibre6">next</em> closest treasure chest on the board:</p>
<p class="programs">183.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br class="calibre7" />184.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if moveResult == 'You have found a sunken treasure chest!':<br class="calibre7" />185.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update all the sonar devices currently on the map.<br class="calibre7" />186.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x, y in previousMoves:<br class="calibre7" />187.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makeMove(theBoard, theChests, x, y)<br class="calibre7" />188.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;drawBoard(theBoard)<br class="calibre7" />189.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(moveResult)</p>
<p class="indent">The x- and y-coordinates of all the sonar devices are in <span class="literal1">previousMoves</span>. By iterating over <span class="literal1">previousMoves</span> on line 186, you can pass all of these x- and y-coordinates to the <span class="literal1">makeMove()</span> function again to redraw the values on the board. Because the program doesn’t print any new text here, the player doesn’t realize the program is redoing all of the previous moves. It just appears that the board updates itself.</p>
<h4 class="h3" id="calibre_link-627"><em class="calibre10"><strong class="calibre2">Checking Whether the Player Won</strong></em></h4>
<p class="noindenta">Remember that the <span class="literal1">makeMove()</span> function modifies the <span class="literal1">theChests</span> list you sent it. Because <span class="literal1">theChests</span> is a list, any changes made to it inside the function will persist after execution returns from the function. The <span class="literal1">makeMove()</span> function removes items from <span class="literal1">theChests</span> when treasure chests are found, so eventually (if the player keeps guessing correctly) all of the treasure chests will have been removed. (Remember, by “treasure chest” we mean the two-item lists of the x- and y-coordinates inside the <span class="literal1">theChests</span> list.)</p>
<p class="programs">191.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(theChests) == 0:<br class="calibre7" />192.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('You have found all the sunken treasure chests!<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Congratulations and good game!')<br class="calibre7" />193.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</p>
<p class="indent">When all the treasure chests have been found on the board and removed from <span class="literal1">theChests</span>, the <span class="literal1">theChests</span> list will have a length of <span class="literal1">0</span>. When that happens, the code displays a congratulatory message to the player and then executes a <span class="literal1">break</span> statement to break out of this <span class="literal1">while</span> loop. Execution will then move to line 197, the first line after the <span class="literal1">while</span> block.</p>
<h4 class="h3" id="calibre_link-628"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-365" class="calibre1"></span><em class="calibre10"><strong class="calibre2">Checking Whether the Player Lost</strong></em></h4>
<p class="noindenta">Line 195 is the last line of the <span class="literal1">while</span> loop that started on line 173.</p>
<p class="programs">195.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sonarDevices -= 1</p>
<p class="indent">The program decrements the <span class="literal1">sonarDevices</span> variable because the player has used one sonar device. If the player keeps missing the treasure chests, eventually <span class="literal1">sonarDevices</span> will be reduced to <span class="literal1">0</span>. After this line, execution jumps back up to line 173 so it can reevaluate the <span class="literal1">while</span> statement’s condition (which is <span class="literal1">sonarDevices &gt; 0</span>).</p>
<p class="indent">If <span class="literal1">sonarDevices</span> is <span class="literal1">0</span>, then the condition will be <span class="literal1">False</span> and execution will continue outside the <span class="literal1">while</span> block on line 197. But until then, the condition will remain <span class="literal1">True</span> and the player can keep making guesses:</p>
<p class="programs">197.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if sonarDevices == 0:<br class="calibre7" />198.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('We\'ve run out of sonar devices! Now we have to turn the<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ship around and head')<br class="calibre7" />199.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('for home with treasure chests still out there! Game<br class="calibre7" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;over.')<br class="calibre7" />200.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('&nbsp;&nbsp;&nbsp;&nbsp;The remaining chests were here:')<br class="calibre7" />201.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for x, y in theChests:<br class="calibre7" />202.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(' %s, %s' % (x, y))</p>
<p class="indent">Line 197 is the first line outside the <span class="literal1">while</span> loop. When the execution reaches this point, the game is over. If <span class="literal1">sonarDevices</span> is <span class="literal1">0</span>, you know the player ran out of sonar devices before finding all the chests and lost.</p>
<p class="indent">Lines 198 to 200 will tell the player they’ve lost. The <span class="literal1">for</span> loop on line 201 will go through the treasure chests remaining in <span class="literal1">theChests</span> and display their location so the player can see where the treasure chests were lurking.</p>
<h4 class="h3" id="calibre_link-629"><em class="calibre10"><strong class="calibre2">Terminating the Program with the sys.exit() Function</strong></em></h4>
<p class="noindenta">Win or lose, the program lets the player decide whether they want to keep playing. If the player does not enter <span class="literal1">'yes'</span> or <span class="literal1">'Y'</span> or enters some other string that doesn’t begin with the letter <em class="calibre6">y</em>, then <span class="literal1">not input().lower().startswith('y')</span> evaluates to <span class="literal1">True</span> and the <span class="literal1">sys.exit()</span> function is executed. This causes the program to terminate.</p>
<p class="programs">204.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('Do you want to play again? (yes or no)')<br class="calibre7" />205.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if not input().lower().startswith('y'):<br class="calibre7" />206.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</p>
<p class="indent">Otherwise, execution jumps back to the beginning of the <span class="literal1">while</span> loop on line 165 and a new game begins.</p>
<h3 class="h2" id="calibre_link-630"><span {http://www.idpf.org/2007/ops}type="pagebreak" id="calibre_link-897" class="calibre1"></span><strong class="calibre2">Summary</strong></h3>
<p class="noindent">Remember how our Tic-Tac-Toe game numbered the spaces on the Tic-Tac-Toe board 1 through 9? This sort of coordinate system might have been okay for a board with fewer than 10 spaces. But the Sonar Treasure Hunt board has 900 spaces! The Cartesian coordinate system we learned about in <a href="#calibre_link-72" class="calibre4">Chapter 12</a> really makes all these spaces manageable, especially when our game needs to find the distance between two points on the board.</p>
<p class="indent">Locations in games that use a Cartesian coordinate system can be stored in a list of lists in which the first index is the x-coordinate and the second index is the y-coordinate. This makes it easy to access a coordinate using <span class="literal1">board[x][y]</span>.</p>
<p class="indent">These data structures (such as the ones used for the ocean and treasure chest locations) make it possible to represent complex concepts as data, and your game programs become mostly about modifying these data structures.</p>
<p class="indent">In the next chapter, we’ll represent letters as numbers. By representing text as numbers, we can perform math operations on them to encrypt or decrypt secret messages.</p>
</div>



<a href="chapter12.html">Prev: Chapter 12 - The Cartesian Coordinate System</a> | <a href="chapter14.html">Next: Chapter 14 - Caesar Cipher</a>
</body></html>