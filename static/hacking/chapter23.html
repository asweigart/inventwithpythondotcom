<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><img width=409
height=225 id="Picture 44" src="chapter23_files/image001.jpg"> </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630932"><span style='font-variant:normal !important;
text-transform:uppercase'>Finding Prime Numbers</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Prime and Composite Numbers</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Sieve of Eratosthenes</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Rabin-Miller Primality Test</p>

</div>

<p class=ChapterQuotesCxSpFirst>“Mathematicians have tried in vain to this day
to discover some order in the sequence of prime numbers, and we have reason to
believe that it is a mystery into which the human mind will never penetrate.”</p>

<p class=ChapterQuotesCxSpMiddle>&nbsp;</p>

<p class=ChapterQuotesCxSpLast align=right style='text-align:right'> <span
style='font-size:11.0pt;line-height:115%'>Leonhard Euler, 18<sup>th</sup>
century mathematician</span></p>

<p class=MsoNormal>All of the ciphers described in this book so far have been
around for hundreds of years, and all of them (with the exception of the one-time
pad) are easily broken by computers. These ciphers worked very well when hackers
had to rely on pencil and paper to hack them, but computers can now manipulate
data trillions of times faster than a person with a pencil.</p>

<p class=MsoNormal>The RSA cipher has several improvements over these old
ciphers, and it will be detailed in the next chapter. However, the RSA cipher
will require us to learn about prime numbers first.</p>

<h2><a name="_Toc353630933">Prime Numbers</a></h2>

<p class=MsoNormal>A prime number is an integer (that is, a whole number) that is
greater than 1 and has only two factors: 1 and itself. Remember that the
factors of a number are the numbers that can be multiplied to equal the
original number. The numbers 3 and 7 are factors of 21. The number 12 has
factors 2 and 6, but also 3 and 4.</p>

<p class=MsoNormal>Every number has factors of 1 and itself. The numbers 1 and
21 are factors of 21. The numbers 1 and 12 are factors of 12. This is because 1
times any number will always be that same number. But if no other factors exist
for that number, then that number is <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>prime</span></span>.</p>

<p class=MsoNormal>Here’s a list of prime numbers (note that 1 is not
considered a prime number):</p>

<p class=MsoNormal>2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53,
59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137,
139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227,
229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281 …and so on, <strong><span
style='font-family:"Calibri","sans-serif"'>FOREVER</span></strong>.</p>

<p class=MsoNormal>There are an infinite number of prime numbers. This means
there is no “largest” prime. They just keep getting bigger and bigger, just
like regular numbers do. (See <span class=URL><u>http://invpy.com/infiniteprimes</u></span>
for a proof of this.) The RSA cipher makes use of very large prime numbers in
the keys it uses. Because of this, there will be far too many keys to brute-force
through. </p>

<p class=MsoNormal>A <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>googol</span></span> is the number that has a one with a
hundred zeros behind it:</p>

<p class=MsoNormal>10,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000</p>

<p class=MsoNormal>(As a bit of history: the name of the search engine company
Google came from misspelling “googol”, but they decided they liked that
spelling better and kept it.)</p>

<p class=MsoNormal>A <strong><span style='font-family:"Calibri","sans-serif"'>billion
billion billion googols</span></strong> has twenty-seven more zeros than a
googol:</p>

<p class=MsoNormal>10,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000</p>

<p class=MsoNormal>But these are tiny numbers. A typical prime number used in
our RSA program will have hundreds of digits:</p>

<p class=MsoNormal>112,829,754,900,439,506,175,719,191,782,841,802,172,556,768,253,593,054,977,186,2355,84,979,780,304,652,423,405,148,425,447,063,090,165,759,070,742,102,132,335,103,295,947,000,718,386,333,756,395,799,633,478,227,612,244,071,875,721,006,813,307,628,061,280,861,610,153,485,352,017,238,548,269,452,852,733,818,231,045,171,038,838,387,845,888,589,411,762,622,041,204,120,706,150,518,465,720,862,068,595,814,264,819</p>

<p class=MsoNormal>The above number is so big, I’m going to guess you didn’t
even read it to notice the typo in it.</p>

<h2><a name="_Toc353630934">Composite Numbers</a></h2>

<p class=MsoNormal>Integers that are not prime numbers are called <span
class=Definition><span style='font-size:12.0pt;line-height:115%'>composite</span></span>
numbers, because they are composed of at least two factors besides 1 and the
number itself. They are called composite numbers because these number are composed
of prime numbers multiplied together, such as the composite number 1,386 being
composed of the prime numbers in 2 × 3 × 3 × 7 × 11.</p>

<p class=MsoNormal>Here are four facts about prime numbers:</p>

<p class=MsoListParagraphCxSpFirst style='margin-right:22.5pt;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Prime
numbers are integers greater than 1that have only 1 and themselves as factors.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:22.5pt;text-indent:
-.25in'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Two is the only even prime number. (Though I guess that makes two a very
odd prime number.)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-right:22.5pt;text-indent:
-.25in'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>There are an infinite number of prime numbers. There is no “largest
prime number”.</p>

<p class=MsoListParagraphCxSpLast style='margin-right:22.5pt;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Multiplying
two prime numbers will give a number that only has two pairs of factors, 1 and
itself (like all numbers do), and the two prime numbers that were multiplied.
For example, 3 and 7 are prime numbers. 3 times 7 is 21. The only factors for
21 are 1, 21, 3, and 7.</p>

<h2><a name="_Toc353630935">Source Code for The Prime Sieve Module</a></h2>

<p class=MsoNormal>First we will create a module that has functions related to
prime numbers:</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=Literal>isPrime()</span> will return either True or
False if the number passed to it is prime or not. It will use the “divides
test” algorithm.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class=Literal>primeSieve()</span> will use the “Sieve of
Eratosthenes” algorithm (explained later) to generate numbers.</p>

<p class=MsoNormal>Like <span class=Filename>cryptomath.py</span>, the <span
class=Filename>primeSieve.py</span> program is only meant to be imported as a
module to our other programs. It does not do anything when run on its own.</p>

<p class=MsoNormal>Open a new file editor window by clicking on <strong><span
style='font-family:"Calibri","sans-serif"'>File</span></strong> &#9658; <strong><span
style='font-family:"Calibri","sans-serif"'>New Window</span></strong>. Type in
the following code into the file editor, and then save it as <span
class=Filename>primeSieve.py</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for primeSieve.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># Prime Number Sieve</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 4.</span>
import math</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 7.</span>
def isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 8.</span>    
<span class=SourceCodeComment># Returns True if num is a prime number,
otherwise False.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>10.</span>    
<span class=SourceCodeComment># Note: Generally, isPrime() is slower than
primeSieve().</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>11. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>12.</span>    
<span class=SourceCodeComment># all numbers less than 2 are not prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>13.</span>    
if num &lt; 2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>14.</span>        
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>15. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>16.</span>    
<span class=SourceCodeComment># see if num is divisible by any number up to the
square root of num</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>17.</span>    
for i in range(2, int(math.sqrt(num)) + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>18.</span>        
if num % i == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>19.</span>            
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>20.</span>    
return True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>21. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>22. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>23.</span>
def primeSieve(sieveSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>24.</span>    
<span class=SourceCodeComment># Returns a list of prime numbers calculated
using</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>25.</span>    
<span class=SourceCodeComment># the Sieve of Eratosthenes algorithm.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>26. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>27.</span>    
sieve = [True] * sieveSize</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>28.</span>    
sieve[0] = False <span class=SourceCodeComment># zero and one are not prime
numbers</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>29.</span>    
sieve[1] = False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>30. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>31.</span>    
<span class=SourceCodeComment># create the sieve</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>32.</span>    
for i in range(2, int(math.sqrt(sieveSize)) + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>33.</span>        
pointer = i * 2</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>34.</span>        
while pointer &lt; sieveSize:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>35.</span>            
sieve[pointer] = False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>36.</span>            
pointer += i</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>37. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>38.</span>    
<span class=SourceCodeComment># compile the list of primes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>39.</span>    
primes = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>40.</span>    
for i in range(sieveSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>41.</span>        
if sieve[i] == True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>42.</span>            
primes.append(i)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>43. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>44.</span>    
return primes</p>

</div>

<h2><a name="_Toc353630936">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>primeSieve.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment> 1.</span> <span
class=SourceCodeComment># Prime Number Sieve</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 3. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment> 4.</span>
import math</p>

</div>

<p class=MsoNormal>The only module <span class=Filename>primeSieve.py</span>
needs is the <span class=Literal>math</span> module.</p>

<h2><a name="_Toc353630937">How to Calculate if a Number is Prime</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>primeSieve.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment> 7.</span>
def isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 8.</span>    
<span class=SourceCodeComment># Returns True if num is a prime number, otherwise
False.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>10.</span>    
<span class=SourceCodeComment># Note: Generally, isPrime() is slower than
primeSieve().</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>11. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>12.</span>    
<span class=SourceCodeComment># all numbers less than 2 are not prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>13.</span>    
if num &lt; 2:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>14.</span>        
return False</p>

</div>

<p class=MsoNormal>We will program the <span class=Literal>isPrime()</span>
function to return <span class=Literal>False</span> if the <span class=Literal>num</span>
parameter is a composite number and <span class=Literal>True</span> if the <span
class=Literal>num</span> parameter is a prime number. If <span class=Literal>num</span>
is less than <span class=Literal>2</span> we know it is not prime and can
simply return <span class=Literal>False</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>primeSieve.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>16.</span>    
<span class=SourceCodeComment># see if num is divisible by any number up to the
square root of num</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>17.</span>    
for i in range(2, int(math.sqrt(num)) + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>18.</span>        
if num % i == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>19.</span>            
return False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>20.</span>    
return True</p>

</div>

<p class=MsoNormal>A prime number has no factors besides 1 and itself. So to
find out if a given number is prime or not, we just have to keep dividing it by
integers and see if any of them evenly divide the number with 0 remainder.</p>

<p class=MsoNormal>The <span class=Literal>math.sqrt()</span> function will
return a float value of the square root of the number it is passed. The square
root of a number can be multiplied by itself to get the number. For example,
the square root of 49 is 7, because 7 × 7 is 49.</p>

<p class=MsoNormal>For example, to find out if 49 is prime, divide it by the
integers starting with 2:</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 2 = 24 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 3 = 16 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 4 = 12 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 5 = 9 remainder
4</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 6 = 8 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>49 ÷ 7 = 7 remainder
0</p>

<p class=MsoNormal>Actually, you only need to divide the number by prime
numbers. For example, there’s no reason to see if 6 divides 49, because if it
did then 2 would have divided 49 since 2 is a factor of 6. <em><span
style='font-family:"Calibri","sans-serif"'>Any</span></em> number that 6
divides evenly can also be divided by 2 evenly:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=469
height=278 id="Picture 66" src="chapter23_files/image002.png"></p>

<p class=FigureCaption>Figure 23-1. 2 divides 6, and 6 divides X, therefore 2
divides X.</p>

<p class=MsoNormal>Because there’s an integer (that is not 1 or 49) that evenly
divides 49 (that is, has a remainder of 0), we know that 49 is not a prime
number. For another example, let’s try 13:</p>

<p class=MsoNormal align=center style='text-align:center'>13 ÷ 2 = 6 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>13 ÷ 3 = 4 remainder
1</p>

<p class=MsoNormal align=center style='text-align:center'>13 ÷ 4 = 3 remainder
1</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>No integer divides 13 with a remainder of 0 (except
for 1 and 13, which don’t count). Actually, we don’t even have to divide <strong><span
style='font-family:"Calibri","sans-serif"'>all</span></strong> the numbers up
to 13. We only have to test the integers up to (and including) the square root
of the number we are testing for primality. The <span class=Definition><span
style='font-size:12.0pt'>square root</span></span> of a number is the number
that is multiplied by itself to get that first number. The square root of 25 is
5, because 5 <span style='font-size:12.0pt'>×</span> 5 = 25. The square root of
13 is about 3.6055512754639, because 3.6055512754639 <span style='font-size:
12.0pt'>×</span> 3.6055512754639 = 13. This means that when we were testing 13
for primality, we only had to divide 2 and 3 because 4 is larger than the
square root of 13.</p>

<p class=MsoNormal>Line 18 checks if the remainder of division is 0 by using
the <span class=Literal>%</span> mod operator. If line 17’s <span
class=Literal>for</span> loop never returns <span class=Literal>False</span>,
the function will return <span class=Literal>True</span> on line 20.</p>

<h2><a name="_Toc353630938">The Sieve of Eratosthenes</a></h2>

<p class=MsoNormal>The sieve of Eratosthenes (pronounced “era, taws, thuh,
knees”) is an algorithm for calculating prime numbers. Imagine a bunch of boxes
for each integer, all marked “prime”:</p>

<p class=TableCaption>Table 23-1. A blank sieve of Eratosthenes, with each
number marked as “prime”.</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>1</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>2</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>3</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>4</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>5</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>6</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>7</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>8</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>9</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>10</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>11</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>12</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>13</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>14</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>15</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>16</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>17</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>18</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>19</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>20</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>21</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>22</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>23</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>24</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>25</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>26</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>27</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>28</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>29</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>30</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>31</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>32</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>33</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>34</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>35</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>36</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>37</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>38</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>39</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>40</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>41</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>42</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>43</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>44</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>45</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>46</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>47</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>48</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>49</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>50</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:12.0pt'>Mark 1 as “Not Prime” (since one
is never prime). Then mark all the multiples of two (except for two itself) as
“Not Prime”. This means we will mark the integers 4 (2 × 2), 6 (2 × 3), 8 (2 ×
4), 10, 12, and so on up to 50 (the largest number we have) are all marked as
“Not Prime”:</p>

<p class=TableCaption>Table 23-2. The sieve with one and the multiples of 2
(except 2 itself) marked as “not prime”.</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>1</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>2</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>3</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>4</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>5</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>6</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>7</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>8</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>9</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>10</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>11</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>12</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>13</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>14</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>15</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>16</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>17</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>18</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>19</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>20</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>21</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>22</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>23</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>24</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>25</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>26</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>27</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>28</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>29</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>30</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>31</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>32</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>33</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>34</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>35</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>36</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>37</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>38</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>39</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>40</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>41</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>42</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>43</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>44</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>45</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>46</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>47</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>48</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>49</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>50</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Then repeat this with all the multiples of three, except for
three itself: 6, 9, 12, 15, 18, 21, and so on are all marked “Not Prime”. Then
do this for all of the multiples of four (except for four itself), and all of
the multiples of five (except for five itself), up until eight. We stop at 8
because it is larger than 7.071, the square root of 50). We can do this because
all the multiples of 9, 10, 11, and so on will already have been marked.</p>

<p class=MsoNormal>The completed sieve looks like this:</p>

<p class=TableCaption>Table 23-3. A completed sieve of Eratosthenes.</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>1</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>2</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>3</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>4</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>5</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>6</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>7</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>8</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>9</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-top:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>10</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>11</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>12</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>13</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>14</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>15</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>16</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>17</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>18</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>19</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>20</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>21</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>22</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>23</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>24</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>25</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>26</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>27</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>28</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>29</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>30</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>31</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>32</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>33</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>34</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>35</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>36</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>37</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>38</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>39</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;background:#A6A6A6;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>40</p>
  </td>
 </tr>
 <tr>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>41</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>42</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>43</p>
  </td>
  <td width=74 valign=top style='width:44.25pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>44</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>45</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>46</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>&nbsp;</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>47</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>48</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>49</p>
  </td>
  <td width=74 valign=top style='width:44.3pt;border:none;border-bottom:double windowtext 1.5pt;
  background:#A6A6A6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableListing>Not</p>
  <p class=TableListing>Prime</p>
  <p class=TableListing>50</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>By using the sieve of Erastothenes, we’ve calculated that
the prime numbers under 50 are 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41,
43, and 47. This sieve algorithm is good when we want to quickly find out all
the prime numbers <em><span style='font-family:"Calibri","sans-serif"'>in a
certain range</span></em> of numbers. It is much faster than using the previous
“divides test” algorithm to test if 2 is prime, then test if 3 is prime, then
test if 4 is prime, and so on.</p>

<h2><a name="_Toc353630939">The </a><span class=Literal>primeSieve()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>23.</span>
def primeSieve(sieveSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>24.</span>    
<span class=SourceCodeComment># Returns a list of prime numbers calculated
using</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>25.</span>    
<span class=SourceCodeComment># the Sieve of Eratosthenes algorithm.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>26. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>27.</span>    
sieve = [True] * sieveSize</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>28.</span>    
sieve[0] = False <span class=SourceCodeComment># zero and one are not prime
numbers</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>29.</span>    
sieve[1] = False</p>

</div>

<p class=MsoNormal>The <span class=Literal>primeSieve()</span> function returns
a list of all prime numbers between <span class=Literal>1</span> and <span
class=Literal>sieveSize</span>. First, line 27 creates a list of Boolean <span
class=Literal>True</span> values that is the length of <span class=Literal>sieveSize</span>.
The <span class=Literal>0</span> and <span class=Literal>1</span> indexes are
marked as <span class=Literal>False</span> because <span class=Literal>0</span>
and <span class=Literal>1</span> are not prime numbers.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>31.</span>    
<span class=SourceCodeComment># create the sieve</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>32.</span>    
for i in range(2, int(math.sqrt(sieveSize)) + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>33.</span>        
pointer = i * 2</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>34.</span>        
while pointer &lt; sieveSize:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>35.</span>            
sieve[pointer] = False</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>36.</span>            
pointer += i</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 32 goes
through each integer from <span class=Literal>2</span> up to the square root of
<span class=Literal>sieveSize</span>. The variable <span class=Literal>pointer</span>
will start at the first multiple of <span class=Literal>i</span> after <span
class=Literal>i</span> (which will be <span class=Literal>i * 2</span>). Then
the <span class=Literal>while</span> loop will set the <span class=Literal>pointer</span>
index in the <span class=Literal>sieve</span> list to <span class=Literal>False</span>,
and line 36 will change <span class=Literal>pointer</span> to point to the next
multiple of <span class=Literal>i</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceCodeComment>38.</span>    
<span class=SourceCodeComment># compile the list of primes</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>39.</span>    
primes = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>40.</span>    
for i in range(sieveSize):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceCodeComment>41.</span>        
if sieve[i] == True:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceCodeComment>42.</span>            
primes.append(i)</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 32
completes, the <span class=Literal>sieve</span> list will contain <span
class=Literal>True</span> for each index that is a prime number. We can create
a new list (which starts as an empty list in primes) and loop over the entire <span
class=Literal>sieve</span> list, and appends and numbers if <span
class=Literal>sieve[i]</span> is <span class=Literal>True</span> (meaning <span
class=Literal>i</span> is prime).</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeatured><span class=SourceCodeComment>44.</span>     return
primes</p>

</div>

<p class=MsoNormal>The list of prime numbers is returned on line 44.</p>

<h2><a name="_Toc353630940">Detecting Prime Numbers</a></h2>

<p class=MsoNormal>The <span class=Literal>isPrime()</span> function in <span
class=Filename>primeSieve.py</span> checks if the number can be divided evenly
by a range of numbers from 2 to the square root of the number. But what about a
number like 1,070,595,206,942,983? If you pass this integer to <span
class=Literal>isPrime()</span>, it takes several seconds to determine if it is
prime or not. And if the number is hundreds of digits long (like the prime
numbers in next chapter’s RSA cipher program are), it would take over a
trillion years to figure out if that <em><span style='font-family:"Calibri","sans-serif"'>one</span></em>
number is prime or not.</p>

<p class=MsoNormal>The <span class=Literal>isPrime()</span> function in <span
class=Filename>primeSieve.py</span> is too slow for the large numbers we will
use in the RSA cipher. Fortunately there is an algorithm called the
Rabin-Miller Primality Test than can calculate if such large numbers are prime
or not. We will create a new <span class=Literal>isPrime()</span> function in <span
class=Filename>rabinMiller.py</span> that makes use of this better algorithm.</p>

<p class=MsoNormal>The code for this algorithm uses advanced mathematics, and
how the algorithm works is beyond the scope of this book. Like the <span
class=Literal>gcd()</span> function in <span class=Filename>cryptomath.py</span>,
this book will just present the code for the algorithm for you to use without
explanation.</p>

<h2><a name="_Toc353630941">Source Code for the Rabin-Miller Module</a></h2>

<p class=MsoNormal>Open a new file editor window and type in the following
code. Save this file as <span class=Filename>rabinMiller.py</span>. This
program will be a module that is meant to be imported by other programs.</p>

<p class=MsoNormal>Instead of typing out the list of numbers on line 43, just
temporarily add the lines <span class=Literal>import pyperclip</span> and <span
class=Literal>pyperclip.copy(primeSieve(1000))</span> in the <span
class=Filename>primeSieve.py</span> file and run it. This will copy the list of
primes to the clipboard, and then you can paste it into the <span
class=Filename>rabinMiller.py</span> file.</p>

<p class=MsoNormal>Open a new file editor window by clicking on <strong><span
style='font-family:"Calibri","sans-serif"'>File</span></strong> &#9658; <strong><span
style='font-family:"Calibri","sans-serif"'>New Window</span></strong>. Type in
the following code into the file editor, and then save it as <span
class=Filename>rabinMiller.py</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for rabinMiller.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Primality Testing with the Rabin-Miller Algorithm</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
import random</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7.</span>
def rabinMiller(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>    
<span class=SourceCodeComment># Returns True if num is a prime number.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
s = num - 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
t = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>    
while s % 2 == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13.</span>        
<span class=SourceCodeComment># keep halving s while it is even (and use t</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>        
<span class=SourceCodeComment># to count how many times we halve s)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>        
s = s // 2</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>        
t += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>    
for trials in range(5): <span class=SourceCodeComment># try to falsify num's
primality 5 times</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>        
a = random.randrange(2, num - 1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>        
v = pow(a, s, num)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>        
if v != 1: <span class=SourceCodeComment># this test does not apply if v is 1.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>            
i = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>            
while v != (num - 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24.</span>                
if i == t - 1:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25.</span>                    
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>                
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>                    
i = i + 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28.</span>                    
v = (v ** 2) % num</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29.</span>    
return True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>31. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>32.</span>
def isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>    
<span class=SourceCodeComment># Return True if num is a prime number. This
function does a quicker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>34.</span>    
<span class=SourceCodeComment># prime number check before calling rabinMiller().</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36.</span>    
if (num &lt; 2):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>37.</span>        
return False <span class=SourceCodeComment># 0, 1, and negative numbers are not
prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>38. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>39.</span>    
<span class=SourceCodeComment># About 1/3 of the time we can quickly determine
if num is not prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>40.</span>    
<span class=SourceCodeComment># by dividing by the first few dozen prime
numbers. This is quicker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41.</span>    
<span class=SourceCodeComment># than rabinMiller(), but unlike rabinMiller() is
not guaranteed to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>42.</span>    
<span class=SourceCodeComment># prove that a number is prime.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>43.</span>     lowPrimes
= [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,
73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157,
163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241,
251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347,
349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439,
443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547,
557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643,
647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751,
757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859,
863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977,
983, 991, 997]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>44. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>45.</span>    
if num in lowPrimes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>46.</span>        
return True</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>47. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>48.</span>    
<span class=SourceCodeComment># See if any of the low prime numbers can divide
num</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>49.</span>    
for prime in lowPrimes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>50.</span>        
if (num % prime == 0):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>51.</span>            
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>52. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>53.</span>    
<span class=SourceCodeComment># If all else fails, call rabinMiller() to
determine if num is a prime.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>54.</span>    
return rabinMiller(num)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>56. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>57.</span>
def generateLargePrime(keysize=1024):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>58.</span>    
<span class=SourceCodeComment># Return a random prime number of keysize bits in
size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>59.</span>    
while True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>        
num = random.randrange(2**(keysize-1), 2**(keysize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>61.</span>        
if isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>62.</span>            
return num</p>

</div>

<h2><a name="_Toc353630942">Sample Run of the Rabin Miller Module</a></h2>

<p class=MsoNormal>If you run the interactive shell, you can import the <span
class=Filename>rabinMiller.py</span> module and call the functions in it. Try
typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import rabinMiller</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
rabinMiller.generateLargePrime()</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>122881168342211041030523683515443239007484290600701555369488271748378054744009463751312511471291011945732413378446666809140502037003673211052153493607681619990563076859566835016382556518967124921538212397036345815983641146000671635019637218348455544435908428400192565849620509600312468757953899553441648428119</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
rabinMiller.isPrime(45943208739848451)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>False</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
rabinMiller.isPrime(13)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>True </p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<h2><a name="_Toc353630943">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Primality Testing with the Rabin-Miller Algorithm</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 4.</span>
import random</p>

</div>

<p class=MsoNormal>The Rabin-Miller algorithm uses random numbers, so we import
the <span class=Literal>random</span> module on line 4.</p>

<h2><a name="_Toc353630944">The Rabin-Miller Primality Algorithm</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 7.</span>
def rabinMiller(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>    
<span class=SourceCodeComment># Returns True if num is a prime number.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
s = num - 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
t = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>    
while s % 2 == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13.</span>        
<span class=SourceCodeComment># keep halving s while it is even (and use t</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>        
<span class=SourceCodeComment># to count how many times we halve s)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>        
s = s // 2</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>        
t += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>    
for trials in range(5): <span class=SourceCodeComment># try to falsify num's
primality 5 times</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>        
a = random.randrange(2, num - 1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>        
v = pow(a, s, num)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>        
if v != 1: <span class=SourceCodeComment># this test does not apply if v is 1.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>            
i = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>            
while v != (num - 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24.</span>                
if i == t - 1:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25.</span>                    
return False</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>                
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>                    
i = i + 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28.</span>                    
v = (v ** 2) % num</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>29.</span>    
return True</p>

</div>

<p class=MsoNormal>The mathematics of the Rabin-Miller Primality algorithm are
beyond the scope of this book, so the code in this function will not be
explained.</p>

<p class=MsoNormal>The Rabin-Miller algorithm is also not a surefire test for
primality; however, you can be extremely certain that it is accurate. (Although
this is not good enough for commercial encryption software, it is good enough
for the purposes of the programs in this book.) The main benefit of the
Rabin-Miller algorithm is that it is a relatively simple primality test and
only takes a few seconds to run on a normal computer.</p>

<p class=MsoNormal>If <span class=Literal>rabinMiller()</span> returns <span
class=Literal>True</span>, then the <span class=Literal>num</span> argument is
extremely likely to be prime. If <span class=Literal>rabinMiller()</span>
returns <span class=Literal>False</span>, then <span class=Literal>num</span>
is definitely composite.</p>

<h2><a name="_Toc353630945">The New and Improved </a><span class=Literal>isPrime()</span>
Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>32.</span>
def isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>    
<span class=SourceCodeComment># Return True if num is a prime number. This
function does a quicker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>34.</span>    
<span class=SourceCodeComment># prime number check before calling
rabinMiller().</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36.</span>    
if (num &lt; 2):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>37.</span>        
return False <span class=SourceCodeComment># 0, 1, and negative numbers are not
prime</span></p>

</div>

<p class=MsoNormal>All numbers that are less than two (such as one, zero, and
negative numbers) are all not prime, so we can immediately return <span
class=Literal>False</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>39.</span>    
<span class=SourceCodeComment># About 1/3 of the time we can quickly determine
if num is not prime</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>40.</span>    
<span class=SourceCodeComment># by dividing by the first few dozen prime
numbers. This is quicker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>41.</span>    
<span class=SourceCodeComment># than rabinMiller(), but unlike rabinMiller() is
not guaranteed to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>42.</span>    
<span class=SourceCodeComment># prove that a number is prime.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>43.</span>     lowPrimes
= [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,
73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157,
163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241,
251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347,
349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439,
443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547,
557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643,
647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751,
757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859,
863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977,
983, 991, 997]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>44. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>45.</span>    
if num in lowPrimes:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>46.</span>        
return True</p>

</div>

<p class=MsoNormal>The numbers in the <span class=Literal>lowPrimes</span> list
are primes. (Duh.) We can immediately return <span class=Literal>True</span> if
<span class=Literal>num</span> is in the <span class=Literal>lowPrimes</span>
list.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>48.</span>    
<span class=SourceCodeComment># See if any of the low prime numbers can divide
num</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>49.</span>    
for prime in lowPrimes:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>50.</span>        
if (num % prime == 0):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>51.</span>            
return False</p>

</div>

<p class=MsoNormal>Line 49 loops through each of the prime numbers in the <span
class=Literal>lowPrimes</span> list. The integer in <span class=Literal>num</span>
is modded with the <span class=Literal>%</span> mod operator by each prime
number on line 50, and if this evaluates to <span class=Literal>0</span> then
we know that <span class=Literal>prime</span> divides <span class=Literal>num</span>
and so <span class=Literal>num</span> is not prime. In that case, line 51
returns <span class=Literal>False</span>.</p>

<p class=MsoNormal>Checking if <span class=Literal>num</span> is divisible by
all the primes under 1000 won’t tell us if the number is prime, but it might
tell us if the number is composite. About 30% of the random numbers that <span
class=Literal>generateLargePrime()</span> creates that are composite will be
detected as composite by dividing by the low prime numbers. Dividing by the low
prime numbers is much faster than executing the full Rabin-Miller algorithm on
the number, so this shortcut can make our program execute much more quickly.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>53.</span>    
<span class=SourceCodeComment># If all else fails, call rabinMiller() to
determine if num is a prime.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>54.</span>    
return rabinMiller(num)</p>

</div>

<p class=MsoNormal>Those are all the quick tests to determine if a number is
prime or not. But if <span class=Literal>num</span> does not match any of those
tests, then it is passed to the <span class=Literal>rabinMiller()</span>
function to check if it is prime or not. The return value of <span
class=Literal>rabinMiller()</span> will be returned by <span class=Literal>isPrime()</span>.</p>

<p class=MsoNormal>The comment on line 53 means call the <span class=Literal>rabinMiller()</span>
<em><span style='font-family:"Calibri","sans-serif"'>function</span></em> to
determine if the number is prime. Please do not call Dr. Rabin or Dr. Miller
personally to ask them if your number is prime.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>rabinMiller.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>57.</span>
def generateLargePrime(keysize=1024):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>58.</span>    
<span class=SourceCodeComment># Return a random prime number of keysize bits in
size.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>59.</span>    
while True:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>60.</span>        
num = random.randrange(2**(keysize-1), 2**(keysize))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>61.</span>        
if isPrime(num):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>62.</span>            
return num</p>

</div>

<p class=MsoNormal>The <span class=Literal>generateLargePrime()</span> function
will return an integer that is prime. It does this by coming up with a large
random number, storing it in <span class=Literal>num</span>, and then passing <span
class=Literal>num</span> to <span class=Literal>isPrime()</span>. The <span
class=Literal>isPrime()</span> function will then test to see if <span
class=Literal>num</span> is composite and then pass the <span class=Literal>num</span>
to <span class=Literal>rabinMiller()</span> for a more thorough (and
computationally expensive) primality test.</p>

<p class=MsoNormal>If the number <span class=Literal>num</span> is prime, then
line 62 returns <span class=Literal>num</span>. Otherwise the infinite loop
goes back to line 60 to try a new random number. This loop keeps trying over
and over again until it finds a number that the <span class=Literal>isPrime()</span>
function says is prime.</p>

<h2><a name="_Toc353630946">Summary</a></h2>

<p class=MsoNormal>Prime numbers have fascinating properties in mathematics. As
you will learn in the next chapter, they are also the backbone of ciphers used
in actual professional encryption software. The definition of a prime number is
simple enough: a number that only has one and itself as factors. But
determining which numbers are prime and which are composite (that is, not
prime) takes some clever code.</p>

<p class=MsoNormal>Modding a number with all the numbers from two up to the
square root of the number is how our <span class=Literal>isPrime()</span>
function determines if that number is prime or not. A prime number will never
have a remainder of 0 when it is modded by any number (besides its factors, 1
and itself.) But this can take a while for the computer to calculate when
testing large numbers for primality.</p>

<p class=MsoNormal>The sieve of Erastothenes can be used to quickly tell if a
range of numbers is prime or not, but this requires a lot of memory.</p>

<p class=MsoNormal>The RSA cipher makes use of extremely large prime numbers
that are hundreds of digits long. The Sieve of Erastothenes and the basic <span
class=Literal>isPrime()</span> function we have in <span class=Filename>primeSieve.py</span>
aren’t sophisticated enough to handle numbers this large.</p>

<p class=MsoNormal>The Rabin-Miller algorithm uses some mathematics which has
simple code (but the mathematical reasoning behind it is too complex for this
book), but it allows us to determine if a number that is hundreds of digits
long is prime.</p>

<p class=MsoNormal>In the next chapter, we will use the prime number code we
developed for the <span class=Filename>rabinMiller.py</span> module in our RSA
Cipher program. At last, we will have a cipher easier to use than the one-time
pad cipher but that cannot be hacked by the simple hacker techniques in this
book!</p>

</div>

</body>

</html>
