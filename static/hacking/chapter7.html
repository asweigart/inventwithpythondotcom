<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 121" src="chapter7_files/image001.jpg"></p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630666"><span style='font-variant:normal !important;
text-transform:uppercase'>Hacking the Caesar Cipher with the Brute-Force
Technique</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Kerckhoffs’s Principle and Shannon’s Maxim </p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The brute-force technique</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>range()</span> function</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>String formatting (string interpolation)</p>

</div>

<h2><a name="_Toc353630667">Hacking Ciphers</a></h2>

<p class=MsoNormal>We can hack the Caesar cipher by using a cryptanalytic
technique called “brute-force”. Because our code breaking program is so
effective against the Caesar cipher, you shouldn’t use it to encrypt your
secret information.</p>

<p class=MsoNormal>Ideally, the ciphertext would never fall into anyone’s hands.
But <span class=Definition><span style='font-size:12.0pt;line-height:115%'>Kerckhoffs’s
Principle</span></span> (named after the19th-century cryptographer Auguste
Kerckhoffs) says that a cipher should still be secure even if everyone else
knows how the cipher works and has the ciphertext (that is, everything except
the key). This was restated by the 20<sup>th</sup> century mathematician Claude
Shannon as <span class=Definition><span style='font-size:12.0pt;line-height:
115%'>Shannon’s Maxim</span></span>: “The enemy knows the system.”</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse'>
 <tr style='height:189.0pt'>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:189.0pt'>
  <p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>
  <p class=MsoNormal align=center style='text-align:center'><img width=144
  height=197 id="Picture 103" src="chapter7_files/image002.jpg"></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:189.0pt'>
  <p class=MsoNormal align=center style='text-align:center'><img width=198
  height=245 id="Picture 104" src="chapter7_files/image003.jpg"></p>
  </td>
 </tr>
 <tr style='height:.45in'>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:.45in'>
  <p class=FigureCaptionCxSpFirst>Figure 7-1. Auguste Kerckhoffs</p>
  <p class=FigureCaptionCxSpMiddle>January 19, 1835 - August 9, 1903</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:.45in'>
  <p class=FigureCaptionCxSpMiddle>Figure 7-2. Claude Shannon</p>
  <p class=FigureCaptionCxSpLast>April 30, 1916 - February 24, 2001</p>
  </td>
 </tr>
 <tr style='height:48.15pt'>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:48.15pt'>
  <p class=MsoNormal align=center style='text-align:center'>“A cryptosystem
  should be secure even if everything about the system, except the key, is
  public knowledge.”</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt;
  height:48.15pt'>
  <p class=MsoNormal align=center style='text-align:center'>“The enemy knows
  the system.”</p>
  </td>
 </tr>
</table>

<h2><a name="_Toc353630668">The Brute-Force Attack</a></h2>

<p class=MsoNormal>Nothing stops a cryptanalyst from guessing one key, decrypting
the ciphertext with that key, looking at the output, and if it was not the
correct key then moving on to the next key. The technique of trying every
possible decryption key is called a <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>brute-force attack</span></span>. It
isn’t a very sophisticated hack, but through sheer effort (which the computer will
do for us) the Caesar cipher can be broken.</p>

<h2><a name="_Toc353630669">Source Code of the Caesar Cipher Hacker Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong>File</strong>
&#9658; <strong>New Window</strong>. Type in the following code into the file
editor, and then save it as <span class=Filename>caesarHacker.py</span>. Press <strong>F5</strong>
to run the program. Note that first you will need to download the <span
class=Filename>pyperclip.py</span> module and place this file in the same
directory as the <span class=Filename>caesarHacker.py</span> file. You can
download this file from <span class=URL><u>http://invpy.com/pyperclip.py</u></span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for caesarHacker.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Caesar Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
message = 'GUVF VF ZL FRPERG ZRFFNTR.'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7.</span> <span
class=SourceCodeComment># loop through every possible key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>
for key in range(len(LETTERS)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
<span class=SourceCodeComment># It is important to set translated to the blank
string so that the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
<span class=SourceCodeComment># previous iteration's value for translated is cleared.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>    
translated = ''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>    
<span class=SourceCodeComment># The rest of the program is the same as the
original Caesar program:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>    
<span class=SourceCodeComment># run the encryption/decryption code on each
symbol in the message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>    
for symbol in message:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>        
if symbol in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>            
num = LETTERS.find(symbol) <span class=SourceCodeComment># get the number of
the symbol</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>            
num = num - key</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>            
<span class=SourceCodeComment># handle the wrap-around if num is 26 or larger
or less than 0</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>            
if num &lt; 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24.</span>                
num = num + len(LETTERS)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>            
<span class=SourceCodeComment># add number's symbol at the end of translated</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>            
translated = translated + LETTERS[num]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29.</span>        
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>            
<span class=SourceCodeComment># just add the symbol without
encrypting/decrypting</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>31.</span>            
translated = translated + symbol</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>    
<span class=SourceCodeComment># display the current key being tested, along
with its decryption</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>34.</span>    
print('Key #%s: %s' % (key, translated))</p>

</div>

<p class=MsoNormal>You will see that much of this code is the same as the code
in the original Caesar cipher program. This is because the Caesar cipher hacker
program does the same steps to decrypt the key.</p>

<h2><a name="_Toc353630670">Sample Run of the Caesar Cipher Hacker Program</a></h2>

<p class=MsoNormal>Here is what the Caesar cipher program looks like when you
run it. It is trying to break the ciphertext, “GUVF VF ZL FRPERG ZRFFNTR.”
Notice that the decrypted output for key 13 is plain English, so the original
encryption key must have been 13.</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Key #0: GUVF VF ZL FRPERG ZRFFNTR.</p>

<p class=SampleRunCxSpMiddle>Key #1: FTUE UE YK EQODQF YQEEMSQ.</p>

<p class=SampleRunCxSpMiddle>Key #2: ESTD TD XJ DPNCPE XPDDLRP.</p>

<p class=SampleRunCxSpMiddle>Key #3: DRSC SC WI COMBOD WOCCKQO.</p>

<p class=SampleRunCxSpMiddle>Key #4: CQRB RB VH BNLANC VNBBJPN.</p>

<p class=SampleRunCxSpMiddle>Key #5: BPQA QA UG AMKZMB UMAAIOM.</p>

<p class=SampleRunCxSpMiddle>Key #6: AOPZ PZ TF ZLJYLA TLZZHNL.</p>

<p class=SampleRunCxSpMiddle>Key #7: ZNOY OY SE YKIXKZ SKYYGMK.</p>

<p class=SampleRunCxSpMiddle>Key #8: YMNX NX RD XJHWJY RJXXFLJ.</p>

<p class=SampleRunCxSpMiddle>Key #9: XLMW MW QC WIGVIX QIWWEKI.</p>

<p class=SampleRunCxSpMiddle>Key #10: WKLV LV PB VHFUHW PHVVDJH.</p>

<p class=SampleRunCxSpMiddle>Key #11: VJKU KU OA UGETGV OGUUCIG.</p>

<p class=SampleRunCxSpMiddle>Key #12: UIJT JT NZ TFDSFU NFTTBHF.</p>

<p class=SampleRunCxSpMiddle>Key #13: THIS IS MY SECRET MESSAGE.</p>

<p class=SampleRunCxSpMiddle>Key #14: SGHR HR LX RDBQDS LDRRZFD.</p>

<p class=SampleRunCxSpMiddle>Key #15: RFGQ GQ KW QCAPCR KCQQYEC.</p>

<p class=SampleRunCxSpMiddle>Key #16: QEFP FP JV PBZOBQ JBPPXDB.</p>

<p class=SampleRunCxSpMiddle>Key #17: PDEO EO IU OAYNAP IAOOWCA.</p>

<p class=SampleRunCxSpMiddle>Key #18: OCDN DN HT NZXMZO HZNNVBZ.</p>

<p class=SampleRunCxSpMiddle>Key #19: NBCM CM GS MYWLYN GYMMUAY.</p>

<p class=SampleRunCxSpMiddle>Key #20: MABL BL FR LXVKXM FXLLTZX.</p>

<p class=SampleRunCxSpMiddle>Key #21: LZAK AK EQ KWUJWL EWKKSYW.</p>

<p class=SampleRunCxSpMiddle>Key #22: KYZJ ZJ DP JVTIVK DVJJRXV.</p>

<p class=SampleRunCxSpMiddle>Key #23: JXYI YI CO IUSHUJ CUIIQWU.</p>

<p class=SampleRunCxSpMiddle>Key #24: IWXH XH BN HTRGTI BTHHPVT.</p>

<p class=SampleRunCxSpLast>Key #25: HVWG WG AM GSQFSH ASGGOUS.</p>

</div>

<h2><a name="_Toc353630671">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Caesar Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
message = 'GUVF VF ZL FRPERG ZRFFNTR.'</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 5.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

</div>

<p class=MsoNormal>The hacker program will create a <span class=Literal>message</span>
variable that stores the ciphertext string the program tries to decrypt. The <span
class=Literal>LETTERS</span> constant variable contains every character that
can be encrypted with the cipher. The value for <span class=Literal>LETTERS</span>
needs to be exactly the same as the value for <span class=Literal>LETTERS</span>
used in the Caesar cipher program that encrypted the ciphertext we are trying
to hack, otherwise the hacker program won’t work.</p>

<h2><a name="_Toc353630672">The </a><span class=Literal>range() </span>Function</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 7.</span> <span
class=SourceCodeComment># loop through every possible key</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 8.</span> for
key in range(len(LETTERS)):</p>

</div>

<p class=MsoNormal>Line 8 is a <span class=Literal>for</span> loop that does
not iterate over a string value, but instead iterates over the return value
from a call to a function named <span class=Literal>range()</span>. The <span
class=Literal>range()</span> function takes one integer argument and returns a
value of the range data type. These range values can be used in <span
class=Literal>for</span> loops to loop a specific number of times. Try typing
the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
for i in range(4):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print('Hello')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>More specifically, the range value returned from the <span
class=Literal>range()</span> function call will set the <span class=Literal>for</span>
loop’s variable to the integers <span class=Literal>0</span> up to, but not
including, the argument passed to <span class=Literal>range()</span>. Try
typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
for i in range(6):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print(i)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>0</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>1</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>3</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>4</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Line 8 is a <span class=Literal>for</span> loop that will
set the <span class=Literal>key</span> variable with the values <span
class=Literal>0</span> up to (but not including) <span class=Literal>26</span>.
Instead of hard-coding the value <span class=Literal>26</span> directly into
our program, we use the return value from <span class=Literal>len(LETTERS)</span>
so that if we modify <span class=Literal>LETTERS</span> the program will still
work. See the “Encrypt Non-Letter Characters” section in the last chapter to
read why.</p>

<p class=MsoNormal>So the first time the program execution goes through this
loop, <span class=Literal>key</span> will be set to <span class=Literal>0</span>
and the ciphertext in <span class=Literal>message</span> will be decrypted with
key <span class=Literal>0</span>. (The code inside the <span class=Literal>for</span>
loop does the decrypting.) On the next iteration of line 8’s <span
class=Literal>for</span> loop, <span class=Literal>key</span> will be set to <span
class=Literal>1</span> for the decryption.</p>

<p class=MsoNormal>You can also pass two integer arguments to the <span
class=Literal>range()</span> function instead of just one. The first argument
is where the range should start and the second argument is where the range
should stop (up to but not including the second argument). The arguments are
separated by a comma:</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
for i in range(2, 6):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...  
print(i)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>...</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>2</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>3</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>4</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>5</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>The <span class=Literal>range()</span> call evaluates to a
value of the “range object” data type. </p>

<h2><a name="_Toc353630673">Back to the Code</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 7.</span> <span
class=SourceCodeComment># loop through every possible key</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>
for key in range(len(LETTERS)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>    
<span class=SourceCodeComment># It is important to set translated to the blank
string so that the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>    
<span class=SourceCodeComment># previous iteration's value for translated is
cleared.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>12.</span>    
translated = ''</p>

</div>

<p class=MsoNormal>On line 12, <span class=Literal>translated</span> is set to
the blank string. The decryption code on the next few lines adds the decrypted
text to the end of the string in <span class=Literal>translated</span>. It is
important that we reset translated to the blank string at the beginning of this
<span class=Literal>for</span> loop, otherwise the decrypted text will be added
to the decrypted text in <span class=Literal>translated</span> from the last
iteration in the loop.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>14.</span>    
<span class=SourceCodeComment># The rest of the program is the same as the
original Caesar program:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16.</span>    
<span class=SourceCodeComment># run the encryption/decryption code on each
symbol in the message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17.</span>    
for symbol in message:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>        
if symbol in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>19.</span>            
num = LETTERS.find(symbol) <span class=SourceCodeComment># get the number of
the symbol</span></p>

</div>

<p class=MsoNormal>Lines 17 to 31 are almost exactly the same as the code in
the Caesar cipher program from the last chapter. It is slightly simpler,
because this code only has to decrypt instead of decrypt or encrypt. </p>

<p class=MsoNormal>First we loop through every symbol in the ciphertext string stored
in <span class=Literal>message</span> on line 17. On each iteration of this
loop, line 18 checks if <span class=Literal>symbol</span> is an uppercase
letter (that is, it exists in the <span class=Literal>LETTERS</span> constant variable
which only has uppercase letters) and, if so, decrypts it. Line 19 locates
where <span class=Literal>symbol</span> is in <span class=Literal>LETTERS</span>
with the <span class=Literal>find()</span> method and stores it in a variable
called <span class=Literal>num</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>20.</span>            
num = num - key</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22.</span>            
<span class=SourceCodeComment># handle the wrap-around if num is 26 or larger or
less than 0</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>            
if num &lt; 0:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>24.</span>                
num = num + len(LETTERS)</p>

</div>

<p class=MsoNormal>Then we subtract the key from <span class=Literal>num</span>
on line 20. (Remember, in the Caesar cipher, subtracting the key decrypts and
adding the key encrypts.) This may cause <span class=Literal>num</span> to be less
than zero and require “wrap-around”. Line 23 checks for this case and adds <span
class=Literal>26</span> (which is what <span class=Literal>len(LETTERS)</span>
returns) if it was less than <span class=Literal>0</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>26.</span>            
<span class=SourceCodeComment># add number's symbol at the end of translated</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>27.</span>            
translated = translated + LETTERS[num]</p>

</div>

<p class=MsoNormal>Now that <span class=Literal>num</span> has been modified, <span
class=Literal>LETTERS[num]</span> will evaluate to the decrypted symbol. Line
27 adds this symbol to the end of the string stored in <span class=Literal>translated</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>29.</span>        
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>            
<span class=SourceCodeComment># just add the symbol without
encrypting/decrypting</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>31.</span>     
       translated = translated + symbol</p>

</div>

<p class=MsoNormal>Of course, if the condition for line 18’s condition was <span
class=Literal>False</span> and <span class=Literal>symbol</span> was not in <span
class=Literal>LETTERS</span>, we don’t decrypt the symbol at all. If you look
at the indentation of line 29’s <span class=Literal>else</span> statement, you
can see that this <span class=Literal>else</span> statement matches the <span
class=Literal>if</span> statement on line 18.</p>

<p class=MsoNormal>Line 31 just adds <span class=Literal>symbol</span> to the
end of <span class=Literal>translated</span> unmodified.</p>

<h2><a name="_Toc353630674">String Formatting</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>caesarHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>33.</span>    
<span class=SourceCodeComment># display the current key being tested, along
with its decryption</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>34.</span>    
print('Key #%s: %s' % (key, translated))</p>

</div>

<p class=MsoNormal>Although line 34 is the only <span class=Literal>print()</span>
function call in our Caesar cipher hacker program, it will print out several
lines because it gets called once per iteration of line 8’s <span
class=Literal>for</span> loop.</p>

<p class=MsoNormal>The argument for the <span class=Literal>print()</span>
function call is something we haven’t used before. It is a string value that
makes use of <span class=Definition><span style='font-size:12.0pt;line-height:
115%'>string formatting</span></span> (also called <span class=Definition><span
style='font-size:12.0pt;line-height:115%'>string interpolation</span></span>).
String formatting with the <span class=Literal>%s</span> text is a way of
placing one string inside another one. The first <span class=Literal>%s</span>
text in the string gets replaced by the first value in the parentheses after
the <span class=Literal>%</span> at the end of the string.</p>

<p class=MsoNormal>Type the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
'Hello %s!' % ('world')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Hello
world!'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
'Hello ' + 'world' + '!'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Hello
world!'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
'The %s ate the %s that ate the %s.' % ('dog', 'cat', 'rat')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'The dog
ate the cat that ate the rat.'</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>String formatting is often easier to type than string
concatenation with the <span class=Literal>+</span> operator, especially for
larger strings. And one benefit of string formatting is that, unlike string
concatenation, you can insert non-string values such as integers into the
string. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
'%s had %s pies.' % ('Alice', 42)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>'Alice had
42 pies.'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
'Alice' + ' had ' + 42 + ' pies.'</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Traceback
(most recent call last):</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>  File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>TypeError:
Can't convert 'int' object to str implicitly</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Line 34 uses string formatting to create a string that has
the values in both the <span class=Literal>key</span> and <span class=Literal>translated</span>
variables. Because <span class=Literal>key</span> stores an integer value,
we’ll use string formatting to put it in a string value that is passed to <span
class=Literal>print()</span>.</p>

<h2><a name="_Toc353630675">Practice Exercises, Chapter 7, Set A</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice7A</u></span>.</p>

<h2><a name="_Toc353630676">Summary</a></h2>

<p class=MsoNormal>The critical failure of the Caesar cipher is that there
aren’t that many different possible keys that can be used to encrypt a message.
Any computer can easily decrypt with all 26 possible keys, and it only takes the
cryptanalyst a few seconds to look through them to find the one that is in
English. To make our messages more secure, we will need a cipher that has more
possible keys. That transposition cipher in the next chapter can provide this
for us.</p>

</div>

</body>

</html>
