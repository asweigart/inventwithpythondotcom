<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:3 8 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Franklin Gothic Demi";
	panose-1:2 11 7 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Another Typewriter";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:MonospaceTypewriter;
	panose-1:2 0 6 6 4 0 0 2 0 4;}
@font-face
	{font-family:"MS Shell Dlg 2";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Rounded MT Bold";
	panose-1:2 15 7 4 3 5 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:36.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;
	font-weight:normal;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri","sans-serif";}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:33.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:44.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:55.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:66.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:77.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:88.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";
	color:#4F81BD;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Franklin Gothic Demi","sans-serif";
	font-variant:small-caps;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.Definition
	{mso-style-name:Definition;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Times New Roman","serif";}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Times New Roman","serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
p.TableListing, li.TableListing, div.TableListing
	{mso-style-name:"Table Listing";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TableHeader, li.TableHeader, div.TableHeader
	{mso-style-name:"Table Header";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpFirst, li.ChapterTitleCxSpFirst, div.ChapterTitleCxSpFirst
	{mso-style-name:"Chapter TitleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpMiddle, li.ChapterTitleCxSpMiddle, div.ChapterTitleCxSpMiddle
	{mso-style-name:"Chapter TitleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
p.ChapterTitleCxSpLast, li.ChapterTitleCxSpLast, div.ChapterTitleCxSpLast
	{mso-style-name:"Chapter TitleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:48.0pt;
	font-family:"Franklin Gothic Demi","sans-serif";
	letter-spacing:.25pt;}
span.URL
	{mso-style-name:URL;
	color:windowtext;
	text-decoration:underline;}
p.SourceCodeExcerpt, li.SourceCodeExcerpt, div.SourceCodeExcerpt
	{mso-style-name:"Source Code Excerpt";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpFirst, li.SourceCodeExcerptCxSpFirst, div.SourceCodeExcerptCxSpFirst
	{mso-style-name:"Source Code ExcerptCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpMiddle, li.SourceCodeExcerptCxSpMiddle, div.SourceCodeExcerptCxSpMiddle
	{mso-style-name:"Source Code ExcerptCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeExcerptCxSpLast, li.SourceCodeExcerptCxSpLast, div.SourceCodeExcerptCxSpLast
	{mso-style-name:"Source Code ExcerptCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SourceCodeFeatured, li.SourceCodeFeatured, div.SourceCodeFeatured
	{mso-style-name:"Source Code \(Featured\)";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpFirst, li.SourceCodeFeaturedCxSpFirst, div.SourceCodeFeaturedCxSpFirst
	{mso-style-name:"Source Code \(Featured\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpMiddle, li.SourceCodeFeaturedCxSpMiddle, div.SourceCodeFeaturedCxSpMiddle
	{mso-style-name:"Source Code \(Featured\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeFeaturedCxSpLast, li.SourceCodeFeaturedCxSpLast, div.SourceCodeFeaturedCxSpLast
	{mso-style-name:"Source Code \(Featured\)CxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.SourceCode
	{mso-style-name:"Source Code";
	font-family:"Lucida Console";}
p.SampleRun, li.SampleRun, div.SampleRun
	{mso-style-name:"Sample Run";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpFirst, li.SampleRunCxSpFirst, div.SampleRunCxSpFirst
	{mso-style-name:"Sample RunCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpMiddle, li.SampleRunCxSpMiddle, div.SampleRunCxSpMiddle
	{mso-style-name:"Sample RunCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
p.SampleRunCxSpLast, li.SampleRunCxSpLast, div.SampleRunCxSpLast
	{mso-style-name:"Sample RunCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Lucida Sans Typewriter";}
span.SampleRunResponse
	{mso-style-name:"Sample Run Response";
	color:black;}
span.SourceLineNumber
	{mso-style-name:"Source Line Number";
	color:gray;}
p.MessageText, li.MessageText, div.MessageText
	{mso-style-name:"Message Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Lucida Sans Typewriter";}
p.TopicsCoveredbox, li.TopicsCoveredbox, div.TopicsCoveredbox
	{mso-style-name:"Topics Covered box";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpFirst, li.TopicsCoveredboxCxSpFirst, div.TopicsCoveredboxCxSpFirst
	{mso-style-name:"Topics Covered boxCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpMiddle, li.TopicsCoveredboxCxSpMiddle, div.TopicsCoveredboxCxSpMiddle
	{mso-style-name:"Topics Covered boxCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.TopicsCoveredboxCxSpLast, li.TopicsCoveredboxCxSpLast, div.TopicsCoveredboxCxSpLast
	{mso-style-name:"Topics Covered boxCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	background:#DBE5F1;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
span.Literal
	{mso-style-name:Literal;
	font-family:Courier;}
span.SourceCodeComment
	{mso-style-name:"Source Code Comment";
	color:#7F7F7F;}
p.FigureCaption, li.FigureCaption, div.FigureCaption
	{mso-style-name:"Figure Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpFirst, li.FigureCaptionCxSpFirst, div.FigureCaptionCxSpFirst
	{mso-style-name:"Figure CaptionCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpMiddle, li.FigureCaptionCxSpMiddle, div.FigureCaptionCxSpMiddle
	{mso-style-name:"Figure CaptionCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.FigureCaptionCxSpLast, li.FigureCaptionCxSpLast, div.FigureCaptionCxSpLast
	{mso-style-name:"Figure CaptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.SourceCodeFilename
	{mso-style-name:"Source Code Filename";
	font-family:"Lucida Sans Typewriter";}
p.TableCaption, li.TableCaption, div.TableCaption
	{mso-style-name:"Table Caption";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Filename
	{mso-style-name:Filename;
	font-style:italic;}
p.CipherInfoBox, li.CipherInfoBox, div.CipherInfoBox
	{mso-style-name:"Cipher Info Box";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	background:#FFFF99;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Another Typewriter";
	letter-spacing:1.4pt;}
p.ChapterQuotes, li.ChapterQuotes, div.ChapterQuotes
	{mso-style-name:"Chapter Quotes";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpFirst, li.ChapterQuotesCxSpFirst, div.ChapterQuotesCxSpFirst
	{mso-style-name:"Chapter QuotesCxSpFirst";
	margin-top:30.0pt;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpMiddle, li.ChapterQuotesCxSpMiddle, div.ChapterQuotesCxSpMiddle
	{mso-style-name:"Chapter QuotesCxSpMiddle";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.ChapterQuotesCxSpLast, li.ChapterQuotesCxSpLast, div.ChapterQuotesCxSpLast
	{mso-style-name:"Chapter QuotesCxSpLast";
	margin-top:0in;
	margin-right:1.0in;
	margin-bottom:30.0pt;
	margin-left:1.0in;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";}
p.CodeExample, li.CodeExample, div.CodeExample
	{mso-style-name:"Code Example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpFirst, li.CodeExampleCxSpFirst, div.CodeExampleCxSpFirst
	{mso-style-name:"Code ExampleCxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpMiddle, li.CodeExampleCxSpMiddle, div.CodeExampleCxSpMiddle
	{mso-style-name:"Code ExampleCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CodeExampleCxSpLast, li.CodeExampleCxSpLast, div.CodeExampleCxSpLast
	{mso-style-name:"Code ExampleCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SmallerText, li.SmallerText, div.SmallerText
	{mso-style-name:"Smaller Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.SourceCodeHeadline, li.SourceCodeHeadline, div.SourceCodeHeadline
	{mso-style-name:"Source Code \(Headline\)";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpFirst, li.SourceCodeHeadlineCxSpFirst, div.SourceCodeHeadlineCxSpFirst
	{mso-style-name:"Source Code \(Headline\)CxSpFirst";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpMiddle, li.SourceCodeHeadlineCxSpMiddle, div.SourceCodeHeadlineCxSpMiddle
	{mso-style-name:"Source Code \(Headline\)CxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.SourceCodeHeadlineCxSpLast, li.SourceCodeHeadlineCxSpLast, div.SourceCodeHeadlineCxSpLast
	{mso-style-name:"Source Code \(Headline\)CxSpLast";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1, li.Style1, div.Style1
	{mso-style-name:Style1;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpFirst, li.Style1CxSpFirst, div.Style1CxSpFirst
	{mso-style-name:Style1CxSpFirst;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpMiddle, li.Style1CxSpMiddle, div.Style1CxSpMiddle
	{mso-style-name:Style1CxSpMiddle;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
p.Style1CxSpLast, li.Style1CxSpLast, div.Style1CxSpLast
	{mso-style-name:Style1CxSpLast;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:7.0pt;
	font-family:"Lucida Sans Typewriter";
	color:black;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>
<div style='float: right; height: 310px; font-family: sans-serif;'>Ad: Programming books by Al Sweigart<br />
    <a href='http://www.nostarch.com/automatestuff' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_automate.link');"><img src='/images/cover_automate_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/0982106017?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_invent.link');"><img src='/images/cover_inventwithpython_thumb.jpg' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/Making-Games-Python-Pygame-Sweigart/dp/1469901730?ie=UTF8&tag=playwithpyth-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0982106017' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_pygame.link');"><img src='/images/cover_makinggames_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
    <a href='http://www.amazon.com/gp/product/1482614375/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1482614375&linkCode=as2&tag=playwithpyth-20' onclick="javascript: pageTracker._trackPageview('/affiliate_chapters_hacking.link');"><img src='/images/cover_hackingciphers_thumb.png' style="height: 200px; border: solid black 1px;" /></a>
</div>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><img width=327
height=180 id="Picture 42" src="chapter21_files/image001.jpg"> </p>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc353630899"><span style='font-variant:normal !important;
text-transform:uppercase'>Hacking the Vigenère Cipher</span></a></h1>

</div>

<div style='border:solid windowtext 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt;
background:#DBE5F1'>

<p class=TopicsCoveredboxCxSpFirst style='background:#DBE5F1;border:none;
padding:0in'>Topics Covered In This Chapter:</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>extend()</span> list method</p>

<p class=TopicsCoveredboxCxSpMiddle style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Set data type and <span class=Literal>set()</span> function</p>

<p class=TopicsCoveredboxCxSpLast style='margin-left:.25in;text-indent:-.25in;
background:#DBE5F1;border:none;padding:0in'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class=Literal>itertools.product()</span> function</p>

</div>

<p class=ChapterQuotesCxSpFirst style='margin-top:30.0pt;margin-right:.75in;
margin-bottom:30.0pt;margin-left:40.5pt'><span style='font-size:12.0pt;
line-height:115%'>Alan says, “When we want to sink a convey, we send out an
observation plane first. It is ostensibly an observation plane. Of course, to
observe is not its real duty—We already know exactly where the convoy is. Its
real duty is to be observed—That is, to fly close enough to the convoy that it
will be noticed by the lookouts on the ships. The ships will then send out a
radio message to the effect that they have been sighted by an Allied
observation plane. Then, when we come round and sink them, the Germans will not
find it suspicious—At least, not quite so monstrously suspicious that we knew
exactly where to go.”</span></p>

<p class=ChapterQuotesCxSpMiddle align=center style='margin-top:30.0pt;
margin-right:.75in;margin-bottom:30.0pt;margin-left:40.5pt;text-align:center'><span
style='font-size:12.0pt;line-height:115%'>...</span></p>

<p class=ChapterQuotesCxSpLast style='margin-top:30.0pt;margin-right:.75in;
margin-bottom:30.0pt;margin-left:40.5pt'><span style='font-size:12.0pt;
line-height:115%'>Alan says, “Unless we continue to do stunningly idiotic
things like sinking convoys in the fog, they will never receive any clear and
unmistakable indications that we have broken Enigma.”</span></p>

<p class=MsoNormal align=right style='margin-right:.75in;text-align:right'>“Cryptonomicon”
by Neal Stephenson</p>

<p class=MsoNormal>There are two different methods to hack the Vigenère cipher.
The first is a brute-force attack that tries every word in the dictionary file
as the Vigenère key. This method will only work if an English word like “RAVEN”
or “DESK” was used for the key instead of a random key like “VUWFE” or “PNFJ”.
The second is a more sophisticated method that works even if a random key was
used. The earliest record of its use was by the mathematician Charles Babbage
in the 19<sup>th</sup> century.</p>

<h2><a name="_Toc353630900">The Dictionary Attack</a></h2>

<p class=MsoNormal>If the Vigenère key is an English word it is very easy to
memorize. <strong>But never use an English word for the encryption key. This
makes your ciphertext vulnerable to a dictionary attack.</strong></p>

<p class=MsoNormal>A dictionary attack is a brute-force technique where a hacker
attempts to decrypt the ciphertext using the words from a dictionary file as
the keys. The <span class=Filename>dictionary.txt</span> dictionary file
available on this book’s website (at <span class=URL><u>http://invpy.com/dictionary.txt</u></span>)
has about 45,000 English words. It takes less than 5 minutes for my computer to
run through all of these decryptions for a message the size of a long
paragraph.</p>

<h2><a name="_Toc353630901">Source Code for a Vigenère Dictionary Attack
Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong>File</strong>
&#9658; <strong>New Window</strong>. Type in the following code into the file
editor, and then save it as <span class=Filename>vigenereDictionaryHacker.py</span>.
Press <strong>F5</strong> to run the program. Note that first you will need to
download the <span class=Filename>pyperclip.py</span> module and place this
file in the same directory as the <span class=Filename>vigenereDictionaryHacker.py</span>
file. You can download this file from <span class=URL><u>http://invpy.com/pyperclip.py</u></span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for vigenereDictionaryHacker.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 1.</span> <span
class=SourceCodeComment># Vigenere Cipher Dictionary Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 4.</span>
import detectEnglish, vigenereCipher, pyperclip</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 5. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 6.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 7.</span>
ciphertext = &quot;&quot;&quot;Tzx isnz eccjxkg nfq lol mys bbqq I
lxcz.&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 8.</span>
hackedMessage = hackVigenere(ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 9. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>10.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>11.</span>
print('Copying hacked message to clipboard:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>12.</span>
print(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>13.</span>
pyperclip.copy(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>14.</span>
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>15.</span>
print('Failed to hack encryption.')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>16. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>17. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>18.</span>
def hackVigenere(ciphertext):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>19.</span>
fo = open('dictionary.txt')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>20.</span>
words = fo.readlines()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>21.</span>
fo.close()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>22. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>23.</span>
for word in words:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>24.</span>
word = word.strip() <span class=SourceCodeComment># remove the newline at the
end</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>25.</span>
decryptedText = vigenereCipher.decryptMessage(word, ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>26.</span>
if detectEnglish.isEnglish(decryptedText, wordPercentage=40):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>27.</span>
<span class=SourceCodeComment># Check with user to see if the decrypted key has
been found.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>28.</span>
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>29.</span>
print('Possible encryption break:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>30.</span>
print('Key ' + str(word) + ': ' + decryptedText[:100])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>31.</span>
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>32.</span>
print('Enter D for done, or just press Enter to continue breaking:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>33.</span>
response = input('&gt; ')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>34. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>35.</span>
if response.upper().startswith('D'):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>36.</span>
return decryptedText</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>37. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>38.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>39.</span>
main()</p>

</div>

<h2><a name="_Toc353630902">Sample Run of the Vigenère Dictionary Hacker
Program</a></h2>

<p class=MsoNormal>When you run this program the output will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Possible encryption break:</p>

<p class=SampleRunCxSpMiddle>Key ASTROLOGY: The recl yecrets crk not the qnks I
tell.</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Enter D for done, or just press Enter to continue
breaking:</p>

<p class=SampleRunCxSpMiddle>&gt;&nbsp;</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Possible encryption break:</p>

<p class=SampleRunCxSpMiddle>Key ASTRONOMY: The real secrets are not the ones I
tell.</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Enter D for done, or just press Enter to continue
breaking:</p>

<p class=SampleRunCxSpMiddle>&gt; d</p>

<p class=SampleRunCxSpMiddle>Copying hacked message to clipboard:</p>

<p class=SampleRunCxSpLast>The real secrets are not the ones I tell.</p>

</div>

<p class=MsoNormal>The first keyword it suggests (“ASTROLOGY”) doesn’t quite
work, so the user presses Enter to let the hacking program continue until it
gets the correct decryption key (“ASTRONOMY”).</p>

<h2><a name="_Toc353630903">The </a><span class=Literal>readlines()</span> File
Object Method</h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeatured><span class=SourceLineNumber>20.</span>     words =
fo.readlines()</p>

</div>

<p class=MsoNormal>File objects returned from <span class=Literal>open()</span>
have a <span class=Literal>readlines()</span> method. Unlike the <span
class=Literal>read()</span> method which returns the full contents of the file
as a single string, the <span class=Literal>readlines()</span> method will
return a list of strings, where each string is a single line from the file.
Note that each of the strings in the list will end with a <span class=Literal>\n</span>
newline character (except for possibly the very last string, since the file
might not have ended with a newline).</p>

<p class=MsoNormal>The source code for this program isn’t anything we haven’t
seen in previous hacking programs in this book, aside from the new <span
class=Literal>readlines()</span> method. The <span class=Literal>hackVigenere()</span>
function reads in the contents of the dictionary file, uses each word in that
file to decrypt the ciphertext, and if the decrypted text looks like readable
English it will prompt the user to quit or continue.</p>

<p class=MsoNormal>As such, we won’t do a line-by-line explanation for this
program, and instead continue on with a program that can hack the Vigenère
cipher even when the key was not a word that can be found in the dictionary.</p>

<h2><a name="_Toc353630904">The Babbage Attack &amp; Kasiski Examination</a></h2>

<p class=MsoNormal>Charles Babbage is known to have broken the Vigenère cipher,
but he never published his results. Later studies revealed he used a method
that was later published by early 20<sup>th</sup>-century mathematician Friedrich
Kasiski.</p>

<p class=MsoNormal>“Kasiski Examination” is a process used to determine how
long the Vigenère key used to encrypt a ciphertext was. After this is determined,
frequency analysis can be used to break each of the subkeys.</p>

<h2><a name="_Toc353630905">Kasiski Examination, Step 1 – Find Repeat Sequences’
Spacings</a></h2>

<p class=MsoNormal>The first part of Kasiski Examination is to find every
repeated set of letters at least three letters long in the ciphertext. These
are significant, because they could indicate that they were the same letters of
plaintext encrypted with the same subkeys of the key. For example, if the ciphertext
is “Ppqca xqvekg ybnkmazu ybngbal jon i tszm jyim. Vrag voht vrau c tksg. Ddwuo
xitlazu vavv raz c vkb qp iwpou.” and we remove the non-letters, the ciphertext
looks like this:</p>

<p class=MsoNormal><span class=Literal>PPQCAXQVEKGYBNKMAZUYBNGBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITLAZUVAVVRAZCVKBQPIWPOU</span></p>

<p class=MsoNormal>You can see that the sequences VRA, AZU, and YBN repeat in
this ciphertext:</p>

<p class=MsoNormal><span class=Literal>PPQCAXQVEKGYBNKMAZUYBNGBALJONITSZMJYIM<b><u>VRA</u></b>GVOHT<b><u>VRA</u></b>UCTKSGDDWUOXITLAZUVAV<b><u>VRA</u></b>ZCVKBQPIWPOU</span></p>

<p class=MsoNormal><span class=Literal>PPQCAXQVEKGYBNKM<b><u>AZU</u></b>YBNGBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITL<b><u>AZU</u></b>VAVVRAZCVKBQPIWPOU</span></p>

<p class=MsoNormal><span class=Literal>PPQCAXQVEKG<b><u>YBN</u></b>KMAZU<b><u>YBN</u></b>GBALJONITSZMJYIMVRAGVOHTVRAUCTKSGDDWUOXITLAZUVAVVRAZCVKBQPIWPOU</span></p>

<p class=MsoNormal>After finding the repeated sequences, get a count of the
spacing between the sequences. If we count the number of letters between the
start of each of these sequences, we find that:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Between the first and second VRA sequences there are 8 letters.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Between the second and third VRA sequences there are 24 letters.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Between the first and third VRA sequences there are 32 letters.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Between the first and second AZU there are 48 letters.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Between the first and second YBN there are 8 letters.</p>

<h2><a name="_Toc353630906">Kasiski Examination, Step 2 – Get Factors of
Spacings</a></h2>

<p class=MsoNormal>So the spacings are 8, 8, 24, 32, and 48. Let’s find the
factors of each of these numbers (not including one):</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The factors of 8 are 2, 4, and 8.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The factors of 24 are 2, 4, 6, 8, 12, and 24.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The factors of 32 are 2, 4, 8, and 16.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The factors of 48 are 2, 4, 6, 8, 12, 24, and 48.</p>

<p class=MsoNormal>So the spacings of 8, 8, 24, 32, and 48 expand to this list
of factors: 2, 2, 2, 2, 4, 4, 4, 4, 6, 6, 8, 8, 8, 8, 12, 12, 16, 24, 24, and
48. If we do a count of these factors, we get this:</p>

<p class=TableCaption>Table 21-1. Factor count from our “Ppqca xqvekg...”
example.</p>

<div align=center>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='margin-left:173.6pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=60 valign=top style='width:45.0pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Factor</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=TableHeader>Count</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>2</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 4 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>4</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 4 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>6</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 2 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>8</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 4 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>12</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 2 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>16</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 1 time.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>24</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 2 times.</p>
  </td>
 </tr>
 <tr>
  <td width=60 valign=top style='width:45.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>48</p>
  </td>
  <td width=131 valign=top style='width:98.1pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'>Appears 1 time.</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><strong>The factors that have the highest count are the most
likely lengths of the Vigenère key.</strong> In our example above, these are 2,
4, and 8. The Vigenère key is probably 2, 4, or 8 letters long.</p>

<h2><a name="_Toc353630907">Get Every Nth Letters from a String</a></h2>

<p class=MsoNormal>For this example, we will guess that the key length is 4.
Next we will want to split up the ciphertext into every 4<sup>th</sup> letter.
This means we want the following underlined letters as a separate string:</p>

<p class=MsoNormal>Every 4<sup>th</sup> letter starting with the first letter: <span
class=Literal><b><u><span style='font-size:8.0pt;line-height:115%'>P</span></u></b></span><span
class=Literal><span style='font-size:8.0pt;line-height:115%'>PQC<b><u>A</u></b>XQV<b><u>E</u></b>KGY<b><u>B</u></b>NKM<b><u>A</u></b>ZUY<b><u>B</u></b>NGB<b><u>A</u></b>LJO<b><u>N</u></b>ITS<b><u>Z</u></b>MJY<b><u>I</u></b>MVR<b><u>A</u></b>GVO<b><u>H</u></b>TVR<b><u>A</u></b>UCT<b><u>K</u></b>SGD<b><u>D</u></b>WUO<b><u>X</u></b>ITL<b><u>A</u></b>ZUV<b><u>A</u></b>VVR<b><u>A</u></b>ZCV<b><u>K</u></b>BQP<b><u>I</u></b>WPO<b><u>U</u></b></span></span></p>

<p class=MsoNormal>Every 4<sup>th</sup> letter starting with the second letter:<span
class=Literal> </span><span class=Literal><span style='font-size:8.0pt;
line-height:115%'>P<b><u>P</u></b>QCA<b><u>X</u></b>QVE<b><u>K</u></b>GYB<b><u>N</u></b>KMA<b><u>Z</u></b>UYB<b><u>N</u></b>GBA<b><u>L</u></b>JON<b><u>I</u></b>TSZ<b><u>M</u></b>JYI<b><u>M</u></b>VRA<b><u>G</u></b>VOH<b><u>T</u></b>VRA<b><u>U</u></b>CTK<b><u>S</u></b>GDD<b><u>W</u></b>UOX<b><u>I</u></b>TLA<b><u>Z</u></b>UVA<b><u>V</u></b>VRA<b><u>Z</u></b>CVK<b><u>B</u></b>QPI<b><u>W</u></b>POU</span></span></p>

<p class=MsoNormal>Every 4<sup>th</sup> letter starting with the third letter:<span
class=Literal> </span><span class=Literal><span style='font-size:8.0pt;
line-height:115%'>PP<b><u>Q</u></b>CAX<b><u>Q</u></b>VEK<b><u>G</u></b>YBN<b><u>K</u></b>MAZ<b><u>U</u></b>YBN<b><u>G</u></b>BAL<b><u>J</u></b>ONI<b><u>T</u></b>SZM<b><u>J</u></b>YIM<b><u>V</u></b>RAG<b><u>V</u></b>OHT<b><u>V</u></b>RAU<b><u>C</u></b>TKS<b><u>G</u></b>DDW<b><u>U</u></b>OXI<b><u>T</u></b>LAZ<b><u>U</u></b>VAV<b><u>V</u></b>RAZ<b><u>C</u></b>VKB<b><u>Q</u></b>PIW<b><u>P</u></b>OU</span></span></p>

<p class=MsoNormal>Every 4<sup>th</sup> letter starting with the fourth lettter:<span
class=Literal> </span><span class=Literal><span style='font-size:8.0pt;
line-height:115%'>PPQ<b><u>C</u></b>AXQ<b><u>V</u></b>EKG<b><u>Y</u></b>BNK<b><u>M</u></b>AZU<b><u>Y</u></b>BNG<b><u>B</u></b>ALJ<b><u>O</u></b>NIT<b><u>S</u></b>ZMJ<b><u>Y</u></b>IMV<b><u>R</u></b>AGV<b><u>O</u></b>HTV<b><u>R</u></b>AUC<b><u>T</u></b>KSG<b><u>D</u></b>DWU<b><u>O</u></b>XIT<b><u>L</u></b>AZU<b><u>V</u></b>AVV<b><u>R</u></b>AZC<b><u>V</u></b>KBQ<b><u>P</u></b>IWP<b><u>O</u></b>U</span></span></p>

<p class=MsoNormal>When combined, they become these four strings:</p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Every 4<sup>th</sup> letter starting
  with the first letter:</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>PAEBABANZIAHAKDXAAAKIU</span></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Every 4<sup>th</sup> letter starting
  with the second letter:</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>PXKNZNLIMMGTUSWIZVZBW</span></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Every 4<sup>th</sup> letter starting
  with the third letter:</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>QQGKUGJTJVVVCGUTUVCQP</span></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Every 4<sup>th</sup> letter starting
  with the fourth letter:</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>CVYMYBOSYRORTDOLVRVPO</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If our guess from Kasiski Examination was correct and the
decryption key was in fact 4 characters long, then the first subkey of the key
would have been used to encrypt the characters in the first string above, the
second subkey of the key would have been used to encrypt the characters in the
second string above, and so on.</p>

<h2><a name="_Toc353630908">Frequency Analysis</a></h2>

<p class=MsoNormal>Remember, the Vigenère cipher is the same as the Caesar
cipher, except it uses multiple subkeys. Kasiski Examination tells us how many
subkeys were used for the ciphertext, now we just have to hack each subkey one
at a time. Let’s try to hack the first of these four ciphertext strings: <span
class=Literal>PAEBABANZIAHAKDXAAAKIU</span></p>

<p class=MsoNormal>We will decrypt this string 26 times, once for each of the 26
possible subkeys, and then see what English frequency match score the decrypted
text has. In the table below, the first column is the subkey used to decrypt
the <span class=Literal>PAEBABANZIAHAKDXAAAKIU</span> string. The second column
is the returned decrypted text value from <span class=Literal>vigenereCipher.decryptMessage(subkey,
'PAEBABANZIAHAKDXAAAKIU'</span>) where <span class=Literal>subkey</span> is the
subkey from the first column. The third column is the returned value from <span
class=Literal>freqAnalysis.englishFreqMatchScore(decryptedText)</span> where <span
class=Literal>decryptedText</span> is the value from the second column.</p>

<p class=TableCaption>Table 21-2. English frequency match score for each
decryption.</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=354
 style='width:265.3pt;margin-left:4.65pt;border-collapse:collapse'>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=TableHeader>Subkey</p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=TableHeader>Text When PAEB… is Decrypted with the Subkey</p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=TableHeader>English Frequency Match Score</p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border:none;padding:
  0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'A'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;border:none;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'PAEBABANZIAHAKDXAAAKIU'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border:none;padding:
  0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'B'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'OZDAZAZMYHZGZJCWZZZJHT'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'C'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'NYCZYZYLXGYFYIBVYYYIGS'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'D'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'MXBYXYXKWFXEXHAUXXXHFR'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'E'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'LWAXWXWJVEWDWGZTWWWGEQ'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'F'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'KVZWVWVIUDVCVFYSVVVFDP'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'G'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'JUYVUVUHTCUBUEXRUUUECO'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'H'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'ITXUTUTGSBTATDWQTTTDBN'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'I'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'HSWTSTSFRASZSCVPSSSCAM'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'J'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'GRVSRSREQZRYRBUORRRBZL'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'K'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'FQURQRQDPYQXQATNQQQAYK'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'L'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'EPTQPQPCOXPWPZSMPPPZXJ'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'M'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'DOSPOPOBNWOVOYRLOOOYWI'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'N'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'CNRONONAMVNUNXQKNNNXVH'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'O'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'BMQNMNMZLUMTMWPJMMMWUG'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'P'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'ALPMLMLYKTLSLVOILLLVTF'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'Q'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'ZKOLKLKXJSKRKUNHKKKUSE'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'R'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'YJNKJKJWIRJQJTMGJJJTRD'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'S'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'XIMJIJIVHQIPISLFIIISQC'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'T'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'WHLIHIHUGPHOHRKEHHHRPB'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'U'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'VGKHGHGTFOGNGQJDGGGQOA'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'V'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'UFJGFGFSENFMFPICFFFPNZ'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>1</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'W'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'TEIFEFERDMELEOHBEEEOMY'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'X'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'SDHEDEDQCLDKDNGADDDNLX'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'Y'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'RCGDCDCPBKCJCMFZCCCMKW'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border:none;border-bottom:
  double windowtext 1.5pt;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'Z'</span></p>
  </td>
  <td width=226 nowrap valign=bottom style='width:169.3pt;border:none;
  border-bottom:double windowtext 1.5pt;padding:0in 5.4pt 0in 5.4pt;height:
  15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>'QBFCBCBOAJBIBLEYBBBLJV'</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;border:none;border-bottom:
  double windowtext 1.5pt;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span class=Literal>0</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The subkeys that produce decryptions with the closest
frequency match to English are the ones that are most likely to be the real
subkey. In the above decryptions (for the 1<sup>st</sup> of the four ciphertext
strings), <span class=Literal>'A'</span>, <span class=Literal>'I'</span>, <span
class=Literal>'N'</span>, <span class=Literal>'W'</span>, and <span
class=Literal>'X'</span> are the subkeys that have the highest frequency
matches with English. Note that these scores are low in general because there
isn’t enough ciphertext to give us a large sample of text, but it still ends up
working well.</p>

<p class=MsoNormal><strong>We need to repeat this 26-decryptions-and-frequency-match
for the other three strings to find out their most likely subkeys. </strong>After
this frequency analysis, we find:</p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=337 valign=top style='width:252.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>The most likely subkeys for the first
  string are:</p>
  </td>
  <td width=253 valign=top style='width:189.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>A, I, N, W, and X</p>
  </td>
 </tr>
 <tr>
  <td width=337 valign=top style='width:252.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>The most likely subkeys for the second
  string are:</p>
  </td>
  <td width=253 valign=top style='width:189.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>I and Z</p>
  </td>
 </tr>
 <tr>
  <td width=337 valign=top style='width:252.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>The most likely subkey for the third
  string is:</p>
  </td>
  <td width=253 valign=top style='width:189.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>C</p>
  </td>
 </tr>
 <tr>
  <td width=337 valign=top style='width:252.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>The most likely subkeys for the fourth
  string are:</p>
  </td>
  <td width=253 valign=top style='width:189.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>K, N, R, V, and Y</p>
  </td>
 </tr>
</table>

<h2><a name="_Toc353630909">Brute-Force through the Possible Keys</a></h2>

<p class=MsoNormal>Next we will brute-force the key by trying out every
combination of subkey. Because there are 5 possible subkeys for the first
subkey, 2 for the second subkey, 1 for the third subkey, and 5 for the fourth
subkey, the number of combinations is 5 × 2 × 1 × 5 or 50 possible keys to brute-force
through. This is much better than the 26 × 26 × 26 × 26 or 456,976 possible
keys we would have to brute-force through if we had not narrowed the list of
possible subkeys. This difference becomes even greater if the Vigenère key had
been longer!</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=320
 style='width:240.0pt;margin-left:4.65pt;border-collapse:collapse'>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AICK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IICK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NICK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WICK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XICK</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AICN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IICN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NICN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WICN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XICN</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AICR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IICR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NICR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WICR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XICR</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AICV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IICV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NICV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WICV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XICV</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AICY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IICY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NICY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WICY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XICY</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AZCK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IZCK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NZCK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WZCK</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XZCK</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AZCN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IZCN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NZCN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WZCN</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XZCN</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AZCR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IZCR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NZCR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WZCR</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XZCR</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AZCV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IZCV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NZCV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WZCV</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XZCV</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>AZCY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>IZCY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>NZCY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>WZCY</span></p>
  </td>
  <td width=64 nowrap valign=bottom style='width:48.0pt;padding:0in 5.4pt 0in 5.4pt;
  height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span style='font-family:"Calibri","sans-serif";color:black'>XZCY</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now it’s just a matter of going through all 50 of these
decryption keys for the full ciphertext and seeing which one produces a
readable English plaintext. If you do this, you’ll find that the key to the “Ppqca
xqvekg…” ciphertext is “WICK”.</p>

<h2><a name="_Toc353630910">Source Code for the Vigenère Hacking Program</a></h2>

<p class=MsoNormal>Open a new file editor window by clicking on <strong>File</strong>
&#9658; <strong>New Window</strong>. Type in the following code into the file
editor, and then save it as <span class=Filename>vigenereHacker.py</span>.
Press <strong>F5</strong> to run the program. Note that first you will need to
download the <span class=Filename>pyperclip.py</span> module and place this
file in the same directory as the <span class=Filename>vigenereHacker.py</span>
file. You can download this file from <span class=URL><u>http://invpy.com/pyperclip.py</u></span>.</p>

<p class=MsoNormal>The ciphertext in this program may be difficult to copy from
the book, but you can copy &amp; paste it from <span class=URL><u>http://invpy.com/vigenereHacking.py</u></span>.
You can see if there are any differences between the text in your program to
the text of the program in this book by using the online diff tool at <span
class=URL><u>http://invpy.com/hackingdiff</u></span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeFeaturedCxSpFirst align=right style='text-align:right'><span
class=SourceCodeFilename><span style='font-size:13.0pt;line-height:115%'>Source
code for vigenereHacker.py</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># Vigenere Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span>
import itertools, re</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5.</span>
import vigenereCipher, pyperclip, freqAnalysis, detectEnglish</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8.</span>
SILENT_MODE = False <span class=SourceCodeComment># if set to True, program
doesn't print attempts</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9.</span>
NUM_MOST_FREQ_LETTERS = 4 <span class=SourceCodeComment># attempts this many
letters per subkey</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10.</span>
MAX_KEY_LENGTH = 16 <span class=SourceCodeComment># will not attempt keys
longer than this</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 11.</span>
NONLETTERS_PATTERN = re.compile('[^A-Z]')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 12. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 13. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 14.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>
<span class=SourceCodeComment># Instead of typing this ciphertext out, you can
copy &amp; paste it</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16.</span>
<span class=SourceCodeComment># from http://invpy.com/vigenereHacker.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17.</span>
ciphertext = &quot;&quot;&quot;Adiz Avtzqeci Tmzubb wsa m Pmilqev
halpqavtakuoi, lgouqdaf, kdmktsvmztsl, izr xoexghzr kkusitaaf. Vz wsa twbhdg
ubalmmzhdad qz hce vmhsgohuqbo ox kaakulmd gxiwvos, krgdurdny i rcmmstugvtawz
ca tzm ocicwxfg jf &quot;stscmilpy&quot; oid &quot;uwydptsbuci&quot; wabt hce
Lcdwig eiovdnw. Bgfdny qe kddwtk qjnkqpsmev ba pz tzm roohwz at xoexghzr
kkusicw izr vrlqrwxist uboedtuuznum. Pimifo Icmlv Emf DI, Lcdwig owdyzd xwd hce
Ywhsmnemzh Xovm mby Cqxtsm Supacg (GUKE) oo Bdmfqclwg Bomk, Tzuhvif'a
ocyetzqofifo ositjm. Rcm a lqys ce oie vzav wr Vpt 8, lpq gzclqab mekxabnittq
tjr Ymdavn fihog cjgbhvnstkgds. Zm psqikmp o iuejqf jf lmoviiicqg aoj jdsvkavs
Uzreiz qdpzmdg, dnutgrdny bts helpar jf lpq pjmtm, mb zlwkffjmwktoiiuix avczqzs
ohsb ocplv nuby swbfwigk naf ohw Mzwbms umqcifm. Mtoej bts raj pq kjrcmp oo tzm
Zooigvmz Khqauqvl Dincmalwdm, rhwzq vz cjmmhzd gvq ca tzm rwmsl lqgdgfa rcm a
kbafzd-hzaumae kaakulmd, hce SKQ. Wi 1948 Tmzubb jgqzsy Msf Zsrmsv'e Qjmhcfwig
Dincmalwdm vt Eizqcekbqf Pnadqfnilg, ivzrw pq onsaafsy if bts yenmxckmwvf ca
tzm Yoiczmehzr uwydptwze oid tmoohe avfsmekbqr dn eifvzmsbuqvl tqazjgq. Pq
kmolm m dvpwz ab ohw ktshiuix pvsaa at hojxtcbefmewn, afl bfzdakfsy okkuzgalqzu
xhwuuqvl jmmqoigve gpcz ie hce Tmxcpsgd-Lvvbgbubnkq zqoxtawz, kciup isme xqdgo
otaqfqev qz hce 1960k. Bgfdny'a tchokmjivlabk fzsmtfsy if i ofdmavmz krgaqqptawz
wi 1952, wzmz vjmgaqlpad iohn wwzq goidt uzgeyix wi tzm Gbdtwl Wwigvwy. Vz
aukqdoev bdsvtemzh rilp rshadm tcmmgvqg (xhwuuqvl uiehmalqab) vs sv mzoejvmhdvw
ba dmikwz. Hpravs rdev qz 1954, xpsl whsm tow iszkk jqtjrw pug 42id tqdhcdsg,
rfjm ugmbddw xawnofqzu. Vn avcizsl lqhzreqzsy tzif vds vmmhc wsa eidcalq; vds
ewfvzr svp gjmw wfvzrk jqzdenmp vds vmmhc wsa mqxivmzhvl. Gv 10 Esktwunsm 2009,
fgtxcrifo mb Dnlmdbzt uiydviyv, Nfdtaat Dmiem Ywiikbqf Bojlab Wrgez avdw iz
cafakuog pmjxwx ahwxcby gv nscadn at ohw Jdwoikp scqejvysit xwd &quot;hce
sxboglavs kvy zm ion tjmmhzd.&quot; Sa at Haq 2012 i bfdvsbq azmtmd'g widt ion
bwnafz tzm Tcpsw wr Zjrva ivdcz eaigd yzmbo Tmzubb a kbmhptgzk dvrvwz wa
efiohzd.&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18.</span>
hackedMessage = hackVigenere(ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21.</span>
print('Copying hacked message to clipboard:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22.</span>
print(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23.</span>
pyperclip.copy(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24.</span>
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 25.</span>
print('Failed to hack encryption.')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 26. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 27. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 28.</span>
def findRepeatSequencesSpacings(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29.</span>
<span class=SourceCodeComment># Goes through the message and finds any 3 to 5
letter sequences</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>
<span class=SourceCodeComment># that are repeated. Returns a dict with the keys
of the sequence and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31.</span>
<span class=SourceCodeComment># values of a list of spacings (num of letters
between the repeats).</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33.</span>
<span class=SourceCodeComment># Use a regular expression to remove non-letters
from the message.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34.</span>
message = NONLETTERS_PATTERN.sub('', message.upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 36.</span>
<span class=SourceCodeComment># Compile a list of seqLen-letter sequences found
in the message.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>
seqSpacings = {} <span class=SourceCodeComment># keys are sequences, values are
list of int spacings</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 38.</span>
for seqLen in range(3, 6):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 39.</span>
for seqStart in range(len(message) - seqLen):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40.</span>
<span class=SourceCodeComment># Determine what the sequence is, and store it in
seq</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 41.</span>
seq = message[seqStart:seqStart + seqLen]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 42. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 43.</span>
<span class=SourceCodeComment># Look for this sequence in the rest of the
message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 44.</span>
for i in range(seqStart + seqLen, len(message) - seqLen):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 45.</span>
if message[i:i + seqLen] == seq:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 46.</span>
<span class=SourceCodeComment># Found a repeated sequence.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47.</span>
if seq not in seqSpacings:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48.</span>
seqSpacings[seq] = [] <span class=SourceCodeComment># initialize blank list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50.</span>
<span class=SourceCodeComment># Append the spacing distance between the
repeated</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51.</span>
  <span class=SourceCodeComment># sequence and the original sequence.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 52.</span>
seqSpacings[seq].append(i - seqStart)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 53.</span>
return seqSpacings</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 54. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 55. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 56.</span>
def getUsefulFactors(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57.</span>
<span class=SourceCodeComment># Returns a list of useful factors of num. By
&quot;useful&quot; we mean factors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58.</span>
<span class=SourceCodeComment># less than MAX_KEY_LENGTH + 1. For example,
getUsefulFactors(144)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59.</span>
<span class=SourceCodeComment># returns [2, 72, 3, 48, 4, 36, 6, 24, 8, 18, 9,
16, 12]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 60. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61.</span>
if num &lt; 2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62.</span>
return [] <span class=SourceCodeComment># numbers less than 2 have no useful
factors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 64.</span>
factors = [] <span class=SourceCodeComment># the list of factors found</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 65. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 66.</span>
<span class=SourceCodeComment># When finding factors, you only need to check
the integers up to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67.</span>
<span class=SourceCodeComment># MAX_KEY_LENGTH.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68.</span>
for i in range(2, MAX_KEY_LENGTH + 1): <span class=SourceCodeComment># don't
test 1</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69.</span>
if num % i == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70.</span>
        factors.append(i)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 71.</span>
factors.append(int(num / i))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 72.</span>
if 1 in factors:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 73.</span>
factors.remove(1)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 74.</span>
return list(set(factors))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 75. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 76. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 77.</span><span
class=SourceLineNumber><span style='color:windowtext'> def
getItemAtIndexOne(x):</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 78.</span><span
class=SourceLineNumber><span style='color:windowtext'>     return x[1]</span></span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 79. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 80.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 81.</span>
def getMostCommonFactors(seqFactors):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 82.</span>
<span class=SourceCodeComment># First, get a count of how many times a factor
occurs in seqFactors.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83.</span>
factorCounts = {} <span class=SourceCodeComment># key is a factor, value is how
often if occurs</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>
<span class=SourceCodeComment># seqFactors keys are sequences, values are lists
of factors of the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 86.</span>
<span class=SourceCodeComment># spacings. seqFactors has a value like: {'GFD':
[2, 3, 4, 6, 9, 12,</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 87.</span>
<span class=SourceCodeComment># 18, 23, 36, 46, 69, 92, 138, 207], 'ALW': [2,
3, 4, 6, ...], ...}</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 88.</span>
for seq in seqFactors:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 89.</span>
factorList = seqFactors[seq]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 90.</span>
for factor in factorList:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 91.</span>
if factor not in factorCounts:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92.</span>
factorCounts[factor] = 0</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 93.</span>
factorCounts[factor] += 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 94. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 95.</span>
<span class=SourceCodeComment># Second, put the factor and its count into a
tuple, and make a list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 96.</span>
<span class=SourceCodeComment># of these tuples so we can sort them.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 97.</span>
factorsByCount = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98.</span>
for factor in factorCounts:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 99.</span>
<span class=SourceCodeComment># exclude factors larger than MAX_KEY_LENGTH</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100.</span>
if factor &lt;= MAX_KEY_LENGTH:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101.</span>
<span class=SourceCodeComment># factorsByCount is a list of tuples: (factor,
factorCount)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102.</span>
<span class=SourceCodeComment># factorsByCount has a value like: [(3, 497), (2,
487), ...]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>103.</span>
factorsByCount.append( (factor, factorCounts[factor]) )</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>104. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>105.</span>
<span class=SourceCodeComment># Sort the list by the factor count.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106.</span>
factorsByCount.sort(key=getItemAtIndexOne, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>108.</span>
return factorsByCount</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>109. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>110. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>111.</span>
def kasiskiExamination(ciphertext):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112.</span>
<span class=SourceCodeComment># Find out the sequences of 3 to 5 letters that
occur multiple times</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113.</span>
<span class=SourceCodeComment># in the ciphertext. repeatedSeqSpacings has a
value like:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114.</span>
<span class=SourceCodeComment># {'EXG': [192], 'NAF': [339, 972, 633], ... }</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>115.</span>
repeatedSeqSpacings = findRepeatSequencesSpacings(ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>116. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>117.</span>
<span class=SourceCodeComment># See getMostCommonFactors() for a description of
seqFactors.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118.</span>
seqFactors = {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119.</span>
for seq in repeatedSeqSpacings:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120.</span>
seqFactors[seq] = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121.</span>
for spacing in repeatedSeqSpacings[seq]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>122.</span>
seqFactors[seq].extend(getUsefulFactors(spacing))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>123. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>124.</span>
<span class=SourceCodeComment># See getMostCommonFactors() for a description of
factorsByCount.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>125.</span>
factorsByCount = getMostCommonFactors(seqFactors)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>126. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127.</span>
<span class=SourceCodeComment># Now we extract the factor counts from
factorsByCount and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128.</span>
<span class=SourceCodeComment># put them in allLikelyKeyLengths so that they
are easier to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>129.</span>
<span class=SourceCodeComment># use later.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>130.</span>
allLikelyKeyLengths = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>131.</span>
for twoIntTuple in factorsByCount:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132.</span>
allLikelyKeyLengths.append(twoIntTuple[0])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>133. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>134.</span>
return allLikelyKeyLengths</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>135. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>136. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>137.</span>
def getNthSubkeysLetters(n, keyLength, message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138.</span>
<span class=SourceCodeComment># Returns every Nth letter for each keyLength set
of letters in text.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139.</span>
<span class=SourceCodeComment># E.g. getNthSubkeysLetters(1, 3, 'ABCABCABC')
returns 'AAA'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(2, 3, 'ABCABCABC')
returns 'BBB'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(3, 3, 'ABCABCABC')
returns 'CCC'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(1, 5, 'ABCDEFGHI')
returns 'AF'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>143. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>144.</span>
<span class=SourceCodeComment># Use a regular expression to remove non-letters
from the message.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>145.</span>
message = NONLETTERS_PATTERN.sub('', message)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>146. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>147.</span>
i = n - 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148.</span>
letters = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149.</span>
while i &lt; len(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150.</span>
letters.append(message[i])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151.</span>
i += keyLength</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>152.</span>
return ''.join(letters)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>153. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>154. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>155.</span>
def attemptHackWithKeyLength(ciphertext, mostLikelyKeyLength):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156.</span>
<span class=SourceCodeComment># Determine the most likely letters for each
letter in the key.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>157.     </span>ciphertextUp
= ciphertext.upper()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>158.</span>
<span class=SourceCodeComment># allFreqScores is a list of mostLikelyKeyLength
number of lists.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159.</span>
<span class=SourceCodeComment># These inner lists are the freqScores lists.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160.</span>
allFreqScores = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>161.</span>
for nth in range(1, mostLikelyKeyLength + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>162.</span>
nthLetters = getNthSubkeysLetters(nth, mostLikelyKeyLength, ciphertextUp)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>163. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>164.</span>
<span class=SourceCodeComment># freqScores is a list of tuples like:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165.</span>
<span class=SourceCodeComment># [(&lt;letter&gt;, &lt;Eng. Freq. match score&gt;),
... ]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166.</span>
<span class=SourceCodeComment># List is sorted by match score. Higher score
means better match.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>167.</span>
<span class=SourceCodeComment># See the englishFreqMatchScore() comments in
freqAnalysis.py.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>168.</span>
freqScores = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>169.</span>
for possibleKey in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>170.</span>
decryptedText = vigenereCipher.decryptMessage(possibleKey, nthLetters)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>171.
</span>keyAndFreqMatchTuple = (possibleKey,
freqAnalysis.englishFreqMatchScore(decryptedText))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>172.</span>
freqScores.append(keyAndFreqMatchTuple)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>173.</span>
<span class=SourceCodeComment># Sort by match score</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>174.</span>
freqScores.sort(key=getItemAtIndexOne, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>175.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>176.</span>
allFreqScores.append(freqScores[:NUM_MOST_FREQ_LETTERS])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>177. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>178.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>179.</span>
for i in range(len(allFreqScores)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>180.</span>
<span class=SourceCodeComment># use i + 1 so the first letter is not called the
&quot;0th&quot; letter</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>181.</span>
print('Possible letters for letter %s of the key: ' % (i + 1), end='')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>182.</span>
for freqScore in allFreqScores[i]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>183.</span>
print('%s ' % freqScore[0], end='')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>184.</span>
print() <span class=SourceCodeComment># print a newline</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>185. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>186.</span>
<span class=SourceCodeComment># Try every combination of the most likely
letters for each position</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187.</span>
<span class=SourceCodeComment># in the key.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>188.</span>
for indexes in itertools.product(range(NUM_MOST_FREQ_LETTERS), repeat=mostLikelyKeyLength):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>189.</span>
<span class=SourceCodeComment># Create a possible key from the letters in
allFreqScores</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>190.</span>
possibleKey = ''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>191.</span>
for i in range(mostLikelyKeyLength):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>192.</span>
possibleKey += allFreqScores[i][indexes[i]][0]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>193. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>194.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>195.</span>
print('Attempting with key: %s' % (possibleKey))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>196. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>197.</span>
decryptedText = vigenereCipher.decryptMessage(possibleKey, ciphertextUp)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>199.</span>
if detectEnglish.isEnglish(decryptedText):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>200.</span>
<span class=SourceCodeComment># Set the hacked ciphertext to the original
casing.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>201.</span>
origCase = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>202.</span>
for i in range(len(ciphertext)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>203.</span>
if ciphertext[i].isupper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>204.</span>
origCase.append(decryptedText[i].upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>205.</span>
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>206.</span>
origCase.append(decryptedText[i].lower())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>207.</span>
decryptedText = ''.join(origCase)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>208. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>209.</span>
<span class=SourceCodeComment># Check with user to see if the key has been
found.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>210.</span>
print('Possible encryption hack with key %s:' % (possibleKey))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>211.</span>
print(decryptedText[:200]) <span class=SourceCodeComment># only show first 200
characters</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>212.</span>
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>213.</span>
print('Enter D for done, or just press Enter to continue hacking:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>214.</span>
response = input('&gt; ')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>215. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216.</span>
if response.strip().upper().startswith('D'):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>217.</span>
return decryptedText</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>218. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>219.</span>
<span class=SourceCodeComment># No English-looking decryption found, so return
None.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>220.</span>
return None</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>221. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>222. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>223.</span>
def hackVigenere(ciphertext):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224.</span>
<span class=SourceCodeComment># First, we need to do Kasiski Examination to
figure out what the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>225.</span>
<span class=SourceCodeComment># length of the ciphertext's encryption key is.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>226.</span>
allLikelyKeyLengths = kasiskiExamination(ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>227.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228.</span>
keyLengthStr = ''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229.</span>
for keyLength in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230.</span>
keyLengthStr += '%s ' % (keyLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>231.</span>
print('Kasiski Examination results say the most likely key lengths are: ' +
keyLengthStr + '\n')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>232. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>233.</span>
for keyLength in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>234.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235.</span>
print('Attempting hack with key length %s (%s possible keys)...' % (keyLength,
NUM_MOST_FREQ_LETTERS ** keyLength))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236.</span>
hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>237.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>238.</span>
break</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>239. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>240.</span>
<span class=SourceCodeComment># If none of the key lengths we found using
Kasiski Examination</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>241.</span>
<span class=SourceCodeComment># worked, start brute-forcing through key
lengths.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242.</span>
if hackedMessage == None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244.</span>
print('Unable to hack message with likely key length(s). Brute-forcing key
length...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>245.</span>
for keyLength in range(1, MAX_KEY_LENGTH + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>246.</span>
<span class=SourceCodeComment># don't re-check key lengths already tried from
Kasiski</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>247.</span>
if keyLength not in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>248.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249.</span>
print('Attempting hack with key length %s (%s possible keys)...' % (keyLength,
NUM_MOST_FREQ_LETTERS ** keyLength))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>250.</span>
hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>251.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>252.</span>
break</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>253.</span>
return hackedMessage</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>254. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>255. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>256.</span> <span
class=SourceCodeComment># If vigenereHacker.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>259.</span>
main()</p>

</div>

<h2><a name="_Toc353630911">Sample Run of the Vigenère Hacking Program</a></h2>

<p class=MsoNormal>When you run the <span class=Filename>vigenereHacker.py</span>
program, the output will look like this:</p>

<div style='border:solid windowtext 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SampleRunCxSpFirst>Kasiski Examination results say the most likely key
lengths are: 3 2 6 4 12</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Attempting hack with key length 3 (27 possible
keys)...</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 1 of the key: A L M</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 2 of the key: S N O</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 3 of the key: V I Z</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ASV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ASI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ASZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ANV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ANI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ANZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AOV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AOI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AOZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LSV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LSI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LSZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LNV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LNI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LNZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LOV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LOI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: LOZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MSV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MSI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MSZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MNV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MNI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MNZ</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MOV</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MOI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: MOZ</p>

<p class=SampleRunCxSpMiddle>Attempting hack with key length 2 (9 possible
keys)...</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 1 of the key: O A E</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 2 of the key: M S I</p>

<p class=SampleRunCxSpMiddle>Attempting with key: OM</p>

<p class=SampleRunCxSpMiddle>Attempting with key: OS</p>

<p class=SampleRunCxSpMiddle>Attempting with key: OI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AM</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AS</p>

<p class=SampleRunCxSpMiddle>Attempting with key: AI</p>

<p class=SampleRunCxSpMiddle>Attempting with key: EM</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ES</p>

<p class=SampleRunCxSpMiddle>Attempting with key: EI</p>

<p class=SampleRunCxSpMiddle>Attempting hack with key length 6 (729 possible
keys)...</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 1 of the key: A E O</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 2 of the key: S D G</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 3 of the key: I V X</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 4 of the key: M Z Q</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 5 of the key: O B Z</p>

<p class=SampleRunCxSpMiddle>Possible letters for letter 6 of the key: V I K</p>

<p class=SampleRunCxSpMiddle>Attempting with key: ASIMOV</p>

<p class=SampleRunCxSpMiddle>Possible encryption hack with key ASIMOV:</p>

<p class=SampleRunCxSpMiddle>ALAN MATHISON TURING WAS A BRITISH MATHEMATICIAN,
LOGICIAN, CRYPTANALYST, AND COMPUTER SCIENTIST. HE WAS HIGHLY INFLUENTIAL IN
THE DEVELOPMENT OF COMPUTER SCIENCE, PROVIDING A FORMALISATION OF THE CON</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>Enter D for done, or just press Enter to continue
hacking:</p>

<p class=SampleRunCxSpMiddle>&gt; d</p>

<p class=SampleRunCxSpMiddle>Copying hacked message to clipboard:</p>

<p class=SampleRunCxSpMiddle>Alan Mathison Turing was a British mathematician,
logician, cryptanalyst, and computer scientist. He was highly influential in
the development of computer</p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpMiddle>    <i>...skipped for brevity... </i></p>

<p class=SampleRunCxSpMiddle>&nbsp;</p>

<p class=SampleRunCxSpLast>his death was accidental. On 10 September 2009,
following an Internet campaign, British Prime Minister Gordon Brown made an
official public apology on behalf of the British government for &quot;the
appalling way he was treated.&quot; As of May 2012 a private member's bill was
before the House of Lords which would grant Turing a statutory pardon if enacted.</p>

</div>

<h2><a name="_Toc353630912">How the Program Works</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>  1.</span> <span
class=SourceCodeComment># Vigenere Cipher Hacker</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  2.</span> <span
class=SourceCodeComment># http://inventwithpython.com/hacking (BSD Licensed)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  3. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  4.</span>
import itertools, re</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  5.</span>
import vigenereCipher, pyperclip, freqAnalysis, detectEnglish</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  6. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  7.</span>
LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  8.</span>
SILENT_MODE = False <span class=SourceCodeComment># if set to True, program
doesn't print attempts</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>  9.</span>
NUM_MOST_FREQ_LETTERS = 4 <span class=SourceCodeComment># attempts this many
letters per subkey</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 10.</span>
MAX_KEY_LENGTH = 16 <span class=SourceCodeComment># will not attempt keys
longer than this</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 11.</span> NONLETTERS_PATTERN
= re.compile('[^A-Z]')</p>

</div>

<p class=MsoNormal>The hacking program imports many different modules,
including a new module named <span class=Literal>itertools</span>. The
constants will be explained as they are used in the program.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 14.</span>
def main():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 15.</span>
<span class=SourceCodeComment># Instead of typing this ciphertext out, you can
copy &amp; paste it</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 16.</span>
<span class=SourceCodeComment># from http://invpy.com/vigenereHacker.py</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 17.</span>
ciphertext = &quot;&quot;&quot;Adiz Avtzqeci Tmzubb wsa m Pmilqev
halpqavtakuoi, lgouqdaf, kdmktsvmztsl, izr xoexghzr kkusitaaf. Vz wsa twbhdg
ubalmmzhdad qz </p>

<p class=SourceCodeFeaturedCxSpMiddle>&nbsp;</p>

<p class=SourceCodeFeaturedCxSpMiddle>        <i>...skipped for brevity...</i></p>

<p class=SourceCodeFeaturedCxSpMiddle>&nbsp;</p>

<p class=SourceCodeFeaturedCxSpMiddle>at Haq 2012 i bfdvsbq azmtmd'g widt ion
bwnafz tzm Tcpsw wr Zjrva ivdcz eaigd yzmbo Tmzubb a kbmhptgzk dvrvwz wa
efiohzd.&quot;&quot;&quot;</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 18.</span>
hackedMessage = hackVigenere(ciphertext)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 19. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 20.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 21.</span>
print('Copying hacked message to clipboard:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 22.</span>
print(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 23.</span>
pyperclip.copy(hackedMessage)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 24.</span>
else:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 25.</span>
print('Failed to hack encryption.')</p>

</div>

<p class=MsoNormal>The <span class=Literal>main()</span> function of the
hacking program is similar to the <span class=Literal>main()</span> functions
of previous hacking functions. The ciphertext is passed to the <span
class=Literal>hackVigenere()</span> cipher, which either returns the decrypted
string (if the hack was successful) or the <span class=Literal>None</span>
value (if the hack failed). If successful, the hacked message is printed to the
screen and copied to the clipboard.</p>

<h2><a name="_Toc353630913">Finding Repeated Sequences</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 28.</span>
def findRepeatSequencesSpacings(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 29.</span>
<span class=SourceCodeComment># Goes through the message and finds any 3 to 5
letter sequences</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 30.</span>
<span class=SourceCodeComment># that are repeated. Returns a dict with the keys
of the sequence and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 31.</span>
<span class=SourceCodeComment># values of a list of spacings (num of letters
between the repeats).</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 32. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 33.</span>
<span class=SourceCodeComment># Use a regular expression to remove non-letters
from the message.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 34.</span>
message = NONLETTERS_PATTERN.sub('', message.upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 35.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 36.</span>
<span class=SourceCodeComment># Compile a list of seqLen-letter sequences found
in the message.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 37.</span>
seqSpacings = {} <span class=SourceCodeComment># keys are sequences, values are
list of int spacings</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 38.</span>
for seqLen in range(3, 6):</p>

</div>

<p class=MsoNormal>The <span class=Literal>findRepeatSequencesSpacings()</span>
locates all the repeated sequences of letters in the <span class=Literal>message</span>
string and counts the spacings (that is, the number of letters) between the
sequences. First, line 34 converts the message to uppercase and removes any
non-letter characters from <span class=Literal>message</span> using the <span
class=Literal>sub()</span> regular expression method.</p>

<p class=MsoNormal>The <span class=Literal>seqSpacings</span> dictionary will
have keys of the sequence strings and values of a list with the integer number
of letters between all the occurrences of that sequence in the key. The previous
“PPQCAXQV…” example string from earlier in the “Kasiski Examination, Step 1”
section, if passed as <span class=Literal>message</span>, would cause <span
class=Literal>findRepeatSequenceSpacings()</span> to return <span
class=Literal>{'VRA': [8, 24, 32], 'AZU': [48], 'YBN': [8]}</span>.</p>

<p class=MsoNormal>The code inside line 38’s <span class=Literal>for</span>
loop will find the repeated sequences in <span class=Literal>message</span> and
calculate the spacings. On the first iteration, it will find sequences that are
exactly 3 letters long. On the next iteration it will find sequences exactly 4
letters long, and then 5 letters long. (You can change what sequence lengths
the code searches for by modifying the <span class=Literal>range(3, 6)</span>
call on line 38, but finding repeated sequences of length 3, 4 and 5 seems to
work for most ciphertexts.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 39.</span>
for seqStart in range(len(message) - seqLen):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 40.</span>
<span class=SourceCodeComment># Determine what the sequence is, and store it in
seq</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 41.</span>
seq = message[seqStart:seqStart + seqLen]</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 39 makes
sure that we iterate over every possible substring of length <span
class=Literal>seqLen</span> in the <span class=Literal>message</span> string.
Line 41 sets the <span class=Literal>seq</span> variable with the sequence we
are looking for. For example, if <span class=Literal>seqLen</span> is <span
class=Literal>3</span> and message is <span class=Literal>'PPQCAXQ'</span>, we
would want to search for the following sequences (notice the indexes at the top
of the <span class=Literal>'PPQCAXQ'</span> string):</p>

<p class=TableCaption>Table 21-3. Values of <span class=Literal>seq</span> from
<span class=Literal>message</span> depending on the value in <span
class=Literal>seqStart</span>.</p>

<div align=center>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='margin-left:3.1pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=218 valign=top style='width:163.4pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Indexes:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal> 0123456</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=218 valign=top style='width:163.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On 1<sup>st</sup> iteration, <span
  class=Literal>seqStart</span> is <span class=Literal>0</span>:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>'<u>PPQ</u>CAXQ'</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(PPQ starts at index <span class=Literal>0</span>.)</p>
  </td>
 </tr>
 <tr>
  <td width=218 valign=top style='width:163.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On 2<sup>nd</sup> iteration, <span
  class=Literal>seqStart</span> is <span class=Literal>1</span>:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>'P<u>PQC</u>AXQ'</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(PQC starts at index <span class=Literal>1</span>.)</p>
  </td>
 </tr>
 <tr>
  <td width=218 valign=top style='width:163.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On 3<sup>rd</sup> iteration, <span
  class=Literal>seqStart</span> is <span class=Literal>2</span>:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>'PP<u>QCA</u>XQ'</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(QCA starts at index <span class=Literal>2</span>.)</p>
  </td>
 </tr>
 <tr>
  <td width=218 valign=top style='width:163.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On 4<sup>th</sup> iteration, <span
  class=Literal>seqStart</span> is <span class=Literal>3</span>:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>'PPQ<u>CAX</u>Q'</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(CAX starts at index <span class=Literal>3</span>.)</p>
  </td>
 </tr>
 <tr>
  <td width=218 valign=top style='width:163.4pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On 5<sup>th</sup> iteration, <span
  class=Literal>seqStart</span> is <span class=Literal>4</span>:</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>'PPQC<u>AXQ</u>'</span></p>
  </td>
  <td width=229 valign=top style='width:171.55pt;border:none;border-bottom:
  double windowtext 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>(AXQ starts at index <span class=Literal>4</span>, which is what <span
  class=Literal>len(message)</span> <span class=Literal>-</span> <span
  class=Literal>seqLen</span> evaluates to and is the last index.)</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span class=Literal>&nbsp;</span></p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 43.</span>
<span class=SourceCodeComment># Look for this sequence in the rest of the
message</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 44.</span>
for i in range(seqStart + seqLen, len(message) - seqLen):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 45.</span>
if message[i:i + seqLen] == seq:</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 44 is inside
line 39’s <span class=Literal>for</span> loop and sets <span class=Literal>i</span>
to be the indexes of every possible sequence of length <span class=Literal>seqLen</span>
in <span class=Literal>message</span>. These indexes start at <span
class=Literal>seqStart + seqLen</span> (that is, after the sequence currently
in <span class=Literal>seq</span>) and go up to <span class=Literal>len(message)
- seqLen</span> (which is the last index where a sequence of length <span
class=Literal>seqLen</span> can be found).</p>

<p class=MsoNormal>The expression <span class=Literal>message[i:i + seqLen]</span>
will evaluate to the substring of <span class=Literal>message</span> that gets
checked for being a repeat of <span class=Literal>seq</span> on line 45. If it
is, then we need to calculate the spacing and add it to the <span
class=Literal>seqSpacings</span> dictionary. This is done on lines 46 to 52.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 46.</span>
<span class=SourceCodeComment># Found a repeated sequence.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 47.</span>
if seq not in seqSpacings:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 48.</span>
seqSpacings[seq] = [] <span class=SourceCodeComment># initialize blank list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 49. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 50.</span>
<span class=SourceCodeComment># Append the spacing distance between the
repeated</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 51.</span>
<span class=SourceCodeComment># sequence and the original sequence.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 52.</span>
seqSpacings[seq].append(i - seqStart)</p>

</div>

<p class=MsoNormal>The spacing between the sequence we’ve found at <span
class=Literal>message[i:i + seqLen]</span> and the original sequence at <span
class=Literal>message[seqStart:seqStart+seqLen]</span> is simply <span
class=Literal>i - seqStart</span>. Notice that <span class=Literal>i</span> and
<span class=Literal>seqStart</span> are the beginning indexes before the colons.
So the integer that <span class=Literal>i - seqStart</span> evaluates to is the
spacing between the two sequences, which is appended to the list stored at <span
class=Literal>seqSpacings[seq]</span>.</p>

<p class=MsoNormal>(Lines 47 and 48 guarantee there is a list at this key by
checking beforehand if <span class=Literal>seq</span> exists as a key in <span
class=Literal>seqSpacings</span>. If it does not, then <span class=Literal>seqSpacings[seq]</span>
is set as a key with a blank list as its value.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 53.</span>     return
seqSpacings</p>

</div>

<p class=MsoNormal>By the time all these <span class=Literal>for</span> loops
have finished, the <span class=Literal>seqSpacings</span> dictionary will
contain every repeated sequence of length 3, 4, and 5 and their spacings. This
dictionary is returned from <span class=Literal>findRepeatSequencesSpacings()</span>
on line 53.</p>

<h2><a name="_Toc353630914">Calculating Factors</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 56.</span>
def getUsefulFactors(num):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 57.</span>
<span class=SourceCodeComment># Returns a list of useful factors of num. By
&quot;useful&quot; we mean factors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 58.</span>
<span class=SourceCodeComment># less than MAX_KEY_LENGTH + 1. For example,
getUsefulFactors(144)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 59.</span>
<span class=SourceCodeComment># returns [2, 72, 3, 48, 4, 36, 6, 24, 8, 18, 9,
16, 12]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 60. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 61.</span>
if num &lt; 2:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 62.</span>
return [] <span class=SourceCodeComment># numbers less than 2 have no useful
factors</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 63. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 64.</span>
factors = [] <span class=SourceCodeComment># the list of factors found</span></p>

</div>

<p class=MsoNormal>The only useful factors for the hacking program’s Kasiski
Examination code are of length <span class=Literal>MAX_KEY_LENGTH</span> and
under, not including <span class=Literal>1</span>. The <span class=Literal>getUsefulFactors()</span>
takes a <span class=Literal>num</span> parameter and returns a list of “useful”
factors. The function does not necessarily return all the factors of <span
class=Literal>num</span> in this list.</p>

<p class=MsoNormal>Line 61 checks for the special case where <span
class=Literal>num</span> is less than <span class=Literal>2</span>. In this
case, line 62 returns the empty list because these numbers have no useful
factors.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 66.</span>     <span
class=SourceCodeComment># When finding factors, you only need to check the
integers up to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 67.</span>
<span class=SourceCodeComment># MAX_KEY_LENGTH.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 68.</span>
for i in range(2, MAX_KEY_LENGTH + 1): <span class=SourceCodeComment># don't
test 1</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 69.</span>
if num % i == 0:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 70.</span>
factors.append(i)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 71.</span>
factors.append(int(num / i))</p>

</div>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 68 loops
through the integers <span class=Literal>2</span> up to <span class=Literal>MAX_KEY_LENGTH</span>
(including the value in <span class=Literal>MAX_KEY_LENGTH</span> itself, since
the second argument to <span class=Literal>range()</span> is <span
class=Literal>MAX_KEY_LENGTH + 1</span>).</p>

<p class=MsoNormal>If <span class=Literal>num % i</span> is equal to <span
class=Literal>0</span>, then we know that <span class=Literal>i</span> evenly
divides (that is, has <span class=Literal>0</span> remainder) <span
class=Literal>num</span> and is a factor of <span class=Literal>num</span>. In
this case, line 70 appends <span class=Literal>i</span> to the list of factors
in the <span class=Literal>factors</span> variable. Line 71 also appends <span
class=Literal>num / i</span> (after converting it from a float to an int, since
the <span class=Literal>/</span> operator always evaluates to a float value).</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 72.</span>
if 1 in factors:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 73.</span>
factors.remove(1)</p>

</div>

<p class=MsoNormal>The value <span class=Literal>1</span> is not a useful
factor, so we remove it from the <span class=Literal>factors</span> list. (If
the Vigenère key had a length of 1, the Vigenère cipher would be no different
from the Caesar cipher!)</p>

<h2><a name="_Toc353630915">Removing Duplicates with the set() Function</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 74.</span>     return
list(set(factors))</p>

</div>

<p class=MsoNormal>The <span class=Literal>factors</span> list might contain
duplicates. For example, if <span class=Literal>getUsefulFactors()</span> was
passed <span class=Literal>9</span> for the <span class=Literal>num</span>
parameter, then <span class=Literal>9 % 3 == 0</span> would be <span
class=Literal>True</span> and both <span class=Literal>i</span> and <span
class=Literal>int(num / i)</span> (both of which evaluate to <span
class=Literal>3</span>) would have been appended to <span class=Literal>factors</span>.
But we don’t want duplicate numbers to appear in our <span class=Literal>factors</span>
list.</p>

<p class=MsoNormal>Line 74 passes the list value in <span class=Literal>factors</span>
to <span class=Literal>set()</span> which returns a set form of the list. The
set data type is similar to the list data type, except a set value can only
contain unique values. You can pass a list value to the <span class=Literal>set()</span>
function and it will return a set value form of the list. This set value will
not have any duplicate values in it. If you pass this set value to <span
class=Literal>list()</span>, it will return a list value version of the set.
This is how line 74 removes duplicate values from the factors list. Try typing
the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
set([1, 2, 3, 3, 4])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>set([1, 2,
3, 4])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam = list(set([2, 2, 2, 'cats', 2, 2]))</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[2,
'cats']</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>This <span class=Literal>list(set(factors))</span> code is
an easy way to remove duplicate factors from the <span class=Literal>factors</span>
list. The final list value is then returned from the function.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 77.</span><span
class=SourceLineNumber><span style='color:windowtext'> def
getItemAtIndexOne(x):</span></span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 78.</span><span
class=SourceLineNumber><span style='color:windowtext'>     return x[1]</span></span></p>

</div>

<p class=MsoNormal>The <span class=Literal>getItemAtIndexOne()</span> is almost
identical to <span class=Literal>getItemAtIndexZero()</span> from the <span
class=Filename>freqAnalysis.py</span> program in the previous chapter. This
function is passed to <span class=Literal>sort()</span> to sort based on the
item at index <span class=Literal>1</span> of the items being sorted. (See the
“The Program’s <span class=Literal>getItemAtIndexZero()</span> Function”
section in Chapter 20.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 81.</span>
def getMostCommonFactors(seqFactors):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 82.</span>
<span class=SourceCodeComment># First, get a count of how many times a factor
occurs in seqFactors.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 83.</span>
factorCounts = {} <span class=SourceCodeComment># key is a factor, value is how
often if occurs</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 84.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 85.</span>
<span class=SourceCodeComment># seqFactors keys are sequences, values are lists
of factors of the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 86.</span>
<span class=SourceCodeComment># spacings. seqFactors has a value like: {'GFD':
[2, 3, 4, 6, 9, 12,</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 87.</span>
<span class=SourceCodeComment># 18, 23, 36, 46, 69, 92, 138, 207], 'ALW': [2,
3, 4, 6, ...], ...}</span></p>

</div>

<p class=MsoNormal>Remember, we need to know the most common factor of the
sequence spacings as a part of the Kasiski Examination because the most common
factor is most likely going to be the length of the Vigenère key.</p>

<p class=MsoNormal>The <span class=Literal>seqFactors</span> parameter is a
dictionary value created in the <span class=Literal>kasiskiExamination()</span>
function, which is explained later. This dictionary has strings of sequences
for keys and a list of integer factors for the value of each key. (These are
factors of the spacing integers found by <span class=Literal>findRepeatSequencesSpacings()</span>.)
For example, <span class=Literal>seqFactors</span> could contain a dictionary
value like <span class=Literal>{'VRA': [8, 2, 4, 2, 3, 4, 6, 8, 12, 16, 8, 2, 4],
'AZU': [2, 3, 4, 6, 8, 12, 16, 24], 'YBN': [8, 2, 4]}</span>.</p>

<p class=MsoNormal>The <span class=Literal>getMostCommonFactors()</span>
function will find the most common factors in <span class=Literal>seqFactors</span>
and return a list of two-integer tuples. The first integer in the tuple will be
the factor and the second integer will be how many times it was in <span
class=Literal>seqFactors</span>.</p>

<p class=MsoNormal>For example, <span class=Literal>getMostCommonFactors()</span>
may return a list value such as <span class=Literal>[(3, 556), (2, 541), (6,
529), (4, 331), (12, 325), (8, 171), (9, 156), (16, 105), (5, 98), (11, 86),
(10, 84), (15, 84), (7, 83), (14, 68), (13, 52)]</span>. This means that in the
<span class=Literal>seqFactors</span> dictionary passed to <span class=Literal>getMostCommonFactors()</span>,
the factor 3 showed up 556 times, the factor 2 showed up 541 times, the factor
5 showed up 529 times, and so on. Note that 3 is the most frequent factor in
the list and appears first in the list. 13 is the least frequent factor and is
last in the list.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 88.</span>
for seq in seqFactors:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 89.</span>
factorList = seqFactors[seq]</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 90.</span>
for factor in factorList:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 91.</span>
if factor not in factorCounts:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 92.</span>
factorCounts[factor] = 0</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber> 93.</span>
factorCounts[factor] += 1</p>

</div>

<p class=MsoNormal>For the first step of <span class=Literal>getMostCommonFactors()</span>
the <span class=Literal>for</span> loop on line 88 loops over every sequence in
<span class=Literal>seqFactors</span>, storing it in a variable named <span
class=Literal>seq</span> on each iteration. The list of factors in <span
class=Literal>seqFactors</span> for <span class=Literal>seq</span> is stored in
a variable named <span class=Literal>factorList</span> on line 89.</p>

<p class=MsoNormal>The factors in this list are looped over with a <span
class=Literal>for</span> loop on line 90. If a factor does not exist as a key
in <span class=Literal>factorCounts</span>, it is added on line 92 with a value
of <span class=Literal>0</span>. On line 93, <span class=Literal>factorCounts[factor]</span>
(that is, the factor’s value in <span class=Literal>factorCounts</span>) is
incremented.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber> 95.</span>
<span class=SourceCodeComment># Second, put the factor and its count into a
tuple, and make a list</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 96.</span>
<span class=SourceCodeComment># of these tuples so we can sort them.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 97.</span>
factorsByCount = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 98.</span>
for factor in factorCounts:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber> 99.</span>
<span class=SourceCodeComment># exclude factors larger than MAX_KEY_LENGTH</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>100.</span>
if factor &lt;= MAX_KEY_LENGTH:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>101.</span>
<span class=SourceCodeComment># factorsByCount is a list of tuples: (factor,
factorCount)</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>102.</span>
<span class=SourceCodeComment># factorsByCount has a value like: [(3, 497), (2,
487), ...]</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>103.</span>
factorsByCount.append( (factor, factorCounts[factor]) )</p>

</div>

<p class=MsoNormal>For the second step of <span class=Literal>getMostCommonFactors()</span>,
we need to sort the values in the <span class=Literal>factorCounts</span>
dictionary by their count. But dictionaries do not have an order, so we must
first convert the dictionary into a list of two-integer tuples. (We did
something similar in Chapter 20 in the <span class=Literal>getFrequencyOrder()</span>
function of the <span class=Filename>freqAnalaysis.py</span> module.) This list
value will be stored in a variable named <span class=Literal>factorsByCount</span>,
which starts as an empty list on line 97.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 98 goes
through each of the factors in <span class=Literal>factorCounts</span> and
appends this <span class=Literal>(factor, factorCounts[factor])</span> tuple to
the <span class=Literal>factorsByCount</span> list as long as the factor is less
than or equal to <span class=Literal>MAX_KEY_LENGTH</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>105.</span>
<span class=SourceCodeComment># Sort the list by the factor count.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>106.</span>
factorsByCount.sort(key=getItemAtIndexOne, reverse=True)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>107.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>108.</span>
return factorsByCount</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop finishes
adding all the tuples to <span class=Literal>factorsByCount</span>, the last
step of <span class=Literal>getMostCommonFactors()</span> is that the <span
class=Literal>factorsByCount</span> list is sorted on line 106. Because the <span
class=Literal>getItemAtIndexOne</span> function is passed for the <span
class=Literal>key</span> keyword argument and <span class=Literal>True</span>
is passed for the <span class=Literal>reverse</span> keyword argument, the list
is sorted in descending order by the factor counts.</p>

<p class=MsoNormal>After being sorted, the list in <span class=Literal>factorsByCount</span>
is returned on line 108.</p>

<h2><a name="_Toc353630916">The Kasiski Examination Algorithm</a></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>111.</span>
def kasiskiExamination(ciphertext):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>112.</span>
<span class=SourceCodeComment># Find out the sequences of 3 to 5 letters that
occur multiple times</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>113.</span>
<span class=SourceCodeComment># in the ciphertext. repeatedSeqSpacings has a
value like:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>114.</span>
<span class=SourceCodeComment># {'EXG': [192], 'NAF': [339, 972, 633], ... }</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>115.</span>
repeatedSeqSpacings = findRepeatSequencesSpacings(ciphertext)</p>

</div>

<p class=MsoNormal>The <span class=Literal>kasiskiExamination()</span> function
returns a list of the most likely key lengths for the given <span
class=Literal>ciphertext</span> argument. The key lengths are integers in a
list, with the first integer in the list being the most likely key length, the
second integer the second most likely, and so on.</p>

<p class=MsoNormal>The first step is to find the spacings between repeated sequences
in the ciphertext. This is returned from <span class=Literal>findRepeatSequencesSpacings()</span>
as a dictionary with keys of the sequence strings and values of a list with the
spacings as integers.</p>

<h2><a name="_Toc353630917">The </a><span class=Literal>extend()</span> List
Method</h2>

<p class=MsoNormal>The <span class=Literal>extend()</span> list method is very
similar to the <span class=Literal>append()</span> list method. While the <span
class=Literal>append()</span> method adds a single value passed to it to the
end of the list, the <span class=Literal>extend()</span> method will add every
item in a list argument to the end of the list. Try typing the following into
the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = []</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
eggs = ['cat', 'dog', 'mouse']</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.extend(eggs)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>['cat',
'dog', 'mouse']</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.extend([1, 2, 3])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>['cat',
'dog', 'mouse', 1, 2, 3]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<p class=MsoNormal>Notice the difference if you pass a list to the <span
class=Literal>append()</span> list method. The <em>list itself</em> gets appended
to the end instead of the values in the list:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
spam = []</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
eggs = ['cat', 'dog', 'mouse']</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.append(eggs)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[['cat',
'dog', 'mouse']]</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam.append([1, 2, 3])</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
spam</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[['cat',
'dog', 'mouse'], [1, 2, 3]]</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>&gt;&gt;&gt;&nbsp;</p>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>117.</span>
<span class=SourceCodeComment># See getMostCommonFactors() for a description of
seqFactors.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>118.</span>
seqFactors = {}</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>119.</span>
for seq in repeatedSeqSpacings:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>120.</span>
seqFactors[seq] = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>121.</span>
for spacing in repeatedSeqSpacings[seq]:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>122.</span>
seqFactors[seq].extend(getUsefulFactors(spacing))</p>

</div>

<p class=MsoNormal>While <span class=Literal>repeatedSeqSpacings</span> is a
dictionary that maps sequence strings to lists of integer spacings, we actually
need a dictionary that maps sequence strings to lists of factors of those
integer spacings. Lines 118 to 122 do this.</p>

<p class=MsoNormal>Line 118 starts with an empty dictionary in <span
class=Literal>seqFactors</span>. The <span class=Literal>for</span> loop on
line 119 iterates over every key (which is a sequence string) in <span
class=Literal>repeatedSeqSpacings</span>. For each key, line 120 sets a  blank
list to be the value in <span class=Literal>seqFactors</span>.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 121 iterates
over all the spacing integers, which are each passed to a <span class=Literal>getUsefulFactors()</span>
call. The list returned from <span class=Literal>getUsefulFactors()</span> has
each of its items appended to <span class=Literal>seqFactors[seq]</span>.</p>

<p class=MsoNormal>When all the <span class=Literal>for</span> loops are
finished, <span class=Literal>seqFactors</span> is a dictionary that maps
sequence strings to lists of factors of integer spacings.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>123.</span>
<span class=SourceCodeComment># See getMostCommonFactors() for a description of
factorsByCount.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>124.</span>
factorsByCount = getMostCommonFactors(seqFactors)</p>

</div>

<p class=MsoNormal>The <span class=Literal>seqFactors</span> dictionary is
passed to <span class=Literal>getMostCommonFactors()</span> on line 124. A list
of two-integer tuples (the first integer in the tuple being the factor, the
second integer being the count of how often that factor appeared in <span
class=Literal>seqFactors</span>) is returned and stored in <span class=Literal>factorsByCount</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>126.</span>
<span class=SourceCodeComment># Now we extract the factor counts from
factorsByCount and</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>127.</span>
<span class=SourceCodeComment># put them in allLikelyKeyLengths so that they
are easier to</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>128.</span>
<span class=SourceCodeComment># use later.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>129.</span>
allLikelyKeyLengths = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>130.</span>
for twoIntTuple in factorsByCount:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>131.</span>
allLikelyKeyLengths.append(twoIntTuple[0])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>132. </span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>133.</span>
return allLikelyKeyLengths</p>

</div>

<p class=MsoNormal>The <span class=Literal>kasiskiExamination()</span> function
doesn’t return a list of two-integer tuples though, it returns a list of
integer factors. These integer factors are in the first item of the two-integer
tuples list in <span class=Literal>factorsByCount</span>, so we need code to
pull these integer factors out and put them in a separate list.</p>

<p class=MsoNormal>This separate list will be stored in <span class=Literal>allLikelyKeyLengths</span>,
which to begin with is set to an empty list on line 129. The <span
class=Literal>for</span> loop on line 130 iterates over each of the tuples in <span
class=Literal>factorsByCount</span>, and appends the tuple’s index <span
class=Literal>0</span> item to the end of <span class=Literal>allLikelyKeyLengths</span>.</p>

<p class=MsoNormal>After this <span class=Literal>for</span> loop completes,
the <span class=Literal>allLikelyKeyLengths</span> variable contains all the
factor integers that were in <span class=Literal>factorsByCount</span>. This
list is returned from <span class=Literal>kasiskiExamination()</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>137.</span>
def getNthSubkeysLetters(n, keyLength, message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>138.</span>
<span class=SourceCodeComment># Returns every Nth letter for each keyLength set
of letters in text.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>139.</span>
<span class=SourceCodeComment># E.g. getNthSubkeysLetters(1, 3, 'ABCABCABC')
returns 'AAA'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>140.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(2, 3, 'ABCABCABC')
returns 'BBB'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>141.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(3, 3, 'ABCABCABC')
returns 'CCC'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>142.</span>
<span class=SourceCodeComment>#      getNthSubkeysLetters(1, 5, 'ABCDEFGHI')
returns 'AF'</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>143. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>144.</span>
<span class=SourceCodeComment># Use a regular expression to remove non-letters
from the message.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>145.</span>
message = NONLETTERS_PATTERN.sub('', message)</p>

</div>

<p class=MsoNormal>In order to pull out the letters from a ciphertext that were
encrypted with the same subkey, we need a function that can create a string for
the 1<sup>st</sup>, 2<sup>nd</sup>, or “N<sup> th</sup>” subkey’s letters from
a message. The first part of getting these letters is to remove the non-letter
characters from <span class=Literal>message</span> using a regular expression
object and its <span class=Literal>sub()</span> method on line 145. (Regular
expressions were first discussed in Chapter 18’s “A Brief Intro to Regular
Expressions and the sub() Regex Method”.) This letters-only string is stored as
the new value in <span class=Literal>message</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>147.</span>
i = n - 1</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>148.</span>
letters = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>149.</span>
while i &lt; len(message):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>150.</span>
letters.append(message[i])</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>151.</span>
i += keyLength</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>152.</span>
return ''.join(letters)</p>

</div>

<p class=MsoNormal>Next we will build up a string by appending the letter
strings to a list and using the <span class=Literal>join()</span> list method
to create the final string value. This approach executes much faster than
string concatenation with the <span class=Literal>+</span> operator. (This
approach was first discussed in Chapter 18’s “Building Strings in Python with
Lists” section.)</p>

<p class=MsoNormal>The <span class=Literal>i</span> variable will point to the
index of the letter in <span class=Literal>message</span> that we want to
append to our string-building list. This list is stored in a variable named <span
class=Literal>letters</span>. The <span class=Literal>i</span> variable starts
with the value <span class=Literal>n - 1</span> on line 147 and the <span
class=Literal>letters</span> variable starts with a blank list on line 148.</p>

<p class=MsoNormal>The <span class=Literal>while</span> loop on line 149 keeps
looping while <span class=Literal>i</span> is less than the length of <span
class=Literal>message</span>. On each iteration the letter at <span
class=Literal>message[i]</span> is appended to the list in <span class=Literal>letters</span>.
Then <span class=Literal>i</span> is updated to point to the next of the
subkey’s letters by adding <span class=Literal>keyLength</span> to <span
class=Literal>i</span> on line 151.</p>

<p class=MsoNormal>After this loop finishes, the code on line 152 joins the
single-letter string values in the <span class=Literal>letters</span> list
together to form a single string, and this string is returned from <span
class=Literal>getNthSubkeysLetters()</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>155.</span>
def attemptHackWithKeyLength(ciphertext, mostLikelyKeyLength):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>156.</span>
<span class=SourceCodeComment># Determine the most likely letters for each
letter in the key.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>157.     </span>ciphertextUp
= ciphertext.upper()</p>

</div>

<p class=MsoNormal>Recall that our <span class=Literal>kasiskiExamination()</span>
function isn’t guaranteed to return the one true integer length of the Vigenère
key, but rather the function returns a list of several lengths sorted in order
of most likely to be the key length. If our code has guessed the wrong key
length, then it will have to try again with a different key length. The <span
class=Literal>attemptHackWithKeyLength()</span> function is passed the
ciphertext and the key length guess. If successful, this function returns a
string of the hacked message. If the hacking fails, the function returns <span
class=Literal>None</span>.</p>

<p class=MsoNormal>The hacking code works on uppercase letters but the original
string will also be needed, so the uppercase form of the <span class=Literal>ciphertext</span>
string will be stored in a separate variable named <span class=Literal>ciphertextUp</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>158.</span>
<span class=SourceCodeComment># allFreqScores is a list of mostLikelyKeyLength
number of lists.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>159.</span>
<span class=SourceCodeComment># These inner lists are the freqScores lists.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>160.</span>
allFreqScores = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>161.</span>
for nth in range(1, mostLikelyKeyLength + 1):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>162.</span>
nthLetters = getNthSubkeysLetters(nth, mostLikelyKeyLength, ciphertextUp)</p>

</div>

<p class=MsoNormal>If we assume the value in the <span class=Literal>mostLikelyKeyLength</span>
is the correct key length, the hack algorithm calls <span class=Literal>getNthSubkeysLetters()</span>
for each subkey and then brute-forces through the 26 possible letters for each
subkey to find the one that produces decrypted text whose letter frequency closest
matches the letter frequency of English.</p>

<p class=MsoNormal>First, an empty list is stored in <span class=Literal>allFreqScores</span>
on line 160. What this list stores will be explained a little later.</p>

<p class=MsoNormal>The <span class=Literal>for</span> loop on line 161 sets the
<span class=Literal>nth</span> variable to each integer from <span
class=Literal>1</span> to the <span class=Literal>mostLikelyKeyLength</span>
value. (Remember, that when <span class=Literal>range()</span> is passed two
arguments, the range goes up to, but not including, the second argument. The <span
class=Literal>+ 1</span> is put into the code so that the integer value in <span
class=Literal>mostLikelyKeyLength</span> itself is included in the range object
returned.)</p>

<p class=MsoNormal>The letters of the Nth subkey are returned from <span
class=Literal>getNthSubkeysLetters()</span> on line 162.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>164.</span>
<span class=SourceCodeComment># freqScores is a list of tuples like:</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>165.</span>
<span class=SourceCodeComment># [(&lt;letter&gt;, &lt;Eng. Freq. match
score&gt;), ... ]</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>166.</span>
<span class=SourceCodeComment># List is sorted by match score. Higher score
means better match.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>167.</span>
<span class=SourceCodeComment># See the englishFreqMatchScore() comments in
freqAnalysis.py.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>168.</span>
freqScores = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>169.</span>         for
possibleKey in LETTERS:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>170.</span>
decryptedText = vigenereCipher.decryptMessage(possibleKey, nthLetters)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>171. </span>            keyAndFreqMatchTuple
= (possibleKey, freqAnalysis.englishFreqMatchScore(decryptedText))</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>172.</span>
freqScores.append(keyAndFreqMatchTuple)</p>

</div>

<p class=MsoNormal>Next, a list of English frequency match scores is stored in
a list in a variable named <span class=Literal>freqScores</span>. This variable
starts as an empty list on line 168 and then the <span class=Literal>for</span>
loop on line 169 loops through each of the 26 uppercase letter from the <span
class=Literal>LETTERS</span> string. The <span class=Literal>possibleKey</span>
value is used to decrypt the ciphertext by calling <span class=Literal>vigenereCipher.decryptMessage()</span>
on line 170. The subkey in <span class=Literal>possibleKey</span> is only one
letter, but the string in <span class=Literal>nthLetters</span> is made up of
only the letters from <span class=Literal>message</span> that would have been
encrypted with that subkey if we’ve guessed the key length correctly.</p>

<p class=MsoNormal>The decrypted text is then passed to <span class=Literal>freqAnalysis.englishFreqMatchScore()</span>
to see how closely the frequency of the letters in <span class=Literal>decryptedText</span>
matches the letter frequency of regular English. (Remember from the last
chapter that the return value will be an integer between <span class=Literal>0</span>
and <span class=Literal>12</span>, with a higher number meaning a closer
match.)</p>

<p class=MsoNormal>This frequency match score, along with the key used to
decrypt, are put into a tuple that is stored in a variable named <span
class=Literal>keyAndFreqMatchTuple</span> on line 171. This tuple is appended
to the end of <span class=Literal>freqScores</span> on line 172.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>173.</span>
<span class=SourceCodeComment># Sort by match score</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>174.</span>
freqScores.sort(key=getItemAtIndexOne, reverse=True)</p>

</div>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 169
completes, the <span class=Literal>freqScores</span> list will contain 26
key-and-frequency-match-score tuples: one tuple for each of the 26 subkeys. We
need to sort this so that the tuples with the largest English frequency match
scores are first in the list.</p>

<p class=MsoNormal>This means that we want to sort by the value at index <span
class=Literal>1</span> of the tuples in <span class=Literal>freqScores</span> and
in reverse (that is, descending) order. We call the <span class=Literal>sort()</span>
method on the <span class=Literal>freqScores</span> list, <em>passing the
function value</em> <span class=Literal>getItemAtIndexOne</span> (not <em>calling
the function</em>: note the lack of parentheses) for the <span class=Literal>key</span>
keyword argument. The value <span class=Literal>True</span> is passed for the <span
class=Literal>reverse</span> keyword argument to sort in reverse (that is,
descending) order.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>176.</span>
allFreqScores.append(freqScores[:NUM_MOST_FREQ_LETTERS])</p>

</div>

<p class=MsoNormal>The <span class=Literal>NUM_MOST_FREQ_LETTERS</span> constant
was set to the integer value <span class=Literal>3</span> on line 9. Once the
tuples in <span class=Literal>freqScores</span> are sorted, a list containing
only the <em>first</em> 3 tuples (that is, the tuples with the three <em>highest</em>
English frequency match scores) is appended to <span class=Literal>allFreqScores</span>.</p>

<p class=MsoNormal>After the <span class=Literal>for</span> loop on line 161
completes, <span class=Literal>allFreqScores</span> will contain a number of
list values equal to the integer value in <span class=Literal>mostLikelyKeyLength</span>.
(For example, since <span class=Literal>mostLikelyKeyLength</span> was <span
class=Literal>3</span>, <span class=Literal>allFreqScores</span> would be a
list of three lists.) The <em>first list value</em> will hold the tuples for
the top three highest matching subkeys for the <em>first subkey</em> of the
full Vigenère key. The <em>second list value</em> will hold the tuples for the
top three highest matching subkeys for the <em>second subkey</em> of the full Vigenère
key, and so on.</p>

<p class=MsoNormal>Originally, if we wanted to brute-force through the full Vigenère
key, there would be (26 ^ key length) number of possible keys. For example, if
the key was ROSEBUD (with a length of 7) there would be 26 ^ 7 (that is, 8,031,810,176)
possible keys.</p>

<p class=MsoNormal>But by checking the English frequency matching, we’ve
narrowed it down to the 4 most likely letters for each subkey, meaning that
there are now only (4 ^ key length) possible keys. Using the example of ROSEBUD
(with a length of 7) for a Vigenère key, now we only need to check 4 ^ 7 (that
is, 16,384) possible keys. This is a huge improvement over 8 billion!</p>

<h2><a name="_Toc353630918">The </a><span class=Literal>end</span> Keyword
Argument for <span class=Literal>print()</span></h2>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>178.</span>     if
not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>179.</span>
for i in range(len(allFreqScores)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>180.</span>
<span class=SourceCodeComment># use i + 1 so the first letter is not called the
&quot;0th&quot; letter</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>181.</span>
print('Possible letters for letter %s of the key: ' % (i + 1), end='')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>182.</span>
for freqScore in allFreqScores[i]:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>183.</span>
print('%s ' % freqScore[0], end='')</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>184.</span>
print() <span class=SourceCodeComment># print a newline</span></p>

</div>

<p class=MsoNormal>At this point, the user might want to know which letters are
in the top three most likely list for each subkey. If the <span class=Literal>SILENT_MODE</span>
constant was set to <span class=Literal>False</span>, then the code on lines
178 to 184 will print out the values in <span class=Literal>allFreqScores</span>
to the screen.</p>

<p class=MsoNormal>Whenever the <span class=Literal>print()</span> function is
called, it will print the string passed to it on the screen along with a
newline character. If we want something else printed at the end of the string
instead of a newline character, we can specify the string for the <span
class=Literal>print()</span> function’s <span class=Literal>end</span> keyword
argument. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
print('HEllo', end='\n')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>HEllo</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
print('Hello', end='\n')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
print('Hello', end='')</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>Hello&gt;&gt;&gt;
print('Hello', end='XYZ')</p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>HelloXYZ&gt;&gt;&gt;</p>

</div>

<p class=MsoNormal>(The above was typed into the <span class=Filename>python.exe</span>
interactive shell rather than IDLE. IDLE will always add a newline character
before printing the <span class=Literal>&gt;&gt;&gt;</span> prompt.)</p>

<h2><a name="_Toc353630919">The </a><span class=Literal>itertools.product()</span>
Function</h2>

<p class=MsoNormal>The <span class=Literal>itertools.product()</span> function
produces every possible combination of items in a list or list-like value, such
as a string or tuple. (Though the <span class=Literal>itertools.product()</span>
function returns a “itertools product” object value, this can be converted to a
list by passing it to <span class=Literal>list()</span>.) This combination of
things is called a <span class=Definition><span style='font-size:12.0pt;
line-height:115%'>Cartesian product</span></span>, which is where the function
gets its name. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import itertools</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
itertools.product('ABC', repeat=4)</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&lt;itertools.product
object at 0x02C40170&gt;</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(itertools.product('ABC', repeat=4))</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[('A',
'A', 'A', 'A'), ('A', 'A', 'A', 'B'), ('A', 'A', 'A', 'C'), ('A', 'A', 'B',
'A'), ('A', 'A', 'B', 'B'), ('A', 'A', 'B', 'C'), ('A', 'A', 'C', 'A'), ('A',
'A', 'C', 'B'), ('A', 'A', 'C', 'C'), ('A', 'B', 'A', 'A'), ('A', 'B', 'A',
'B'), ('A', 'B', 'A', 'C'), ('A', 'B', 'B', 'A'), ('A', 'B', 'B', 'B'), </p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    <i>...skipped
for brevity...</i></p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>('C', 'B',
'C', 'B'), ('C', 'B', 'C', 'C'), ('C', 'C', 'A', 'A'), ('C', 'C', 'A', 'B'),
('C', 'C', 'A', 'C'), ('C', 'C', 'B', 'A'), ('C', 'C', 'B', 'B'), ('C', 'C',
'B', 'C'), ('C', 'C', 'C', 'A'), ('C', 'C', 'C', 'B'), ('C', 'C', 'C', 'C')]</p>

</div>

<p class=MsoNormal>As you can see, by passing <span class=Literal>'ABC'</span>
and the integer <span class=Literal>4</span> for the <span class=Literal>repeat</span>
keyword argument, <span class=Literal>itertools.product()</span> returns an “itertools
product” object that, when converted to a list, has tuples of four values with
every possible combination of <span class=Literal>'A'</span>, <span
class=Literal>'B'</span>, and <span class=Literal>'C'</span>. (This results in
a list with a total of 3 ^ 4 or 81 tuples in it.)</p>

<p class=MsoNormal>Since range objects returned from <span class=Literal>range()</span>
are also list-like, they can be passed to <span class=Literal>itertools.product()</span>
as well. Try typing the following into the interactive shell:</p>

<div style='border:solid #404040 1.0pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeExcerptCxSpFirst style='border:none;padding:0in'>&gt;&gt;&gt;
import itertools</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>&gt;&gt;&gt;
list(itertools.product(range(8), repeat=5))</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>[(0, 0, 0,
0, 0), (0, 0, 0, 0, 1), (0, 0, 0, 0, 2), (0, 0, 0, 0, 3), (0, 0, 0, 0, 4), (0,
0, 0, 0, 5), (0, 0, 0, 0, 6), (0, 0, 0, 0, 7), (0, 0, 0, 1, 0), (0, 0, 0, 1,
1), (0, 0, 0, 1, 2), (0, 0, 0, 1, 3), (0, 0, 0, 1, 4),</p>

<p class=SourceCodeExcerptCxSpMiddle style='border:none;padding:0in'>    <i>...skipped
for brevity...</i></p>

<p class=SourceCodeExcerptCxSpLast style='border:none;padding:0in'>(7, 7, 7, 6,
6), (7, 7, 7, 6, 7), (7, 7, 7, 7, 0), (7, 7, 7, 7, 1), (7, 7, 7, 7, 2), (7, 7,
7, 7, 3), (7, 7, 7, 7, 4), (7, 7, 7, 7, 5), (7, 7, 7, 7, 6), (7, 7, 7, 7, 7)]</p>

</div>

<p class=MsoNormal>When the range object returned from <span class=Literal>range(8)</span>
is passed to <span class=Literal>itertools.product()</span> (along with <span
class=Literal>5</span> for the <span class=Literal>repeat</span> keyword
argument), the list that is generated has tuples of 5 values, and each value
are from the integers <span class=Literal>0</span> to <span class=Literal>7</span>.</p>

<p class=MsoNormal>The <span class=Literal>itertools.product()</span> function
is an easy way to generate a list with every possible combination of some group
of values. This is how our hacking program will create integer indexes to test
every possible combination of possible subkeys.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>186.</span>
<span class=SourceCodeComment># Try every combination of the most likely
letters for each position</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>187.</span>
<span class=SourceCodeComment># in the key.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>188.</span>
for indexes in itertools.product(range(NUM_MOST_FREQ_LETTERS), repeat=mostLikelyKeyLength):</p>

</div>

<p class=MsoNormal>The <span class=Literal>allFreqScores</span> variable is a
list of lists of tuples such that <span class=Literal>allFreqScores[i]</span>
will evaluate to a list of tuples of possible letters for a single subkey. That
is, <span class=Literal>allFreqScores[0]</span> has a list of tuples for the
first subkey, <span class=Literal>allFreqScores[1]</span> has a list of tuples
for the second subkey, and so on.</p>

<p class=MsoNormal>Also, since the <span class=Literal>NUM_MOST_FREQ_LETTERS</span>
constant is set to <span class=Literal>4</span>, <span class=Literal>itertools.product(range(NUM_MOST_FREQ_LETTERS),
repeat=mostLikelyKeyLength</span>) will cause the <span class=Literal>for</span>
loop to have a tuple of integers (from <span class=Literal>0</span> to <span
class=Literal>3</span>) for the <span class=Literal>indexes</span> variable. If
<span class=Literal>5</span> was passed for <span class=Literal>mostLikelyKeyLength</span>,
then the following values would be set to <span class=Literal>indexes</span>
for each iteration:</p>

<p class=TableCaption>Table 21-4. Value of <span class=Literal>indexes</span>
on each iteration.</p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:26.9pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On the 1<sup>st</sup> iteration, <span
  class=Literal>indexes</span> is set to:</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>(0, 0, 0, 0, 0)</span></p>
  </td>
 </tr>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On the 2<sup>nd</sup> iteration, <span
  class=Literal>indexes</span> is set to:</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>(0, 0, 0, 0, 1)</span></p>
  </td>
 </tr>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On the 3<sup>rd</sup> iteration, <span
  class=Literal>indexes</span> is set to:</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>(0, 0, 0, 0, 2)</span></p>
  </td>
 </tr>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On the 4<sup>th</sup> iteration, <span
  class=Literal>indexes</span> is set to:</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>(0, 0, 0, 1, 0)</span></p>
  </td>
 </tr>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>On the 5<sup>th</sup> iteration, <span
  class=Literal>indexes</span> is set to:</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>(0, 0, 0, 1, 1)</span></p>
  </td>
 </tr>
 <tr>
  <td width=253 valign=top style='width:189.9pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>And so on…</p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>&nbsp;</span></p>
  </td>
 </tr>
</table>

</div>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>189.</span>
<span class=SourceCodeComment># Create a possible key from the letters in allFreqScores</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>190.</span>
possibleKey = ''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>191.</span>
for i in range(mostLikelyKeyLength):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>192.</span>
possibleKey += allFreqScores[i][indexes[i]][0]</p>

</div>

<p class=MsoNormal>The full Vigenère key will be constructed from the subkeys
in <span class=Literal>allFreqScores</span> using the indexes supplied by <span
class=Literal>indexes</span>. The key starts off as a blank string on line 190,
and the <span class=Literal>for</span> loop on line 191 will iterate through the
integers from <span class=Literal>0</span> up to, but not including, <span
class=Literal>mostLikelyKeyLength</span>.</p>

<p class=MsoNormal>As the <span class=Literal>i</span> variable changes for
each iteration of the <span class=Literal>for</span> loop, the value at <span
class=Literal>indexes[i]</span> will be the index of the tuple we want to use
in <span class=Literal>allFreqScores[i]</span>. This is why <span
class=Literal>allFreqScores[i][indexes[i]]</span> evaluates to the correct
tuple we want (and the subkey we want is at index <span class=Literal>0</span>
in that tuple).</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>194.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>195.</span>
print('Attempting with key: %s' % (possibleKey))</p>

</div>

<p class=MsoNormal>If <span class=Literal>SILENT_MODE</span> is <span
class=Literal>False</span>, the key created by the <span class=Literal>for</span>
loop on line 191 is printed to the screen.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>197.</span>
decryptedText = vigenereCipher.decryptMessage(possibleKey, ciphertextUp)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>198. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>199.
</span>if detectEnglish.isEnglish(decryptedText):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>200.</span>
<span class=SourceCodeComment># Set the hacked ciphertext to the original
casing.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>201.</span>
origCase = []</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>202.</span>
     for i in range(len(ciphertext)):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>203.</span>
if ciphertext[i].isupper():</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>204.</span>
origCase.append(decryptedText[i].upper())</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>205.</span>
else:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>206.</span>
origCase.append(decryptedText[i].lower())</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>207.</span>
         decryptedText = ''.join(origCase)</p>

</div>

<p class=MsoNormal>Now that we have a complete Vigenère key, lines 197 to 208
will decrypt the ciphertext and check if the decrypted text is readable
English. If it is, then it is printed to the screen for the user to confirm it
is English (since <span class=Literal>isEnglish()</span> might produce a false
positive).</p>

<p class=MsoNormal>But <span class=Literal>decryptedText</span> is in all
uppercase letters. The code on lines 201 to 207 builds a new string by
appending the <span class=Literal>origCase</span> list with an uppercase or
lowercase form of the letters in <span class=Literal>decryptedText</span>. The <span
class=Literal>for</span> loop on line 202 goes through each of the indexes in
the <span class=Literal>ciphertext</span> string (which, unlike <span
class=Literal>ciphertextUp</span>, has the original casing of the <span
class=Literal>ciphertext</span>). If <span class=Literal>ciphertext[i]</span>
is uppercase, then the uppercase form of <span class=Literal>decryptedText[i]</span>
is appended to <span class=Literal>origCase</span>. Otherwise, the lowercase
form of <span class=Literal>decryptedText[i]</span> is appended. The list in <span
class=Literal>origCase</span> is then joined together on line 207 to become the
new value of <span class=Literal>decryptedText</span>.</p>

<p class=MsoNormal>This table shows how the <span class=Literal>ciphertext</span>
and <span class=Literal>decryptedText</span> values produce the strings that go
into <span class=Literal>origCase</span>:</p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0 width=601
 style='width:450.9pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=164 valign=top style='width:123.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'><span class=Literal>ciphertext</span></p>
  </td>
  <td width=437 valign=top style='width:327.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>Adiz Avtzqeci Tmzubb wsa m Pmilqev halpqavtakuoi</span></p>
  </td>
 </tr>
 <tr>
  <td width=164 valign=top style='width:123.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'><span class=Literal>decryptedText</span></p>
  </td>
  <td width=437 valign=top style='width:327.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>ALAN MATHISON TURING WAS A BRITISH MATHEMATICIAN</span></p>
  </td>
 </tr>
 <tr>
  <td width=164 valign=top style='width:123.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'><span class=Literal>''.join(origCase)</span></p>
  </td>
  <td width=437 valign=top style='width:327.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><span class=Literal>Alan Mathison Turing was a British mathematician</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>209.</span>
<span class=SourceCodeComment># Check with user to see if the key has been
found.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>210.</span>
print('Possible encryption hack with key %s:' % (possibleKey))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>211.</span>
print(decryptedText[:200]) <span class=SourceCodeComment># only show first 200
characters</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>212.</span>
print()</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>213.</span>
print('Enter D for done, or just press Enter to continue hacking:')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>214.</span>
response = input('&gt; ')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>215. </span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>216.</span>
if response.strip().upper().startswith('D'):</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>217.</span>
return decryptedText</p>

</div>

<p class=MsoNormal>The correctly-cased decrypted text is printed to the screen
for the user to confirm it is English. If the user enters <span class=Literal>'D'</span>
then the function returns the <span class=Literal>decryptedText</span> string.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>219.</span>
<span class=SourceCodeComment># No English-looking decryption found, so return
None.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>220.</span>
return None</p>

</div>

<p class=MsoNormal>Otherwise, after the <span class=Literal>for</span> loop on
line 188 iterates through all of the possible indexes to use and none of the
decryptions look like English, the hacking has failed and the <span
class=Literal>None</span> value is returned.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>223.</span>
def hackVigenere(ciphertext):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>224.</span>
<span class=SourceCodeComment># First, we need to do Kasiski Examination to
figure out what the</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>225.</span>
<span class=SourceCodeComment># length of the ciphertext's encryption key is.</span></p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>226.</span>
allLikelyKeyLengths = kasiskiExamination(ciphertext)</p>

</div>

<p class=MsoNormal>Now we define the <span class=Literal>hackVigenere()</span> function,
which calls all of the previous functions. We’ve already defined all the work
it will do. Let’s run through the steps it goes through to perform the hacking.
The first step is to get the most likely lengths of the Vigenère key based on
Kasiski Examination of <span class=Literal>ciphertext</span>.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>227.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>228.</span>
keyLengthStr = ''</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>229.</span>
for keyLength in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>230.</span>
keyLengthStr += '%s ' % (keyLength)</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>231.</span>
print('Kasiski Examination results say the most likely key lengths are: ' +
keyLengthStr + '\n')</p>

</div>

<p class=MsoNormal>The likely key lengths are printed to the screen if <span
class=Literal>SILENT_MODE</span> is <span class=Literal>False</span>.</p>

<h2><a name="_Toc353630920">The </a><span class=Literal>break</span> Statement</h2>

<p class=MsoNormal>Similar to how the <span class=Literal>continue</span>
statement is used inside of a loop to continue back to the start of the loop,
the <span class=Literal>break</span> statement (which is just the <span
class=Literal>break</span> keyword by itself) is used inside of a loop to
immediately exit the loop. When the program execution “breaks out of a loop”,
it immediately moves to the first line of code after the loop ends.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>233.</span>
for keyLength in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>234.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>235.</span>
print('Attempting hack with key length %s (%s possible keys)...' % (keyLength,
NUM_MOST_FREQ_LETTERS ** keyLength))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>236.</span>
hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>237.</span>
    if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>238.</span>
break</p>

</div>

<p class=MsoNormal>For each possible key length, the code calls the <span
class=Literal>attemptHackWithKeyLength()</span> function on line 236. If <span
class=Literal>attemptHackWithKeyLength()</span> does not return <span
class=Literal>None</span>, then the hack was successful and the program
execution should break out of the <span class=Literal>for</span> loop on line
238.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>240.</span>
<span class=SourceCodeComment># If none of the key lengths we found using
Kasiski Examination</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>241.</span>
<span class=SourceCodeComment># worked, start brute-forcing through key
lengths.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>242.</span>
if hackedMessage == None:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>243.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>244.</span>
print('Unable to hack message with likely key length(s). Brute-forcing key
length...')</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>245.</span>
for keyLength in range(1, MAX_KEY_LENGTH + 1):</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>246.</span>
<span class=SourceCodeComment># don't re-check key lengths already tried from
Kasiski</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>247.</span>
if keyLength not in allLikelyKeyLengths:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>248.</span>
if not SILENT_MODE:</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>249.</span>
print('Attempting hack with key length %s (%s possible keys)...' % (keyLength,
NUM_MOST_FREQ_LETTERS ** keyLength))</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>250.</span>
hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>251.</span>
if hackedMessage != None:</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>252.</span>
break</p>

</div>

<p class=MsoNormal>If the hack had failed for all the possible key lengths that
<span class=Literal>kasiskiExamination()</span> returned, <span class=Literal>hackedMessage</span>
will be set to <span class=Literal>None</span> when the <span class=Literal>if</span>
statement on line 242 executes. In this case, all the <em>other</em> key
lengths up to <span class=Literal>MAX_KEY_LENGTH</span> are tried. If Kasiski
Examination failed to calculate the correct key length, then we can just brute-force
through the key lengths.</p>

<p class=MsoNormal>Line 245 starts a <span class=Literal>for</span> loop that
will call <span class=Literal>attemptHackWithKeyLength()</span> for each value
of <span class=Literal>keyLength</span> (which ranges from <span class=Literal>1</span>
to <span class=Literal>MAX_KEY_LENGTH</span>) as long as it was not in <span
class=Literal>allLikelyKeyLengths</span>. (This is because the key lengths in <span
class=Literal>allLikelyKeyLengths</span> have already been tried in the code on
lines 233 to 238.)</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>253.</span>     return
hackedMessage</p>

</div>

<p class=MsoNormal>Finally, the value in <span class=Literal>hackedMessage</span>
is returned on line 253.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeaturedCxSpFirst><span class=SourceLineNumber>256.</span> <span
class=SourceCodeComment># If vigenereHacker.py is run (instead of imported as a
module) call</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>257.</span> <span
class=SourceCodeComment># the main() function.</span></p>

<p class=SourceCodeFeaturedCxSpMiddle><span class=SourceLineNumber>258.</span>
if __name__ == '__main__':</p>

<p class=SourceCodeFeaturedCxSpLast><span class=SourceLineNumber>259.</span>
main()</p>

</div>

<p class=MsoNormal>Lines 258 and 259 call the <span class=Literal>main()</span>
function if this program was run by itself rather than imported by another
program.</p>

<p class=MsoNormal>That’s the full Vigenère hacking program. Whether it is
successful or not depends on the characteristics of the ciphertext. Also, the
closer the original plaintext’s letter frequency is to regular English’s letter
frequency and the longer the plaintext, the more likely our hacking program
will work.</p>

<h2><a name="_Toc353630921">Practice Exercises, Chapter 21, Set A</a></h2>

<p class=MsoNormal>Practice exercises can be found at <span class=URL><u>http://invpy.com/hackingpractice21A</u></span>.</p>

<h2><a name="_Toc353630922">Modifying the Constants of the Hacking Program</a></h2>

<p class=MsoNormal>There are a few things we can modify if the hacking program
doesn’t work though. There are three constants we set on lines 8 to 10 that
affect how our hacking program runs:</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>  8.</span> MAX_KEY_LENGTH
= 16 <span class=SourceCodeComment># will not attempt keys longer than this</span></p>

</div>

<p class=MsoNormal>If the Vigenère key was longer than the integer in <span
class=Literal>MAX_KEY_LENGTH</span>, there is no possible way the hacking
program will find the correct key. However, if we have <span class=Literal>MAX_KEY_LENGTH</span>
set very high and the <span class=Literal>kasiskiExamination()</span> function
mistakenly thinks that the key length could be a very large integer, the
program could be spending hours (or days or months) attempting to hack the
ciphertext with wrong key lengths.</p>

<p class=MsoNormal>Trying to hack the wrong key length that is small is not
that big of a problem: it will only take seconds or minutes to go through the
likely keys of that length. If the hacking program fails to hack the
ciphertext, try increasing this value and running the program again.</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber>  9.</span>
NUM_MOST_FREQ_LETTERS = 3 <span class=SourceCodeComment># attempts this many
letters per subkey</span></p>

</div>

<p class=MsoNormal>The <span class=Literal>NUM_MOST_FREQ_LETTERS</span> limits
the number of possible letters tried for each subkey. By increasing this value,
the hacking program tries many more keys (which is needed if the <span
class=Literal>freqAnalysis.englishFreqMatchScore()</span> was inaccurate for
the original plaintext message), but this will also cause the program to slow
down. And setting <span class=Literal>NUM_MOST_FREQ_LETTERS</span> to <span
class=Literal>26</span> will cause the program to not narrow down the number of
possible letters for each subkey at all!</p>

<p class=TableCaption>Table 21-5. Tradeoffs for the MAX_KEY_LENGTH and
NUM_MOST_FREQ_LETTERS.</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:113.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=144 valign=top style='width:1.5in;border-top:double windowtext 1.5pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Smaller value:</p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border:none;border-top:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Larger value:</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.5in;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Faster to execute.</p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>Slower to execute.</p>
  </td>
 </tr>
 <tr>
  <td width=144 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:double windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:right;line-height:normal'>Less likely to hack.</p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border:none;border-bottom:double windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>More likely to hack.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<div style='border:double #404040 1.5pt;padding:6.0pt 4.0pt 6.0pt 4.0pt'>

<p class=SourceCodeHeadline>vigenereHacker.py </p>

<p class=SourceCodeFeatured><span class=SourceLineNumber> 10.</span>
SILENT_MODE = False <span class=SourceCodeComment># if set to True, program doesn't
print attempts</span></p>

</div>

<p class=MsoNormal>While your computer can perform calculations very fast,
displaying characters on the screen is relatively slow. If you want to speed up
your program, you can set <span class=Literal>SILENT_MODE</span> to True so
that the program does not waste time printing information to the screen. On the
downside, you will not know how the program is doing until it has completely
finished running.</p>

<h2><a name="_Toc353630923">Summary</a></h2>

<p class=MsoNormal>Hacking the Vigenère cipher requires several detailed steps
to follow. There are also many parts where our hacking program could fail:
perhaps the Vigenère key used for encryption was larger in length than <span
class=Literal>MAX_KEY_LENGTH</span>, or perhaps the English frequency matching
function got inaccurate results because the plaintext doesn’t follow normal
letter frequency, or maybe the plaintext has too many words that aren’t in our
dictionary file and <span class=Literal>isEnglish()</span> doesn’t recognize it
as English.</p>

<p class=MsoNormal>If you identify different ways that the hacking program
could fail, you could change the code to become ever more sophisticated to
handle these other cases. But the hacking program in this book does a pretty
good job at reducing billions or trillions of possible keys to brute-force
through to mere thousands.</p>

<p class=MsoNormal>However, there is one trick to make the Vigenère cipher
mathematically impossible to break, no matter how powerful your computer or how
clever your hacking program is. We’ll learn about these “one-time pads” in the
next chapter.</p>

</div>

</body>

</html>
